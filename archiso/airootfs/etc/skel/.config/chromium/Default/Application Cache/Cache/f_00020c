fpe.prototype.bU=X(1616,function(a){this.C.C.oP(a)});npe.prototype.bU=X(1615,function(a){this.D.bU(a)});q2d.prototype.u5=X(1259,function(){return ri(this,3)});h7d.prototype.u5=X(1258,function(){return ri(this,3)});vsa.prototype.qr=X(1253,function(){return ri(this,2)});oWd.prototype.qr=X(1252,function(){return ri(this,1)});epa.prototype.Xq=X(11,function(){return mh(this,12)});gpa.prototype.Xq=X(10,function(){return this.message.Xq()});mme.prototype.Xq=X(9,function(){return J(this,2)});
sme.prototype.Xq=X(8,function(){return J(this,2)});function Uxi(a){GM(a,function(b){b=new (b.H())(a.H,a.eb);EM(a,b);b.setVisible(!0)},"ritzmaestro")}function Vxi(a,b){GM(a,function(c){c=c.C(b,this.H,this.ib);EM(this,c);c.setVisible(!0)},"ritzmaestro")}function Wxi(a,b){GM(a,function(c){c=c.D(b,this.H,this.ib);EM(this,c);c.setVisible(!0)},"ritzmaestro")}function Xxi(a,b){a.D=b}function Yxi(a,b){var c=Id;Jd(a,function(d,e){return c(b(d),b(e))})}function Zxi(a){C.call(this,a)}v(Zxi,C);
Zxi.prototype.Rd=function(){return this.message.Rd()};function $xi(a){var b=ayi();byi(b);return yh(b,3,a)}function byi(a){a.gj(1,2,3,4,5,6)}function cyi(a){this.gb=ch(a,-1,0)}v(cyi,eh);cyi.prototype.toBuilder=function(){return new Zxi(this)};cyi.prototype.Rd=function(){return mh(this,1)};function ayi(){var a=void 0===a?gh(cyi):a;return new Zxi(a)}function dyi(a){C.call(this,a)}v(dyi,C);dyi.prototype.getFunctionName=function(){return this.message.getFunctionName()};
function eyi(a){this.gb=ch(a,-1,0)}v(eyi,eh);eyi.prototype.toBuilder=function(){return new dyi(this)};eyi.prototype.getFunctionName=function(){return mh(this,2)};function fyi(){var a=void 0===a?gh(eyi):a;return new dyi(a)}function gyi(a){C.call(this,a)}v(gyi,C);function hyi(a,b){return Ch(a,1,b)}function iyi(a){this.gb=ch(a,-1,0)}v(iyi,eh);iyi.prototype.toBuilder=function(){return new gyi(this)};function jyi(){var a=void 0===a?gh(iyi):a;return new gyi(a)}
function kyi(a,b){var c=this;this.J=a;this.F=new Vf;this.C=new Map;this.D=new Map;this.H=new Pl(this);this.H.listen(b,"external_data_change",function(){lyi(c);c.F.dispatchEvent(null)});lyi(this)}
function myi(a,b,c){for(var d=ha(rh(b,1,eyi).Eb()),e=d.next();!e.done;e=d.next()){var f=e.value;ih(f,2);e=f.getFunctionName();var h=a.C.get(e);if(h)if(kh(f,5))a.C.delete(e),a.D.set(e,h);else{h=h.toBuilder();ih(f,3);var k=mh(f,3);yh(h,8,k);ih(f,4)?(f=mh(f,4),yh(h,9,f)):uh(h,9);a.C.set(e,h.build())}else h=a.D.get(e).toBuilder(),ih(f,3),f=mh(f,3),yh(h,8,f),a.C.set(e,h.build()),a.D.delete(e)}a.F.dispatchEvent(null);vk(Uo(Lo(a.J.Qe("/editactions"),{data:JSON.parse(b.qb())}),"POST"),c).Se()}
function lyi(a){var b=N().HS()().map(fpa),c=new Map,d=new Map;b=ha(b);for(var e=b.next();!e.done;e=b.next())e=e.value,ih(e,8)?c.set(e.getFunctionName(),e):kh(e,11)||d.set(e.getFunctionName(),e);a.C=c;a.D=d}function nyi(){return T('<div class="waffle-edit-actions-dialog-scroll"><div class="waffle-edit-actions-dialog-actions-row-container"></div><div class="waffle-edit-actions-empty" role="alert">There are no macros</div></div>')}
function oyi(a){return T('<div class="waffle-edit-actions-row"><div class="waffle-edit-actions-row-name"><input class="waffle-edit-actions-name-input jfk-textinput" maxlength="50"/><div class="waffle-edit-actions-shortcut-conflict-message"></div></div><div class="waffle-edit-actions-options"><div class="waffle-edit-actions-row-shortcut-prefix">'+Br(a.tGa)+'</div><div class="waffle-edit-actions-row-shortcut"><input class="waffle-edit-actions-row-shortcut-input jfk-textinput" maxlength="1"/></div><div class="waffle-edit-actions-row-menu"></div></div></div>')}
;function pyi(a,b,c,d){Ov.call(this,void 0,!1,d);var e=this;this.R=a;this.O=Array.from(this.R.C.values());Yxi(this.O,function(f){return f.getFunctionName()});this.F=b;this.ea=c;this.C=new Map;this.L=null;this.H=new ebc("Macro removed","UNDO",function(){return qyi(e)},void 0,this.oa(),"off");this.qa(this.H);bw(this.ea,this.H);Cs(this,(new ws).Cf(Gs,!1,!0).set("save","Update",!0))}v(pyi,Ov);
pyi.prototype.Ca=function(){Ov.prototype.Ca.call(this);this.Uq=!1;Bs(this,!1);ryi(this,!1);bs(us(this),"waffle-edit-actions-dialog-gm");Ms(this,"save");this.setTitle("Manage macros");this.xb().appendChild(yr(nyi));for(var a=this.Da("waffle-edit-actions-dialog-actions-row-container"),b=ha(this.O),c=b.next();!c.done;c=b.next()){c=c.value;var d=new syi(c,this.F);this.Ga(d);this.C.set(c.getFunctionName(),d);d.render(a)}P(this.Da("waffle-edit-actions-empty"),!1);this.H.render();bs(this.H.Ka(),"waffle-edit-actions-undo-remove-toast")};
function ryi(a,b){Ds(a.D,"save").disabled=!b}pyi.prototype.Ia=function(){var a=this;Ov.prototype.Ia.call(this);tyi(this);this.getHandler().listen(this,"dialogselect",this.ma).listen(this.Ka(),"keydown",function(b){13==b.keyCode&&"INPUT"==b.target.tagName&&(b.target.setSelectionRange(0,0),b.target.blur(),b.preventDefault());90==b.keyCode&&b.ctrlKey&&qyi(a)});uyi(this)};
function tyi(a){for(var b={},c=ha(a.C.values()),d=c.next();!d.done;b={sQ:b.sQ},d=c.next())b.sQ=d.value,a.getHandler().listen(b.sQ.ea,"action",function(e){return function(){return vyi(a,e.sQ)}}(b)).listen(wyi(b.sQ),"input",function(e){return function(){var f=e.sQ;xyi(f)?UV(f.EO):TV(f.EO,"Must be a number from 0 to 9 or blank.",!0);f=!uyi(a)&&xyi(f);ryi(a,f)}}(b)).listen(yyi(b.sQ),"input",function(){a.F.C(29573);ryi(a,!0)})}
function uyi(a){var b=new Map;a=ha(a.C.values());for(var c=a.next();!c.done;c=a.next())c=c.value,b.has(zyi(c))?b.get(zyi(c)).push(c):b.set(zyi(c),[c]);a=!1;c=null;b=ha(b);for(var d=b.next();!d.done;d=b.next()){var e=ha(d.value);d=e.next().value;e=e.next().value;1<e.length&&""!=d?(a=!0,c=d,e.forEach(function(h){h=h.Da("waffle-edit-actions-shortcut-conflict-message");ym(h,"Conflicts with another shortcut");P(h,!0)})):e.forEach(function(h){h=h.Da("waffle-edit-actions-shortcut-conflict-message");P(h,
!1)})}if(a){var f="Can't save conflicting shortcut "+c;setTimeout(function(){return NG(f)})}return a}function vyi(a,b){ryi(a,!0);a.L=b;a.C.delete(b.Aa);P(b.Ka(),!1);uyi(a);a.H.setVisible(!0);0==a.C.size&&P(a.Da("waffle-edit-actions-empty"),!0);a.Ka().focus();var c="Macro "+(b.C.getValue()+" was removed, Ctrl-Z to Undo");setTimeout(function(){return NG(c)});a.F.C(29572)}
function qyi(a){if(null!=a.L){var b=a.L;a.C.set(b.Aa,b);P(b.Ka(),!0);P(a.Da("waffle-edit-actions-empty"),!1);uyi(a);a.L=null;var c="Macro "+(b.C.getValue()+" is restored.");setTimeout(function(){return NG(c)});a.F.C(29577)}}
pyi.prototype.ma=function(a){var b=this;if("cancel"==a.key)this.F.C(29569);else if("save"==a.key){for(var c=ha(this.C.values()),d=c.next();!d.done;d=c.next())if(d=d.value,!xyi(d)||""!=Ayi(d)){a.preventDefault();return}uyi(this)?a.preventDefault():(a=Byi(this),myi(this.R,a,function(){var e=aw(b.ea,"Failed to update macros.",Wl(),!0,0,!0,void 0,!0,["waffle-edit-actions-update-failed"]);e.C=!0;e.render();e.setVisible(!0)}),this.F.C(29574),setTimeout(function(){return NG("Macros updated")}))}};
function Byi(a){for(var b=jyi(),c=ha(a.O),d=c.next();!d.done;d=c.next()){var e=d.value;d=fyi();var f=!1,h=a.C.get(e.getFunctionName()),k=mh(e,9),l=mh(e,8);h?(k!=zyi(h)&&(k=zyi(h),f=!0),l!=h.C.getValue()&&(l=h.C.getValue(),f=!0)):(vh(d,5,!0),f=!0);f&&(f=mh(e,1),yh(d,1,f),e=e.getFunctionName(),yh(d,2,e),yh(d,3,l),k&&yh(d,4,k),d=d.build(),Bh(b,1,d))}return b.build()}
function syi(a,b,c){S.call(this,c);this.xa=a;this.Ha=mh(a,8);this.Aa=a.getFunctionName();this.J=(a=mh(a,9))?a.split("+"):[];this.D=new uv;this.Ga(this.D);this.L=this.O=null;this.C=new uv;this.Ga(this.C);this.ma=new Sv;this.qa(this.ma);this.Ba=b;b=bt(qt,"waffle-overflow-menu-material");this.H=new Nt(void 0,void 0,b,this.oa());this.qa(this.H);this.R=new Ct("Edit script");this.qa(this.R);this.ea=new Ct("Remove");this.qa(this.ea);this.EO=new SV(this.oa());this.qa(this.EO);this.F=new SV(this.oa());this.qa(this.F)}
v(syi,S);syi.prototype.Ca=function(){var a=(vd(this.J)?Cyi:this.J.slice(0,this.J.length-1)).join(" + ")+" + ";a=yr(oyi,{tGa:Mp?a.replace(/Ctrl/g,"\u2318").replace(/Alt/g,"Option"):a});this.kb(a)};
syi.prototype.Ia=function(){var a=this;this.D.Va(this.Da("waffle-edit-actions-row-shortcut-input"));this.D.setValue(gd(this.J)||"");var b=this.Da("waffle-edit-actions-name-input");this.C.Va(b);this.C.setValue(this.Ha);this.ma.Va(b);this.EO.setPosition(3,2);this.EO.render();b=this.D.Ka();this.EO.Ti(b);VV(this.EO,b);UV(this.EO);this.F.setPosition(0,2);this.F.render();b=this.C.Ka();this.F.Ti(b);VV(this.F,b);UV(this.F);b=new Sr(this.H.xb(),13);Ot(this.H,b);this.H.lB=!0;this.H.Zc(this.R);this.H.Zc(this.ea);
b=this.Da("waffle-edit-actions-row-menu");this.H.Va(b);"black"==Tt()&&bs(b,"waffle-overflow-menu-material-white");this.getHandler().listen(this.R,"action",function(){O("macros-editor").ob({scriptId:mh(a.xa,1),filename:mh(a.xa,10)});a.Ba.C(29570)}).listen(this.C.Ka(),"blur",function(){""==Ayi(a)?UV(a.F):TV(a.F,Ayi(a),!0)}).listen(this.D.Ka(),"click",function(){return a.D.Ka().select()}).listen(wyi(this),"input",function(){return a.Ba.C(29571)});Yr(this.Da("waffle-edit-actions-name-input"),"Macro name");
Yr(this.D.Ka(),"Numeric shortcut key");Yr(b,"More options button")};function zyi(a){var b=a.D.getValue();return""==b?"":(vd(a.J)?Cyi:a.J.slice(0,a.J.length-1)).join("+")+"+"+b}function wyi(a){null==a.O&&(a.O=new Rv(a.D.Ka()),a.qa(a.O));return a.O}function yyi(a){null==a.L&&(a.L=new Rv(a.C.Ka()),a.qa(a.L));return a.L}function xyi(a){a=a.D.getValue();return""==a||/^\d$/.test(a)}
function Ayi(a){a=a.C.getValue();return""==a?"Macro name must be not be empty.":/\r|\n/.test(a)?"Macro name must not contain line-break characters.":""}var Cyi=["Ctrl","Alt","Shift"];function Dyi(){return T('<div class="waffle-import-custom-function-actions-title-separator"></div><div class="waffle-import-custom-function-actions-dialog-scroll"><div class="waffle-import-custom-functions-row-container"></div></div>')}
function Eyi(a){var b=a.nqc,c=a.fileName;a='<div class="waffle-import-custom-function-row" tabindex="0"><div class="waffle-import-custom-function-name">'+Br(a.functionName)+'</div><div class="waffle-import-custom-function-metadata"><div class="waffle-import-custom-function-project-name"><span class="waffle-import-custom-function-description-label">';a=a+'Project:</span><span class="function-description-seperator"></span>'+(Br(b)+'</div><div class="waffle-import-custom-function-file-name"><span class="waffle-import-custom-function-description-label">');
a=a+'File:</span><span class="function-description-seperator"></span>'+(Br(c)+'</div></div><div class="waffle-import-custom-function-view-script"></div><div class="waffle-import-custom-function-add-function"></div></div>');return T(a)};function Fyi(a,b,c,d){Ov.call(this,void 0,!1,d);this.ma=a;this.H=Array.from(this.ma.D.values());Yxi(this.H,function(e){return e.getFunctionName()});this.ea=b;this.Ba=c;this.R=[];this.F=[];this.C=aw(this.Ba,"Function added.",Wl(),!1,3E3,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);this.qa(this.C);this.Ha=new Uv(this.oa());this.qa(this.Ha);this.L=new Nn(this.O,3E3,this);this.qa(this.L)}v(Fyi,Ov);
Fyi.prototype.Ca=function(){Ov.prototype.Ca.call(this);bs(us(this),"waffle-import-custom-function-actions-dialog");this.setTitle("Import");var a=this.oa().Ca("DIV","waffle-import-custom-function-title-description",Pw()?"Added functions will appear in the menu under Extensions > Macros":"Added functions will appear in the menu under Tools > Macros");ss(this).appendChild(a);this.xb().appendChild(yr(Dyi));a=this.Da("waffle-import-custom-functions-row-container");for(var b=ha(this.H),c=b.next();!c.done;c=
b.next())c=new Gyi(c.value,this.ea),this.Ga(c),c.render(a),this.R.push(c);this.C.render();this.C.setVisible(!1);Cs(this,null)};Fyi.prototype.Ia=function(){var a=this;Ov.prototype.Ia.call(this);for(var b={},c=ha(this.R),d=c.next();!d.done;b={Rba:b.Rba},d=c.next())b.Rba=d.value,this.getHandler().listen(b.Rba.D,"action",function(e){return function(){return Hyi(a,e.Rba)}}(b));this.getHandler().listen(this,"hide",function(){return a.O()})};
function Hyi(a,b){Iyi(b);var c=Jyi(b.C);Kyi(a,c);b=b.Da("waffle-import-custom-function-add-function");b.setAttribute("tabindex","0");Yr(b,"This function has been added.");b.focus();a.ea.C(29576);setTimeout(function(){return a.C.setVisible(!0)})}function Jyi(a){var b=fyi();var c=mh(a,1);b=yh(b,1,c);c=a.getFunctionName();b=yh(b,2,c);a=a.getFunctionName();return yh(b,3,a).build()}function Kyi(a,b){a.F.push(b);a.L.start()}
Fyi.prototype.O=function(){var a=this;if(0<this.F.length){var b=hyi(jyi(),this.F).build();myi(this.ma,b,function(){var c=aw(a.Ba,"Failed to add function.",Wl(),!1,1E4,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);c.C=!0;c.render();c.setVisible(!0)});this.F=[]}};function Gyi(a,b,c){S.call(this,c);this.C=a;this.H=b;a=Wv.getInstance();this.D=new rt("Add Function",a,c);this.Ga(this.D);this.F=new rt("Edit Script",a,c);this.Ga(this.F)}v(Gyi,S);
Gyi.prototype.Ca=function(){S.prototype.Ca.call(this);var a=yr(Eyi,{functionName:this.C.getFunctionName(),nqc:mh(this.C,2),fileName:mh(this.C,10)});this.kb(a);this.D.render(this.Da("waffle-import-custom-function-add-function"));this.F.render(this.Da("waffle-import-custom-function-view-script"))};
Gyi.prototype.Ia=function(){var a=this;S.prototype.Ia.call(this);this.getHandler().listen(this.F,"action",function(){O("macros-editor").ob({scriptId:mh(a.C,1),filename:mh(a.C,10)});a.H.C(29575)});var b="Function: "+(this.C.getFunctionName()+(", from project: "+(mh(this.C,2)+(", defined in file: "+mh(this.C,10)))));Yr(this.Ka(),b)};function Iyi(a){P(a.D.Ka(),!1);bs(a.Da("waffle-import-custom-function-add-function"),"waffle-import-custom-function-actions-checkmark")};function Lyi(a,b,c,d,e,f){B.call(this);this.C=a;this.functionName=b;this.F=d||null;this.D=void 0!==f?f:null}v(Lyi,B);function Myi(a){I(this,a,0,-1,Nyi,null)}x(Myi,H);var Nyi=[6];p=Myi.prototype;p.V=function(){var a=new D;Oyi(this,a);return Y(a)};function Oyi(a,b){var c=J(a,1);null!=c&&b.Ea(1,c);c=J(a,2);null!=c&&b.Ea(2,c);c=J(a,3);null!=c&&b.Ea(3,c);c=J(a,4);null!=c&&b.Ea(4,c);c=J(a,5);null!=c&&b.Ea(5,c);c=a.lh();0<c.length&&hi(b,6,c,Oyi);c=J(a,7);null!=c&&F(b,7,c);c=J(a,9);null!=c&&b.Ea(9,c);c=J(a,10);null!=c&&b.Ea(10,c);c=J(a,11);null!=c&&G(b,11,c);c=J(a,12);null!=c&&G(b,12,c);c=J(a,13);null!=c&&b.Ea(13,c)}
p.Me=function(){return J(this,1)};p.Yg=function(){return J(this,2)};p.Ik=function(a){K(this,2,a)};p.getKey=function(){return J(this,5)};p.lh=function(){return Ki(this,Myi,6)};p.Zc=function(a,b){return Oi(this,6,a,Myi,b)};p.Na=function(a){return K(this,7,a)};p.Xq=function(){return J(this,13)};function Pyi(a){I(this,a,"amep",-1,null,null)}x(Pyi,H);Pyi.prototype.V=function(){var a=new D;var b=this.zb();null!=b&&a.va(1,b,Oyi);return Y(a)};Pyi.messageId="amep";Pyi.prototype.zb=function(){return M(this,Myi,1,1)};Pyi.prototype.Ce=function(a){return Li(this,1,a)};Pyi.prototype.f4=function(){PP(this,1)};Pyi.prototype.gt=function(){return oi(this,1)};function v7(a){zl.call(this,a)}v(v7,zl);function Qyi(a){zl.call(this,"amep");this.C=new Pyi(a)}v(Qyi,v7);Qyi.prototype.Wf=g("C");function Ryi(a){I(this,a,0,-1,null,null)}x(Ryi,H);Ryi.prototype.V=function(){var a=new D;Syi(this,a);return Y(a)};
function Syi(a,b){var c=J(a,1);null!=c&&b.Ea(1,c);c=J(a,2);null!=c&&b.Ea(2,c);c=J(a,3);null!=c&&b.Ea(3,c);c=J(a,4);null!=c&&F(b,4,c);c=J(a,5);null!=c&&b.Ea(5,c);c=J(a,6);null!=c&&b.Ea(6,c);c=J(a,7);null!=c&&b.Ea(7,c);c=J(a,8);null!=c&&F(b,8,c);c=J(a,9);null!=c&&F(b,9,c);c=J(a,10);null!=c&&F(b,10,c);c=J(a,11);null!=c&&b.Ea(11,c);c=J(a,12);null!=c&&F(b,12,c);c=J(a,13);null!=c&&b.Ea(13,c);c=J(a,14);null!=c&&b.Ea(14,c);c=J(a,15);null!=c&&b.Ea(15,c);c=J(a,16);null!=c&&b.Ea(16,c);c=J(a,17);null!=c&&b.Ea(17,
c);c=J(a,18);null!=c&&ai(b,18,c);c=J(a,19);null!=c&&F(b,19,c)}function w7(a){return J(a,2)}Ryi.prototype.getName=function(){return J(this,3)};Ryi.prototype.Ij=function(){return J(this,13)};function Tyi(a,b){this.D=void 0===a?null:a;this.C=(void 0===b?null:b)||null}Tyi.prototype.F=g("C");function Uyi(a,b){return y(A(),"docs-emgsmw")?null==a.F||null==J(b,18)?!1:a.C===J(b,18):a.D===J(b,1)}function x7(a){return new Tyi(J(a,1),J(a,18))};function Vyi(a){I(this,a,"der",-1,null,null)}x(Vyi,H);Vyi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};Vyi.messageId="der";Vyi.prototype.qr=function(){return ri(this,1)};function Wyi(a){I(this,a,"eer",-1,null,null)}x(Wyi,H);Wyi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};Wyi.messageId="eer";Wyi.prototype.qr=function(){return ri(this,1)};function Xyi(a,b,c){this.D=a;this.C=b;this.F=c}Xyi.prototype.getVersionInfo=g("F");function Yyi(a,b){this.C=a;this.D=b}Yyi.prototype.getVersionInfo=g("D");function Zyi(a,b){this.C=a;this.Sd=b}Zyi.prototype.getExtension=g("C");Zyi.prototype.isEnabled=g("Sd");function $yi(a){Ov.call(this);this.C=a;vs(this,!0);this.Ly(!1);Cs(this,null);Bs(this,!1)}v($yi,Ov);$yi.prototype.Ca=function(){Ov.prototype.Ca.call(this);this.C.render(this.xb())};$yi.prototype.Ia=function(){Ov.prototype.Ia.call(this);var a=this.Ka();Wr(a,"labelledby");Yr(a,"Add-ons");bs(us(this),"gsm-widget")};function azi(a,b){var c=new Ui,d=new yId;if(b){if(J(b,1)){var e=J(b,1);K(d,1,e)}e=ri(b,12);K(d,2,e);oi(b,18)&&(e=J(b,18),K(d,5,e));b=ri(b,19);K(d,6,b)}b=dd(A(),"docs-tcmt");e=!!b;K(d,3,e);e&&K(d,4,b);Li(c,73,d);return mq(nq(new lq,c),a).build()}function bzi(a){var b=new Ui,c=new yId;null!=a.D&&K(c,1,a.D);null!=a.C&&K(c,5,a.C);Li(b,73,c);return mq(nq(new lq,b),90).build()};function czi(a,b,c){rW.call(this,a);this.D=b;this.F=c;this.D.dj=!0}v(czi,rW);p=czi.prototype;p.ICa=function(){O("macros-extension-store-render").ob()};p.mla=function(a,b,c){a=new Tyi(null,a);O("macros-extension-store-install").ob(new Xyi(a,String(b),c),bzi(a))};p.HCa=function(a,b){a=new Tyi(null,a);O("macros-extension-store-uninstall-item").ob(new Yyi(a,b),bzi(a))};
p.f3a=function(a){var b=new ccf,c=this.F(new Tyi(null,a));if(!c)return b;a=c.getExtension();c=c.isEnabled();var d=new qW;d.Ik("Use in this document");K(d,3,"useInDoc");d.Gb(!!ri(a,4)||!!ri(a,12));d.Na(c);var e=new qW;e.Ik("Help");K(e,3,"help");d=[d,e];ri(a,9)&&(e=new qW,K(e,1,!0),d.push(e),ri(a,8)&&(a=new qW,a.Na(c),a.Ik("Settings"),K(a,3,"settings"),d.push(a)),a=new qW,a.Ik("Report an issue"),K(a,3,"reportIssue"),d.push(a));Ni(b,1,d);return b};
p.e3a=function(a,b){var c=new Tyi(null,a);a=bzi(c);switch(b){case "help":b=this.F(c);if(!b)break;b=b.getExtension();O("macros-extension-help").ob(w7(b),a);break;case "reportIssue":O("macros-extension-store-report").ob(c,a);break;case "settings":O("macros-extension-store-settings").ob(c,a);Yf(this.D);break;case "useInDoc":O("macros-extension-store-use-in-doc").ob(c,a)}};p.Sla=function(){this.D.setVisible(!1)};function dzi(a,b,c){B.call(this);this.C=ezi(a);this.F=b;this.D=c}v(dzi,B);function fzi(a,b,c,d,e){b=new Djf(b,null,e);Ejf(b,ed(A(),"docs-gsmd"));a.D&&Hjf(b,a.D);Xxi(b,c.map(function(f){return f.C}));d&&d.C&&(b.F=d.C);a=ed(A(),"gaia_session_id");a=Wd(a)?NaN:Number(a);isNaN(a)||Fjf(b,a);return b.build()}function gzi(a,b){var c=new $yi(b);a=new czi(b,c,a.F);c.qa(a);return c}
function ezi(a){if(a==(Iu(),Eu))return"docs_addon";if(a==(Iu(),Fu))return"sheets_addon";if(a==(Iu(),Gu))return"slides_addon";if(a==(Iu(),l0a))return"forms_addon";throw Error("Unsupported document type for GSM  ["+a+"]");};function hzi(a,b,c,d,e,f){B.call(this);this.F=b;this.D=new dzi(a,d,f);this.C=null}v(hzi,B);function izi(a){I(this,a,"iar",-1,null,null)}x(izi,H);izi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=J(this,2);null!=b&&a.Ea(2,b);b=J(this,3);null!=b&&F(a,3,b);return Y(a)};izi.messageId="iar";izi.prototype.qr=function(){return ri(this,1)};function jzi(a,b,c,d){var e=J(a,4)+"-polymorphic-"+(a.Me()||"");pSa.call(this,e);this.C=a;this.L=nd(b,function(f){return new jzi(f,[],!1)},this);this.Na(this.isEnabled());this.xa=c;this.ma="boolean"===typeof d?d:!0}v(jzi,pSa);jzi.prototype.isInstalled=g("ma");jzi.prototype.ob=function(){O("macros-polymorphic-item").ob(this)};jzi.prototype.isEnabled=function(){return this.L&&(0<this.L.length?!0:!!ri(this.C,7))};jzi.prototype.getLabel=function(){return this.C.Yg()||J(this.C,10)||""};function kzi(){zl.call(this,"Pl")}v(kzi,zl);function lzi(){Jl.call(this);this.C={};this.C[1]={};this.C[0]={};this.D=new ju(this);this.qa(this.D);this.D.subscribe(O("macros-polymorphic-item"),"action",this.F)}v(lzi,Jl);lzi.prototype.F=function(a){a.xa||0<a.L.length?this.dispatchEvent(new kzi(a)):(a=new Lyi(J(a.C,4),J(a.C,3),void 0,J(a.C,9)||void 0,void 0,a.C.Xq()||void 0),O("macros-exec").ob(a))};function mzi(a){I(this,a,"ger",-1,nzi,null)}x(mzi,H);var nzi=[1];mzi.prototype.V=function(){var a=new D;var b=this.Efa();0<b.length&&hi(a,1,b,Syi);return Y(a)};mzi.messageId="ger";mzi.prototype.Efa=function(){return Ki(this,Ryi,1)};function ozi(a){I(this,a,0,-1,null,null)}x(ozi,H);ozi.prototype.V=function(){var a=new D;pzi(this,a);return Y(a)};function pzi(a,b){var c=J(a,1);null!=c&&b.Ea(1,c);c=J(a,2);null!=c&&b.Ea(2,c)}ozi.prototype.getName=function(){return J(this,1)};function qzi(a){I(this,a,0,-1,rzi,null)}x(qzi,H);var rzi=[4];p=qzi.prototype;p.V=function(){var a=new D;szi(this,a);return Y(a)};function szi(a,b){var c=J(a,1);null!=c&&b.Ea(1,c);c=J(a,2);null!=c&&b.Ea(2,c);c=J(a,3);null!=c&&b.Ea(3,c);c=Ki(a,ozi,4);0<c.length&&hi(b,4,c,pzi)}p.getId=function(){return J(this,1)};p.Dc=function(a){return K(this,1,a)};p.getName=function(){return J(this,2)};p.Nd=function(){return J(this,3)};p.Mi=function(a){return K(this,3,a)};function tzi(a){I(this,a,"llr",-1,uzi,null)}x(tzi,H);var uzi=[2];tzi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=Ki(this,qzi,2);0<b.length&&hi(a,2,b,szi);return Y(a)};tzi.messageId="llr";tzi.prototype.qr=function(){return ri(this,1)};function vzi(a){I(this,a,"rar",-1,null,null)}x(vzi,H);vzi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=J(this,2);null!=b&&a.Ea(2,b);return Y(a)};vzi.messageId="rar";vzi.prototype.qr=function(){return ri(this,1)};function wzi(a){I(this,a,"uer",-1,null,null)}x(wzi,H);wzi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};wzi.messageId="uer";wzi.prototype.qr=function(){return ri(this,1)};function xzi(a,b,c,d){B.call(this);this.D=a;this.F=c;this.C=d||new yzi}v(xzi,B);p=xzi.prototype;p.RYa=function(a,b,c,d,e,f,h){a=["ruid",Ia({}),this.C.C,this.D,this.C.F,a,this.C.O,b,this.C.D,c,this.C.xa,e,this.C.Aa,f,this.C.ma,h];a=So(tk(Uo(y7(this,this.C.R),"POST"),2),a).Or();d&&(wk(a,w(this.h5b,this,d)),vk(a,w(this.zLb,this,d)));a.Se()};p.cancel=function(a){a=["ruid",Ia({}),this.C.C,this.D,this.C.H,a];So(tk(Uo(y7(this,this.C.J),"POST"),2),a).Or().Se()};
function zzi(a,b){var c=["ruid",Ia({}),a.C.C,a.D];c=So(tk(y7(a,a.C.ea),2),c);b&&(wk(c,w(a.fMb,a,b)),vk(c,w(a.eMb,a,b)));c.Se()}p.h5b=function(a,b){b=b.ze();b=new izi(b[0]);a(b)};p.zLb=function(a){var b=new izi;K(b,1,!1);a(b)};p.fMb=function(a,b){b=b.ze();b=new tzi(b[0]);a(b)};p.eMb=function(a){var b=new tzi;K(b,1,!1);a(b)};p.i5b=function(a,b){b=b.ze();b=new vzi(b[0]);a(b)};p.JSb=function(a){var b=new vzi;K(b,1,!1);a(b)};
function Azi(a,b){var c=["ruid",Ia({}),a.C.C,a.D];vk(wk(So(tk(y7(a,"/scripts/getitems"),1),c),w(a.IJb,a,b)),Aa).Se()}p.IJb=function(a,b){b=b.ze();b=new mzi(b[0]);a(b)};function Bzi(a,b,c,d){function e(h,k){k=k.ze();k=new wzi(k[0]);h(k)}var f=["ruid",Ia({}),a.C.C,a.D];null!=b.D&&f.push("storeitemid",b.D);null!=b.C&&f.push("appid",b.C);d&&f.push("versioninfo",d);b=So(Uo(y7(a,"/scripts/uninstallitem"),"POST"),f).Or();c&&(wk(b,w(e,a,c)),a=new wzi,K(a,1,!1),vk(b,Ka(c,a)));b.Se()}
p.mOa=function(a,b,c,d,e,f){a=["ruid",Ia({}),this.C.C,this.D,this.C.D,e,"extensionid",a,"justInstalled",d];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);f&&a.push("versioninfo",f);b=So(tk(Uo(y7(this,"/scripts/enableitem"),"POST"),1),a).Or();c&&(wk(b,w(this.SHb,this,c)),vk(b,w(this.RHb,this,c)));b.Se()};p.SHb=function(a,b){b=b.ze();b=new Wyi(b[0]);a(b)};p.RHb=function(a){var b=new Wyi;K(b,1,!1);a(b)};
p.Ijb=function(a,b,c,d){a=["ruid",Ia({}),this.C.C,this.D,this.C.D,d,"extensionid",a];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);b=So(tk(Uo(y7(this,"/scripts/disableitem"),"POST"),1),a).Or();c&&(wk(b,w(this.tGb,this,c)),vk(b,w(this.sGb,this,c)));b.Se()};p.tGb=function(a,b){b=b.ze();b=new Vyi(b[0]);a(b)};p.sGb=function(a){var b=new Vyi;K(b,1,!1);a(b)};function y7(a,b){return To(a.F.Qe(b)).setTimeout(4E4)}
function yzi(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E,L,Q,R){B.call(this);this.C=a||"id";this.F=c||"lib";this.O=d||"func";this.D=e||"ctx";this.H=f||"pid";this.xa=L||"eei";this.Aa=Q||"usit";this.ma=void 0!==R?R:"did";this.L=h||"ca";this.R=k||"/scripts/invoke";this.J=l||"/scripts/cancel";this.ea=n||"/scripts/libraries";this.Ba=q||"/scripts/resume";this.Ha=u||"/scripts/uiready"}v(yzi,B);function Czi(a,b,c,d,e,f,h,k,l,n,q,t){B.call(this);var u=this;this.Ha=n?k$b(n):void 0;this.Ba=n?l$b(n):void 0;this.Aa=a;this.C=d;this.La=e;this.xa=b;this.O=f;this.F=h;this.L=k;this.D=[];this.H=l;this.J=new Us("mae-show_addons_menu_promo");Vs(c,this.J,"mae-show_addons_menu_promo");this.ma=q||null;this.ea=t||null;this.R=new hzi(this.Aa,this.xa,this,function(z){if(z=u.getExtension(z)){var E=2==u.H?!1:1==u.H?!(!ri(z,10)||!ri(z,9)):!0;z=new Zyi(z,E)}else z=void 0;return z},this.Ba,this.Ha);this.qa(this.R);
O("macros-extension-store-install").wb(mp,this.lIb,this);O("macros-extension-store-install").Na(!0);O("macros-extension-store-render").wb(mp,this.mIb,this);O("macros-extension-store-render").Na(!0);O("macros-extension-store-report").wb(mp,this.nIb,this);O("macros-extension-store-report").Na(!0);O("macros-extension-store-settings").wb(mp,this.oIb,this);O("macros-extension-store-settings").Na(!0);O("macros-extension-store-uninstall-item").wb(mp,this.pIb,this);O("macros-extension-store-uninstall-item").Na(!0);
O("macros-extension-store-use-in-doc").wb(mp,this.qIb,this);O("macros-extension-store-use-in-doc").Na(!0)}v(Czi,B);p=Czi.prototype;p.mIb=function(){Dzi(this)};p.lIb=function(a){a=a.data;Ezi(this,a.C,a.D,a.getVersionInfo())};p.nIb=function(a){a=this.getExtension(a.data);var b=x7(a);this.Q6a(b,w7(a),a.getName(),J(a,6)||void 0,J(a,11)||void 0)};p.oIb=function(a){a=this.getExtension(a.data);Fzi(this,w7(a))};p.pIb=function(a){a=a.data;var b=this.getExtension(a.C),c=b&&w7(b);b=x7(b);Gzi(this,c,b,Aa,a.getVersionInfo())};
p.qIb=function(a){var b=this.getExtension(a.data);a=x7(b);ri(b,4)||ri(b,12)?Hzi(this,w7(b),a,function(c){c&&(K(b,4,!1),K(b,12,!1))}):Izi(this,w7(b),a,function(c){c&&K(b,4,!0)})};p.AV=function(a){var b=Jzi(this,!1),c=this.R;var d=c.D;a=fzi(d,d.C,b,a,!1);d=gzi(d,a);c.C=d;d=c.C;c.F.Nh(d);d.setVisible(!0);Kzi(this)};function Jzi(a,b){return(void 0===b?0:b)?a.D.map(function(c){return x7(c)}):a.D.filter(function(c){return ri(c,10)&&ri(c,9)}).map(function(c){return x7(c)})}
function Fzi(a,b){Lzi(a.C);var c=w(function(d,e){this.C.wN();d&&d(e)},a,void 0);Tje(a.O.C,w(a.F.RYa,a.F,b,"doSettings",a.L().getState()||void 0,c))}function Izi(a,b,c,d){Lzi(a.C);Tje(a.O.C,w(a.F.mOa,a.F,b,c,w(function(e,f){if(f.qr()){var h=a.getExtension(c);h&&K(h,4,!0);Dzi(a)}a.C.wN();e&&e(f.qr())},a,d),void 0,a.L().getState()||void 0))}
function Hzi(a,b,c,d){Lzi(a.C);Tje(a.O.C,w(a.F.Ijb,a.F,b,c,w(function(e,f){if(f.qr()){O("macros-extension-disabled").ob(b);var h=a.getExtension(c);h&&(K(h,4,!1),K(h,12,!1));Dzi(a)}a.C.wN();e&&e(f.qr())},a,d),a.L().getState()||void 0))}function Gzi(a,b,c,d,e){Bzi(a.F,c,w(function(f,h){if(h.qr()&&b){O("macros-extension-disabled").ob(b);var k=a.D.findIndex(function(l){return Uyi(c,l)});-1!=k&&Bd(a.D,k);(k=Mzi(a.C))&&oe(k.J,b)}Dzi(a,function(){return f(h.qr())})},a,d),e)}
p.Q6a=function(a,b,c,d,e){e?rr(e):(Nzi(this.C,w(function(f,h){var k=this.F,l=w(this.C.Luc,this.C,c,h,d),n=w(this.C.Kuc,this.C);f=["ruid",Ia({}),k.C.C,k.D,k.C.F,b,"issuedesc",f,"includeUserInfo",h];null!=a.D&&f.push("storeitemid",a.D);null!=a.C&&f.push("appid",a.C);So(vk(wk(tk(Uo(y7(k,"/scripts/sendissuereport"),"POST"),1),Be(l)),Be(n)),f).Or().Se()},this),c),Kzi(this))};
function Ezi(a,b,c,d){Lzi(a.C);Tje(a.O.C,w(a.F.mOa,a.F,b,c,function(e){a.C.wN();e.qr()?Dzi(a):(e=Qu("Unable to install add-on","warning",!0),a.C.C.C.postMessage(e),e.getId(),Ozi(a))},!0,a.L().getState()||void 0,d))}function Dzi(a,b){b=void 0===b?Aa:b;Azi(a.F,w(function(c,d){d=d.Efa();wd(this.D);d=ha(d);for(var e=d.next();!e.done;e=d.next())this.D.push(e.value);Pzi(this);Ozi(this);c()},a,b))}
function Pzi(a){var b=a.La,c=Dd(a.D);b.C[1]={};b.C[0]={};for(var d=0;d<c.length;++d){var e=c[d],f=w7(e),h=new Myi,k=String(Ia(h));K(h,1,k);h.Ik(e.getName());k=w7(e);K(h,4,k);h.Na(!0);k=e.getName();K(h,10,k);K(h,11,1);k=!(!ri(e,10)&&!ri(e,9));e=new jzi(h,[],!0,k,ri(e,19)||!1);e.setVisible(!0);b.C[ti(e.C,11,0)][f]=e}b.dispatchEvent("Nl");if(b=a.C.O)if(vd(a.D))!a.J.getValue()&&O("macros-extension-menu-promo").isEnabled()&&(a=a.Aa,Ok(b.F.F,"mae-promo-id")||(a=new Qzi(a),a.render(),c=new Ct(""),c.Dc("mae-promo-id"),
c.Sb("script-promo-menu-item"),c.setContent(a.getElement()),nu(b.O,c,O("macros-extension-menu-promo"),void 0,void 0,azi(3)),b.C.Pc(),b.F.Pc(),Rzi(b.F,c)),Szi(b));else{c=Dd(a.D);if(b.J){Jd(c,b.La);f=new Lk;Eya(f,b.C.F);b.F.Pc();b.C.Pc();d=[];for(e=0;e<c.length;++e){k=c[e];var l=w7(k),n=!(!ri(k,10)&&!ri(k,9));d.push(l);h=f.get(l);var q=ri(k,19);if(h)l=h.zb(),n&&!q&&(n=l.Gc(0),q="addon-menu-install-"+w7(k),n&&n.getId()==q&&(l.Jn(0).dispose(),2==l.Qb()&&(l.Gc(0),l.Jn(0).dispose())));else{h=new Mt("");
h.Dc(l);h.Na(2==b.R?!1:1==b.R?!!(k&&ri(k,10)&&ri(k,9)):!0);var t=new Ht;n||q||Tzi(b,t,k);Uzi(b,t,l,[],k);h.Ce(t)}k=k.getName();n=lm("span");n.appendChild(mm(k));h.setContent(n);Rzi(b.C,h)}for(e=0;e<b.ea.length;++e)Rzi(b.C,f.get(b.ea[e]));if(b.L)for(f=f.Xe(),e=0;e<f.length;++e)if(0>d.indexOf(f[e])&&0>b.ea.indexOf(f[e])&&(h=b.xa[f[e]])){for(k=0;k<h.length;++k)b.L.bU(h[k]);delete b.xa[f[e]]}O("macros-manage-extensions").Na(!!c.length);Szi(b)}a.ea&&a.ea.C(!!a.D.length)}}
function Ozi(a){var b=Mzi(a.C);if(b){var c=Dd(a.D),d=a.H;b.C=[];for(var e=0;e<c.length;e++){var f=c[e];if(ri(f,12)||ri(f,4))Md(b.C,f,b.Tnb),b.H&&!ri(f,12)&&(b.H=!1)}O("macros-addon-sidebar-focus").Na(0<b.C.length);b.ea=0==d;b.O=!0;b.L=1==b.C.length&&null!=Vzi(b);b.ub()&&Wzi(b);a.ma&&a.ma.C(0<b.C.length)}}p.getExtension=function(a){return this.D.find(function(b){return Uyi(a,b)})};function Xzi(a,b){return a.D.find(function(c){return w7(c)===b})}
function Kzi(a){if(!a.J.getValue()&&(a.J.setValue(!0),vd(a.D))){var b=a.C.O;if(b){var c=dm("docs-menu-superscript",b.H.getElement());c&&br(c,0);b.F.Pc();Szi(b);Pzi(a)}}};function Yzi(a,b,c,d,e,f,h,k,l,n,q,t,u){this.H=a;this.O=b;this.L=c;this.ea=d;this.R=e;this.Aa=h;this.D=k;this.C=l;this.J=n;this.ma=q;this.xa=t;this.F=u}function Zzi(a,b){a=a.L;if(b){a=new il(a);var c=a.F;c+=Rd(c,"/")?"":"/";Rd(c,"/start/")&&(c=c.replace("start/",""));c+=Yga("d/%s/edit",b);ml(a,c);a=a.toString()}return a};function $zi(a){I(this,a,0,-1,null,null)}x($zi,H);$zi.prototype.V=function(){var a=new D;aAi(this,a);return Y(a)};function aAi(a,b){var c=J(a,1);null!=c&&b.Ea(1,c);c=J(a,2);null!=c&&b.Ea(2,c);c=J(a,3);null!=c&&$h(b,3,c);c=J(a,4);null!=c&&b.Ea(4,c)};function bAi(a){I(this,a,0,-1,null,null)}x(bAi,H);bAi.prototype.V=function(){var a=new D;cAi(this,a);return Y(a)};function cAi(a,b){var c=J(a,1);null!=c&&b.Ea(1,c);c=J(a,2);null!=c&&b.Ea(2,c);c=J(a,3);null!=c&&b.Ea(3,c);c=J(a,5);null!=c&&ai(b,5,c);c=J(a,6);null!=c&&G(b,6,c);c=M(a,$zi,7);null!=c&&b.va(7,c,aAi);c=J(a,8);null!=c&&G(b,8,c);c=J(a,9);null!=c&&ai(b,9,c);c=J(a,10);null!=c&&ai(b,10,c);c=J(a,11);null!=c&&ai(b,11,c)}bAi.prototype.Of=function(){return J(this,3)};function dAi(a){I(this,a,"paep",-1,null,null)}x(dAi,H);dAi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ea(1,b);b=J(this,2);null!=b&&a.Ea(2,b);b=M(this,bAi,3);null!=b&&a.va(3,b,cAi);b=J(this,4);null!=b&&F(a,4,b);return Y(a)};dAi.messageId="paep";dAi.prototype.getUrl=function(){return J(this,1)};dAi.prototype.Lf=function(){return J(this,2)};function eAi(a){zl.call(this,"paep");this.C=new dAi(a)}v(eAi,v7);eAi.prototype.Wf=g("C");function fAi(a){I(this,a,0,-1,null,null)}x(fAi,H);fAi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&G(a,1,b);b=J(this,2);null!=b&&a.Ea(2,b);b=J(this,3);null!=b&&F(a,3,b);b=J(this,4);null!=b&&a.Ea(4,b);return Y(a)};fAi.prototype.mj=function(){return J(this,2)};function gAi(a){I(this,a,"rfep",-1,null,null)}x(gAi,H);gAi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ea(1,b);b=J(this,2);null!=b&&a.Ea(2,b);b=J(this,4);null!=b&&a.Ea(4,b);b=J(this,5);null!=b&&a.Ea(5,b);return Y(a)};gAi.messageId="rfep";gAi.prototype.getFunctionName=function(){return J(this,2)};gAi.prototype.Xq=function(){return J(this,5)};function hAi(a){zl.call(this,"rfep");this.C=new gAi(a)}v(hAi,v7);hAi.prototype.Wf=g("C");function iAi(a){I(this,a,"sfep",-1,null,null)}x(iAi,H);iAi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ea(1,b);b=J(this,2);null!=b&&G(a,2,b);b=J(this,3);null!=b&&a.Ea(3,b);return Y(a)};iAi.messageId="sfep";iAi.prototype.zE=function(){return J(this,2)};iAi.prototype.Lf=function(){return J(this,3)};function jAi(a){zl.call(this,"sfep");this.C=new iAi(a)}v(jAi,v7);jAi.prototype.Wf=g("C");function kAi(a){I(this,a,"step",-1,null,null)}x(kAi,H);kAi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ea(1,b);b=J(this,2);null!=b&&F(a,2,b);return Y(a)};kAi.messageId="step";kAi.prototype.u5=function(){return ri(this,2)};function lAi(a){zl.call(this,"step");this.C=new kAi(a)}v(lAi,v7);lAi.prototype.Wf=g("C");function mAi(a){I(this,a,"scpep",-1,null,null)}x(mAi,H);mAi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};mAi.messageId="scpep";function nAi(a){zl.call(this,"scpep");this.C=new mAi(a)}v(nAi,v7);nAi.prototype.Wf=g("C");function oAi(a){I(this,a,"saep",-1,null,null)}x(oAi,H);oAi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ea(1,b);b=J(this,2);null!=b&&a.Ea(2,b);b=J(this,3);null!=b&&a.Ea(3,b);b=J(this,4);null!=b&&a.Ja(4,b);b=J(this,5);null!=b&&a.Ja(5,b);b=J(this,6);null!=b&&G(a,6,b);b=J(this,7);null!=b&&a.Ea(7,b);b=J(this,8);null!=b&&F(a,8,b);b=M(this,eS,9);null!=b&&a.va(9,b,use);return Y(a)};oAi.messageId="saep";p=oAi.prototype;p.getTitle=function(){return J(this,2)};
p.setTitle=function(a){return K(this,2,a)};p.getWidth=function(){return J(this,4)};p.setWidth=function(a){return K(this,4,a)};p.getHeight=function(){return J(this,5)};p.setHeight=function(a){return K(this,5,a)};p.Tv=function(){return oi(this,6)};function pAi(a){zl.call(this,"saep");this.C=new oAi(a)}v(pAi,v7);pAi.prototype.Wf=g("C");function qAi(a){I(this,a,"snep",-1,null,null)}x(qAi,H);qAi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&G(a,1,b);b=J(this,2);null!=b&&a.Ea(2,b);b=J(this,3);null!=b&&a.Ea(3,b);b=J(this,4);null!=b&&a.Ua(4,b);return Y(a)};qAi.messageId="snep";p=qAi.prototype;p.getType=function(){return ti(this,1,0)};p.setType=function(a){return K(this,1,a)};p.clearType=function(){return Bi(this,1)};p.hasType=function(){return oi(this,1)};p.getText=function(){return J(this,2)};
p.hasText=function(){return oi(this,2)};p.getTitle=function(){return J(this,3)};p.setTitle=function(a){return K(this,3,a)};function rAi(a){zl.call(this,"snep");this.C=new qAi(a)}v(rAi,v7);rAi.prototype.Wf=g("C");function sAi(a){I(this,a,"spep",-1,tAi,null)}x(sAi,H);var tAi=[4];sAi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ea(1,b);b=J(this,2);null!=b&&a.Ea(2,b);b=J(this,3);null!=b&&a.Ea(3,b);b=J(this,4);0<b.length&&fi(a,4,b);b=J(this,5);null!=b&&F(a,5,b);b=J(this,6);null!=b&&F(a,6,b);b=J(this,7);null!=b&&a.Ea(7,b);return Y(a)};sAi.messageId="spep";sAi.prototype.getTitle=function(){return J(this,2)};sAi.prototype.setTitle=function(a){return K(this,2,a)};
sAi.prototype.Cf=function(a,b){return Ii(this,4,a,b)};function uAi(a){zl.call(this,"spep");this.C=new sAi(a)}v(uAi,v7);uAi.prototype.Wf=g("C");function vAi(a){I(this,a,"stbep",-1,null,null)}x(vAi,H);vAi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ea(1,b);b=J(this,2);null!=b&&a.Ea(2,b);b=J(this,3);null!=b&&a.Ea(3,b);b=J(this,4);null!=b&&a.Ea(4,b);b=J(this,5);null!=b&&a.Ea(5,b);b=J(this,6);null!=b&&a.Ea(6,b);return Y(a)};vAi.messageId="stbep";p=vAi.prototype;p.getFunctionName=function(){return J(this,2)};p.Yg=function(){return J(this,3)};p.Ik=function(a){K(this,3,a)};p.getUrl=function(){return J(this,5)};
p.Xq=function(){return J(this,6)};function wAi(a){zl.call(this,"stbep");this.C=new vAi(a)}v(wAi,v7);wAi.prototype.Wf=g("C");function xAi(a){I(this,a,"sttep",-1,null,null)}x(xAi,H);xAi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ea(1,b);b=J(this,2);null!=b&&a.Ea(2,b);return Y(a)};xAi.messageId="sttep";xAi.prototype.getText=function(){return J(this,1)};xAi.prototype.hasText=function(){return oi(this,1)};xAi.prototype.Qk=function(){return J(this,2)};xAi.prototype.Td=function(a){K(this,2,a)};function yAi(a){zl.call(this,"sttep");this.C=new xAi(a)}v(yAi,v7);yAi.prototype.Wf=g("C");function zAi(){Jl.call(this);var a=this;this.C=null;this.D=function(b){switch(b[0]){case "amep":b=new Qyi(b);a.dispatchEvent(b);break;case "paep":b=new eAi(b);a.dispatchEvent(b);break;case "rfep":b=new hAi(b);a.dispatchEvent(b);break;case "sfep":b=new jAi(b);a.dispatchEvent(b);break;case "step":b=new lAi(b);a.dispatchEvent(b);break;case "saep":b=new pAi(b);a.dispatchEvent(b);break;case "snep":b=new rAi(b);a.dispatchEvent(b);break;case "spep":b=new uAi(b);a.dispatchEvent(b);break;case "stbep":b=new wAi(b);
a.dispatchEvent(b);break;case "sttep":b=new yAi(b);a.dispatchEvent(b);break;case "scpep":b=new nAi(b),a.dispatchEvent(b)}}}v(zAi,Jl);zAi.prototype.bind=function(a){this.C=a;this.C.subscribe("13",this.D)};zAi.prototype.Ma=function(){this.C&&this.C.unsubscribe("13",this.D);Jl.prototype.Ma.call(this)};function AAi(a,b){Jl.call(this);this.D=new Pl(this);this.qa(this.D);this.C={};this.F=a;this.H=b}v(AAi,Jl);p=AAi.prototype;p.start=function(){this.D.listen(this.H,"sfep",w(this.v0a,this));this.D.listen(this.H,"step",w(this.g5b,this))};function BAi(a,b,c,d){var e=void 0;e=void 0===e?Aa:e;d=void 0===d?Aa:d;d=w(a.f5b,a,b,e,d);a=a.F;b=["ruid",Ia({}),a.C.C,a.D,a.C.H,b,a.C.L,c];b=So(tk(Uo(y7(a,a.C.Ba),"POST"),2),b).Or();d&&(wk(b,w(a.i5b,a,d)),vk(b,w(a.JSb,a,d)));b.Se()}
p.e5b=function(a,b,c,d,e,f){f.qr()?(a=J(f,2),this.C[a]=new CAi(a,b,d,e),c(a,xi(f,3,!1))):(b=new iAi,K(b,2,6),e(b))};p.f5b=function(a,b,c,d){d.qr()?b():(c(),b=new iAi,K(b,1,a),K(b,2,6),this.v0a(new jAi(b.Eb())))};p.g5b=function(a){a=a.Wf();var b=J(a,1);if(ie(this.C,b)){var c=gfa(this.C,b);(0,c.d5b)(a);c.dispose();oe(this.C,b)}};p.v0a=function(a){a=a.Wf();var b=J(a,1);if(ie(this.C,b)){var c=gfa(this.C,b);(0,c.iob)(a);c.dispose();oe(this.C,b)}a="Google Apps Script: "+a.Lf();window.console.log(a)};
p.Ma=function(){Zf(this.C);Jl.prototype.Ma.call(this)};function CAi(a,b,c,d){B.call(this);this.C=b;this.d5b=c;this.iob=d}v(CAi,B);CAi.prototype.getFunctionName=g("C");function DAi(a,b){var c=a.IK,d=a.id,e=a.iZb,f=a.moa,h=a.Mhb,k=a.oX,l=a.Ura;return T('<div class="'+U(a.Zu)+'" aria-labelledby="title'+U(d)+'" tabindex="0"'+(c?' role="complementary"':' role="region"')+'><div class="'+U(e)+'"><div class="'+U(f)+'" id="title'+U(d)+'"></div><div class="'+U(h)+'" tabindex="0" title="'+U("Close sidebar")+'" aria-label="'+U("Close sidebar")+'" role="button">'+Xv({icon:l},b)+'</div></div><div class="'+U(k)+'"></div></div>')}
function EAi(a){a=a.caption;return T('<div class="'+U("docs-script-button-bar-text")+" "+U("docs-titlebar-button")+" "+U("goog-inline-block")+'" tabindex="0">'+Br(a)+"</div>")}function FAi(a){a=a.text;return T('<div class="'+U("docs-script-button-bar-bubble-content")+'">'+Br(a)+"</div>")}
function GAi(a){var b=a.iconName,c=a.title;a=a.description;return T('<div class="'+U("script-promo-menu-item-content")+'"><div class="'+U("script-promo-menu-item-icon")+'" aria-hidden="true"><img src="//ssl.gstatic.com/docs/common/'+U(b)+'.svg"/></div><div class="'+U("script-promo-menu-item-text")+'"><div class="'+U("script-promo-menu-item-title")+'">'+Br(c)+'</div><div class="'+U("script-promo-menu-item-description")+'">'+Br(a)+"</div></div></div>")}
function HAi(a){var b=a.functionName;a=a.uFa;return T('<div class="'+U("func-entry")+'" aria-checked="false" role="radio" tabindex="-1"><div class="'+U("goog-inline-block")+" "+U("func-entry-rb")+'">&nbsp;</div><div class="'+U("goog-inline-block")+" "+U("func-entry-func")+'">'+Br(b)+'</div><div class="'+U("goog-inline-block")+" "+U("func-entry-lib")+'">'+Br(a)+"</div></div>")}
function IAi(a){var b=a.ids,c=a.description;a=a.H_b;var d='<div class="'+U("script-help-dialog-content")+'"><div class="'+U("script-help-dialog-content-left")+" "+U("goog-inline-block")+(a?" "+U("script-help-dialog-content-left-gsm-onhold")+" ":"")+'">';a?(c=d,a='<div class="'+U("script-help-dialog-content-section")+" "+U("script-help-dialog-content-section-gsm-onhold")+'" tabindex="0"><div class="'+U("script-help-dialog-content-title")+'">',d=d={nda:"script-help-dialog-content-title-caution-icon"},
d=d.nda,d=T("<div"+(d?' class="'+U(d)+'"':"")+'><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11,15 L13,15 L13,17 L11,17 L11,15 Z M11,7 L13,7 L13,13 L11,13 L11,7 Z M11.99,2 C6.47,2 2,6.48 2,12 C2,17.52 6.47,22 11.99,22 C17.52,22 22,17.52 22,12 C22,6.48 17.52,2 11.99,2 Z M12,20 C7.58,20 4,16.42 4,12 C4,7.58 7.58,4 12,4 C16.42,4 20,7.58 20,12 C20,16.42 16.42,20 12,20 Z" id="path-1"></path></defs><g id="caution" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="alert/error_outline_24px"><mask id="mask-2" fill="white"><use xlink:href="#path-1"></use></mask><g id="ic_error_outline_24px" fill-rule="nonzero"></g><g id="_c/Red/600" mask="url(#mask-2)" fill="#D93025" fill-rule="evenodd"><rect id="swatch" x="0" y="0" width="24" height="24"></rect></g></g></g></svg></div>'),
d=c+(a+d+"<span>Add-on not available in \r\n G Suite Marketplace</span></div><div>The developer of this add-on has not accepted the terms and conditions of G Suite Marketplace.</div></div>")):(d+='<div class="'+U("script-help-dialog-content-section")+'" tabindex="0"><div class="'+U("script-help-dialog-content-title")+'">',d=d+"Getting started</div><div>"+(Br(c)+"</div></div>"));d+='</div><div id="'+U(b.bca)+'" class="'+U("script-help-dialog-buttons")+" "+U("goog-inline-block")+'"></div></div>';return T(d)}
function JAi(a){var b=a.Snb;a='<p class="'+U("script-reportissue-dialog-description-label")+'" tabindex="0">';var c="Describe the issue for the creators of <strong>"+(Br(b)+"</strong>:");a=a+c+('</p><textarea class="'+U("jfk-textinput")+" "+U("script-reportissue-dialog-description")+'"></textarea><p class="'+U("script-reportissue-dialog-disclaimer")+'" tabindex="0">');a=a+'Only this description will be sent, no information from your open document.</p><div class="'+(U("script-reportissue-dialog-nonanonymous")+
'" tabindex="0"><div class="'+U("script-reportissue-dialog-nonanonymous-control")+" "+U("goog-inline-block")+'"><div class="'+U("script-reportissue-dialog-nonanonymous-checkbox")+" "+U("jfk-checkbox")+'"></div></div><div class="'+U("script-reportissue-dialog-nonanonymous-label")+" "+U("goog-inline-block")+'"><div class="'+U("script-reportissue-dialog-nonanonymous-optional-text")+" "+U("goog-inline-block")+'">');a+="(Optional)</div> ";b="Include your name and email address so the creators of <strong>"+
(Br(b)+" </strong>can follow up.");a=a+b+"</div></div>";return T(a)}
function KAi(a,b){a=a||{};a=a.Ob;var c='<div class="'+U("func-actions")+'">';c+=zu({id:"func-action-new",content:Fr("New"),style:0},b);c+=zu({id:"func-action-run",content:Fr("Run"),style:0,hd:"jfk-button-collapse-right"},b);c+=zu({id:"func-action-edit",content:Fr("Edit"),style:0,hd:"jfk-button-collapse-left"},b);c+=zu({id:"func-action-reload",content:Fr(""+Xv({icon:a?"docs-icon-img docs-icon-reload-rtl":"docs-icon-img docs-icon-reload"},b)),style:0,width:1,title:"Reload"},b);c+='</div><div class="'+
U("func-header")+'"><div class="'+U("func-header-rb")+" "+U("goog-inline-block")+'"></div><div class="'+U("func-header-func")+" "+U("goog-inline-block")+'">';c=c+'Function</div><div class="'+(U("func-header-lib")+" "+U("goog-inline-block")+'">');c=c+'Script</div></div><div class="'+(U("func-entries")+'" role="radiogroup" tabindex="0"></div>');return T(c)}function LAi(){var a='<div class="'+U("func-loading")+'">';return T(a+"Fetching scripts\u2026</div>")}
function MAi(){var a='<div class="'+U("func-none")+'">';return T(a+"No scripts found</div>")};function NAi(){}v(NAi,at);NAi.prototype.Rb=m("func-entry");NAi.prototype.ah=m(!1);NAi.prototype.Ca=function(a){return yr(HAi,{functionName:a.getFunctionName(),uFa:a.L0b},void 0,a.oa())};Ba(NAi);function OAi(a,b,c,d,e,f){et.call(this,null,d||NAi.getInstance(),e);this.MZa=a;this.C=void 0!==f?f:null;this.L0b=b;this.D=c;this.Sf(16,!0);this.Sf(32,!0);ht(this,16,!0);gt(this,16,!1)}v(OAi,et);OAi.prototype.fq=function(a){et.prototype.fq.call(this,a);a&&this.getElement()&&this.getElement().focus()};OAi.prototype.Xq=g("C");OAi.prototype.getFunctionName=g("D");OAi.prototype.qc=function(a){et.prototype.qc.call(this,a);this.Gb(a);this.getElement()&&zm(this.getElement(),a)};function PAi(a,b){Ov.call(this,void 0,void 0,a);this.O=b||!1;this.ot=new rZa;this.qa(this.ot);this.qe=new Ws;this.qa(this.qe);this.H=new Au("");this.qa(this.H);this.C=new Au("");this.qa(this.C);this.F=new Au("");this.qa(this.F);this.L=new Au("");this.qa(this.L);a=new ws(a);a.set("close","Close",!1,!0);vs(this,!1);Cs(this,a);this.setTitle("Script manager")}v(PAi,Ov);p=PAi.prototype;
p.reset=function(a){this.ot.clear();this.xd(!0);0===a?(a=yr(LAi,{},void 0,this.oa()),a=new et(a),a.Sf(32,!1),this.Ga(a,!0)):1===a&&(a=yr(MAi,{},void 0,this.oa()),a=new et(a),a.Sf(32,!1),this.Ga(a,!0))};p.focus=function(){if(this.ub()&&0<this.ot.Lh()){var a=this.ot.rf();a&&a.fq(!0)}else Ov.prototype.focus.call(this)};p.xd=function(a){a=Ov.prototype.xd.call(this,a);this.ot.clear();QAi(this);return a};
p.zf=function(a,b,c){Ov.prototype.zf.call(this,a,b,c);a instanceof OAi&&(b=a.isChecked(),this.ot.Zc(a),1==this.ot.Lh()||b)&&(Xt(this.ot,a),a.fq(!0));QAi(this)};p.Ca=function(){Ov.prototype.Ca.call(this);var a=this.xb();bs(a,"script-explorer-contents");wr(a,KAi,{Ob:this.O});a=tm(um(a));this.H.Va(a[0]);this.F.Va(a[1]);this.C.Va(a[2]);this.L.Va(a[3]);Ms(this,"run")};
p.Ia=function(){Ov.prototype.Ia.call(this);Xs(this.qe,this.xb());QAi(this);this.addEventListener("dialogselect",we(!0));Dl(this,"action",this.CVa,void 0,this);Dl(this.qe,"key",this.gWa,void 0,this);var a=new As("new",this.H.getContent());Dl(this.H,"action",w(this.dispatchEvent,this,a));a=new As("run",this.F.getContent());Dl(this.F,"action",w(this.dispatchEvent,this,a));a=new As("edit",this.C.getContent());Dl(this.C,"action",w(this.dispatchEvent,this,a));a=new As("reload",this.L.getContent());Dl(this.L,
"action",w(this.dispatchEvent,this,a))};p.Bd=function(){Ov.prototype.Bd.call(this);Ys(this.qe);Gl(this,"action",this.CVa,void 0,this);Gl(this.qe,"key",this.gWa,void 0,this);Il(this.H);Il(this.F);Il(this.C);Il(this.L)};p.xb=function(){var a=Ov.prototype.xb.call(this),b=tm(a);return 0<b.length?b[2]:a};p.CVa=function(a){QAi(this);a.target instanceof OAi&&(Xt(this.ot,a.target),a.target.fq(!0))};
p.gWa=function(a){var b=this.ot.Lh();if(0<b)switch(a.keyCode){case 38:var c=this.ot;b=zk(this.ot.ji()-1,b);Xt(c,c.zg(b));a.preventDefault();this.focus();break;case 40:c=this.ot,b=zk(this.ot.ji()+1,b),Xt(c,c.zg(b)),a.preventDefault(),this.focus()}};function QAi(a){var b=!!a.ot.rf();a.F.setVisible(b);a.C.setVisible(b)};function RAi(a,b){this.D=a;this.C=b}function SAi(a){a.D.R&&Dzi(a.C,function(){if(O("macros-extensions").isEnabled()){a.D.Aa&&!a.D.C&&a.C.AV();var b=a.D.ma;if(b&&(b=a.C.getExtension(new Tyi(b))||Xzi(a.C,b))){var c=a.C,d=c.C.O;d&&(Lzi(c.C),c=w(c.C.wN,c.C),TAi(d,w7(b),c))}}})};function UAi(){B.call(this);this.F=new Lk}v(UAi,av);UAi.prototype.C=function(){return this.F.Kd()};function Rzi(a,b){a.F.set(b.getId(),b)}UAi.prototype.Pc=function(){this.F.clear()};function Qzi(a,b){S.call(this,b);this.C=a}v(Qzi,S);
Qzi.prototype.Ca=function(){S.prototype.Ca.call(this);var a=this.C==(Iu(),Eu)?"Do more with Docs":this.C==(Iu(),l0a)?"Do more with Forms":this.C==(Iu(),Fu)?"Do more with Sheets":this.C==(Iu(),Gu)?"Do more with Slides":"Do more with Docs",b=this.C==(Iu(),Eu)?"Looking for even more Docs features? Get a few add-ons.":this.C==(Iu(),l0a)?"Looking for even more Forms features? Get a few add-ons.":this.C==(Iu(),Fu)?"Looking for even more Sheets features? Get a few add-ons.":this.C==(Iu(),Gu)?"Looking for even more Slides features? Get a few add-ons.":
"Looking for even more Docs features? Get a few add-ons.",c=this.C==(Iu(),Eu)?"addon_docs_promo":this.C==(Iu(),l0a)?"addon_forms_promo":this.C==(Iu(),Fu)?"addon_sheets_promo":this.C==(Iu(),Gu)?"addon_slides_promo":"addon_docs_promo",d=this.oa();this.Mc(yr(GAi,{title:a,description:b,iconName:c},void 0,d))};function VAi(){}v(VAi,qt);VAi.prototype.Ca=function(a){a=qt.prototype.Ca.call(this,a);Tr(a,"menuitem");return a};VAi.prototype.Rb=m("goog-control");VAi.prototype.Oo=function(a){a=qt.prototype.Oo.call(this,a);a.push("menu-button","goog-inline-block");return a};Ba(VAi);function WAi(a,b,c,d,e){B.call(this);this.O=b;this.R=c;this.H=a;this.D={};this.Aa={};this.xa={};this.ma=[];this.ea=[];this.J=d||null;this.L=e||null;this.C=new UAi;this.F=new UAi;this.Ha=new Pl;this.qa(this.Ha);this.Ba=[]}v(WAi,B);WAi.prototype.Ma=function(){Zf(this.D);B.prototype.Ma.call(this)};WAi.prototype.gt=function(a){return ie(this.D,a)};
function XAi(a,b,c){c=c?[c]:ge(a.D);for(var d=0;d<c.length;d++)for(var e=c[d].zb(),f=0;f<e.Qb();f++){var h=e.Gc(f);if(h instanceof Ct&&h.getId()==b||h instanceof Mt&&(h=XAi(a,b,h)))return h}return null}
function YAi(a,b,c,d,e){if(J(b,3)){var f=ri(b,7)||!1,h=b.Yg(),k=J(b,10),l=new Ct("");l.Dc(b.Me()||String(Ia(l)));var n=[mm(h)];d&&b.getKey()&&(d+=b.getKey().toUpperCase(),d=c_a(l,O("macros-exec"),[d]),a.ma.push(d),n.push(d));l.setContent(n);b=new Lyi(J(b,4),J(b,3),void 0,J(b,9)||void 0,void 0,b.Xq()||void 0);nu(a.O,l,O("macros-exec"),null,we(b),azi(3,e));l.Na(f);a.L&&f&&k&&(e=h+(" ("+(k+")")),c.push(a.L.Bs(O("macros-exec"),[b],we(e),we(e))[0]));return l}if(!b.Yg())return new Gt;if(0<b.lh().length){l=
new Ht;f=b.lh();for(h=0;h<f.length;h++)l.Ga(YAi(a,f[h],c,d,e),!0);a=new Mt(b.Yg());a.Dc(b.Me()||String(Ia(a)));a.Ce(l);return a}throw Error("Unsupported menu item type.");}WAi.prototype.La=function(a,b){return Td(a.getName(),b.getName())};function Uzi(a,b,c,d,e){if(b.gia()){var f=new Myi,h=String(Ia(f));K(f,1,h);b.Ga(YAi(a,f,d),!0)}d=new Ct("Help");d.Dc(String(Ia(d)));nu(a.O,d,O("macros-extension-help"),null,we(c),azi(3,e));d.Na(!0);b.Ga(d,!0)}
function Tzi(a,b,c){var d=new Ct("");d.Dc("addon-menu-install-"+w7(c));nu(a.O,d,O("macros-extension-install-start"),qu,we(w7(c)),azi(3,c));d.Na(!0);b.Ga(d,!0)}function Szi(a){$2a(a.J,"docs-macros-extension-promo")||fv(a.J,"docs-macros-extension-promo",[a.F,null]);$2a(a.J,"docs-macros-extensions")||fv(a.J,"docs-macros-extensions",[a.C]);a.J.zb("docs-extensions-menu",!0);Pw()&&a.J.zb("macros-extension-add-ons-menu",!0)}
function TAi(a,b,c){var d=c||Aa;(c=a.C.F.get(b))?-1===a.Ba.indexOf(b)?(b=Dn(w(function(e){e.dispatchEvent("load")},a,c),1E4),b=w(function(e,f,h){this.H.k9("docs-extensions-menu");e.Eg(!0);e.FG();En(h);f()},a,c,d,b),a.Ha.Rc(c,"load",b)):(a.H.k9("docs-extensions-menu"),c.FH(),c.Eg(!0),c.FG(),d()):d()};function ZAi(a,b){var c=a.Ura,d=a.IK;a='<div class="'+U(a.Zu)+'" aria-labelledby="addon-sidebar-title" tabindex="0"'+(d?' role="complementary"':' role="region"')+'><div class="'+U("addon-sidebar-header")+'"><div class="'+U("addon-sidebar-title")+'" id="addon-sidebar-title">';a+="Document add-ons";c=Fr(""+Xv({icon:c},b));a+="</div>"+zu({hd:"addon-sidebar-close docs-material",content:c,style:4,title:"Close sidebar"},b)+'</div><div class="'+U("addon-sidebar-content")+'"><div class="'+U("addon-sidebar-banner")+
'"></div><div class="'+U("addon-sidebar-introduction")+'"></div></div><div class="'+U("addon-sidebar-empty-caption")+'"><div class="'+U("addon-sidebar-empty-title")+'">';a=a+'No document add-ons</div><div class="'+(U("addon-sidebar-empty-description")+'">');return T(a+"This document doesn't include any add-ons</div></div></div>")}
function $Ai(a){var b=a.Zfb;a=a.Wfb;return T('<img class="'+U("addon-sidebar-banner-image")+'" src='+uU(Jr(b))+" alt="+uU(a)+' /><div class="'+U("addon-sidebar-banner-image-overlay")+'"></div>')};function aBi(a){var b=a.icon,c=a.title,d=a.category,e=a.summary,f=a.isInstalled,h=a.Fxc;a=T;b='<div class="'+U("addon-sidebar-card")+'" aria-label="'+U(c)+'" tabindex="0" role="region"><div class="'+U("addon-sidebar-card-header")+'"><div class="'+U("addon-sidebar-card-icon")+'">'+(b?'<img class="'+U("addon-sidebar-card-icon-image")+'" src='+uU(Jr(b))+" alt="+uU(c)+" />":"")+'</div><div class="'+U("addon-sidebar-card-header-content")+'"><div class="'+U("addon-sidebar-card-title")+'"><div class="'+
U("addon-sidebar-card-title-caption")+(h?" "+U("addon-sidebar-card-two-line-title-caption"):"")+'">'+Br(c)+"</div>";f?(c=c={nda:"addon-sidebar-card-check",color:"#455A64"},f=c.nda,c=c.color,f=T("<div"+(f?' class="'+U(f)+'"':"")+'><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 48 48" fill="'+U(null!=c?c:"#000")+'"><path d="M0 0h48v48H0z" fill="none"/><path d="M24 4C12.95 4 4 12.95 4 24c0 11.04 8.95 20 20 20 11.04 0 20-8.96 20-20 0-11.05-8.96-20-20-20zm-4 30L10 24l2.83-2.83L20 28.34l15.17-15.17L38 16 20 34z"/></svg></div>')):
f="";return a(b+f+'</div><div class="'+U("addon-sidebar-card-category")+'">'+Br(d)+"</div></div></div>"+(e?'<div class="'+U("addon-sidebar-card-summary")+'">'+Br(e)+"</div>":"")+"</div>")};function bBi(){}v(bBi,mD);bBi.prototype.Rb=m("docs-material-menu-button-flat-primary");bBi.prototype.Go=function(){return yr(Glc,{className:"docs-material-menu-button-flat-primary-dropdown"})};Ba(bBi);function cBi(a,b,c,d,e){c=void 0===c?bBi.getInstance():c;Nt.call(this,a,b,c,d,e)}v(cBi,Nt);function dBi(){}v(dBi,mD);dBi.prototype.Rb=m("docs-material-menu-button-raised-primary");dBi.prototype.Go=function(){return yr(Glc,{className:"docs-material-menu-button-raised-primary-dropdown"})};Ba(dBi);function eBi(a,b,c,d,e){c=void 0===c?dBi.getInstance():c;Nt.call(this,a,b,c,d,e)}v(eBi,Nt);function fBi(a,b,c,d,e){B.call(this);this.D=a;this.C=b;this.F=c;this.H=d;this.eb=e||Wl()}v(fBi,B);
function gBi(a,b){if(!b)return hBi(a);b=b.lh();if(1==b.length&&J(b[0],3)){var c=hBi(a);b=b[0];c.Na(!!ri(b,7));b=new Lyi(J(b,4),J(b,3),void 0,J(b,9)||void 0);nu(a.D,c,O("macros-exec"),{enabled:!0},we(b),a.F);return c}c=new Ht(a.eb);for(var d=0;d<b.length;d++)c.Ga(iBi(a,b[d]),!0);b=[mm("Use")];a=a.C?new eBi(b,c,void 0,a.eb):new cBi(b,c,void 0,a.eb);a.xe("Use");a.Sb("addon-sidebar-card-menu-button");a.Na(!0);return a}
function iBi(a,b){if(J(b,3)){var c=b.Yg(),d=new Ct("");d.Sb(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");d.setContent([mm(c)]);c=new Lyi(J(b,4),J(b,3),void 0,J(b,9)||void 0);nu(a.D,d,O("macros-exec"),{enabled:!0},we(c),a.F);d.Na(!!ri(b,7));return d}if(!b.Yg())return new Gt;if(0<b.lh().length){d=new Ht(a.eb);c=b.lh();for(var e=0;e<c.length;e++)d.Ga(iBi(a,c[e]),!0);b=new Mt(b.Yg());b.Sb(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");
b.Ce(d);return b}throw Error("Unsupported menu item type.");}function hBi(a){var b=[mm("Use")];a=a.C?new Csf(b,a.eb):new dP(b,a.eb);a.xe("Use");a.Sb("addon-sidebar-card-button");a.Na(!1);return a};function jBi(a,b,c,d,e){S.call(this,e);this.C=a;this.ma=b;this.R=ri(this.C,19)||!1;this.H=!(!ri(this.C,10)&&!ri(this.C,9));this.L=new lu(void 0,void 0,!0,iw.getInstance());this.qa(this.L);this.ea=azi(10,this.C);this.J=new et(void 0,void 0,e);this.qa(this.J);this.F=new fBi(this.L,c,this.ea,d,e);this.qa(this.F);if(this.H)a=gBi(this.F);else{a=this.F;b=this.C;a:switch(a.H){case Iu(),Eu:c="Add to Docs";break a;case Iu(),Gu:c="Add to Slides";break a;case Iu(),Fu:c="Add to Sheets";break a;default:throw Error("Unsupported document type");
}d=[mm(c)];d=a.C?new Csf(d,a.eb):new dP(d,a.eb);d.xe(c);d.Sb("addon-sidebar-card-button");d.Na(!1);nu(a.D,d,O("macros-extension-install-start"),{enabled:!0},we(w7(b)),a.F);a=d}this.D=a;a=this.F;b=this.C;c=new dP([mm("Help")],a.eb);c.xe("Help");c.Sb("addon-sidebar-card-button");c.Na(!1);c.Td("Help");nu(a.D,c,O("macros-extension-help"),{enabled:!0},we(w7(b)),a.F);this.O=c}v(jBi,S);
jBi.prototype.Ca=function(){S.prototype.Ca.call(this);var a=J(this.C,15)||"";a&&(a=jl(new il(a),"https").toString());var b=this.oa();a={icon:a,title:this.C.getName(),category:this.C.Ij(),isInstalled:this.H,summary:J(this.C,14),Fxc:Nf};b=yr(aBi,a,void 0,b);this.kb(b);this.Mc(b)};jBi.prototype.Mc=function(a){S.prototype.Mc.call(this,a);a=this.Da("addon-sidebar-card-title-caption");Tr(a,"button");this.Ga(this.J);this.J.Va(a)};
jBi.prototype.Ia=function(){S.prototype.Ia.call(this);nu(this.L,this.J,O("macros-manage-extensions"),{},we(x7(this.C)),this.ea);kBi(this);!this.H&&this.R&&(this.Ga(this.O,!0),this.O.Na(!0))};jBi.prototype.Ma=function(){Yf(this.D);Yf(this.O);S.prototype.Ma.call(this)};function lBi(a,b){a.H&&(a.D.getParent()==a&&a.removeChild(a.D,!0),Yf(a.D),a.D=gBi(a.F,b),a.ub()&&kBi(a))}
function kBi(a){a.Ga(a.D,!0);a.H||(a.D.Na(a.ma&&!a.R),a.ma?a.R&&a.D.Td("Add-on not available in G Suite Marketplace"):a.D.Td("Disabled for your organization"))};function mBi(a,b,c){BR.call(this,c);this.D={};this.C=[];this.ea=!1;this.H=a;this.ma=b;this.J={};this.F=new jK(this.oa(),"addon-sidebar-spinner");this.Ga(this.F);this.R=new Au(void 0,this.oa());this.L=this.O=!1}v(mBi,BR);p=mBi.prototype;p.Ca=function(){BR.prototype.Ca.call(this);var a={Zu:"addon-sidebar",Ura:Pp("close-white"),IK:y(A(),"docs-eal")};a=yr(ZAi,a,void 0,this.oa());this.kb(a);this.Mc(a)};
p.Mc=function(a){BR.prototype.Mc.call(this,a);this.F.render(this.xb());a=this.F.Ka();Yr(a,"Loading");Tr(a,"status");Vr(a,"live","polite")};p.Ia=function(){BR.prototype.Ia.call(this);nBi(this,!1);oBi(this,!1);this.R.Va(this.Da("addon-sidebar-close"));this.getHandler().sf(this.R.Ka(),Fl,w(this.w0a,this)).listen(this.getElement(),"keyup",this.sVb);this.O&&Wzi(this)};p.xb=function(){return this.Za("addon-sidebar-content")};
function Wzi(a){a.F.setVisible(!1);oBi(a,a.H);nBi(a,0==a.C.length);pBi(a,a.L);qBi(a);jd(a.C,function(b){var c=w7(b);b=new jBi(b,this.ea,this.L,this.ma,this.oa());lBi(b,this.J[c]);this.Ga(b,!0);this.D[c]=b},a)}function qBi(a){be(a.D,function(b){this.removeChild(b,!0);Yf(b)},a);ne(a.D)}function nBi(a,b){if(a.ub()){var c=a.Da("addon-sidebar-empty-caption");P(c,b)}b&&oBi(a,!1)}
function oBi(a,b){if(a.ub()){var c=a.Da("addon-sidebar-introduction");b&&!Am(c)&&ym(c,1<a.C.length?"This template is optimized to work with these add-ons":"This template is optimized to work with this add-on");P(c,b)}}function Vzi(a){return 0==a.C.length?null:(a=J(a.C[0],16)||J(a.C[0],17))?jl(new il(a),"https").toString():null}
function pBi(a,b){if(a.ub()){fs(a.getElement(),"addon-sidebar-with-banner",b);var c=a.Da("addon-sidebar-banner");b?(b=Vzi(a))&&wr(c,$Ai,{Zfb:b,Wfb:a.C[0].getName()}):pm(c)}}p.Tnb=function(a,b){return Td(a.getName(),b.getName())};p.sVb=function(a){27==a.keyCode&&(this.getElement()==a.target&&this.w0a(),a.stopPropagation())};p.w0a=function(){this.setVisible(!1);oBi(this,!1);this.H=!1;O("docs-focus-editor").ob()};p.ah=m(!1);function rBi(a,b){NR.call(this,a,b)}v(rBi,NR);rBi.prototype.oo=function(){return O("macros-addon-sidebar-focus")};rBi.prototype.Nf=function(){return O("macros-addon-sidebar")};rBi.prototype.As=function(a){var b=this.hc;b.ub()||b.render();NR.prototype.As.call(this,a)};rBi.prototype.K8a=function(a){a&&this.Nf().isVisible()&&this.As(!0)};function sBi(a,b,c){this.F=a;this.D=b;this.C=c;Object.defineProperties(this,{path:{get:w(this.U4b,this),set:w(this.ztc,this)},invoke:{get:w(this.yub,this),set:w(this.utc,this)},arity:{get:w(this.lpb,this),set:w(this.$sc,this)}})}p=sBi.prototype;p.U4b=g("F");p.ztc=da("F");p.yub=g("D");p.utc=da("D");p.lpb=g("C");p.$sc=da("C");function tBi(a,b,c,d,e){S.call(this,e);this.L=a;this.H=b;this.F=c;this.C=d}v(tBi,S);
tBi.prototype.Ca=function(){var a=ed(A(),"docs-tfh"),b=this.L;a&&(b=Ie(b,{allow_parent:a}));a=GWa(this.oa());lf(a,b);a.width="100%";a.height="100%";a.marginWidth="0";a.marginHeight="0";a.scrolling="no";a.allow="accelerometer ambient-light-sensor autoplay camera encrypted-media fullscreen geolocation gyroscope magnetometer microphone midi payment picture-in-picture speaker usb vr".split(" ").map(function(c){return c+" *;"}).join(" ");this.kb(a);va("payload",this.H,a);va("adapter.hostFunctions",this.F,
a);Pa("adapter.getSessionId",w(this.D,this),a);Pa("adapter.getState",w(this.J,this),a)};tBi.prototype.ah=m(!1);tBi.prototype.D=function(){var a=this.C().C;return null!==a?String(a):null};tBi.prototype.J=function(){return this.C().getState()};function uBi(a,b,c,d,e,f,h,k,l){Ov.call(this,void 0,void 0,l);var n=w(this.setVisible,this,!1),q=w(this.H,this),t=w(this.F,this);e&&this.setTitle(e);this.Pg=f||500;this.Ve=h||300;this.C=new tBi(a,b,[new sBi("google.script.host.close",n,0),new sBi("google.script.host.closeDialog",n,0),new sBi("google.script.host.editor.focus",w(d.Cb,d,3),0),new sBi("google.script.host.setWidth",q,1),new sBi("google.script.host.setHeight",t,1)],c,l);this.Ga(this.C);vs(this,!!k);Cs(this,null)}v(uBi,Ov);
uBi.prototype.H=function(a){!isFinite(a)||0>a||Yq(this.xb(),Math.min(a,Math.floor(.8*gm().width)))};uBi.prototype.F=function(a){!isFinite(a)||0>a||Zq(this.xb(),Math.min(a,Math.floor(.8*gm().height)))};uBi.prototype.Ca=function(){Ov.prototype.Ca.call(this);bs(this.getElement(),"script-app-dialog");var a=this.xb();bs(a,"script-app-contents");Yq(a,Math.min(this.Pg,Math.floor(.8*gm().width)));Zq(a,Math.min(this.Ve,Math.floor(.8*gm().height)));this.C.render(a)};uBi.prototype.ah=m(!1);function vBi(a){BR.call(this,a);this.C=this.F=this.D=this.H=null}v(vBi,BR);p=vBi.prototype;p.fka=function(){this.C&&(this.removeChild(this.C,!0),this.C.dispose(),this.C=null);this.setVisible(!1)};p.focus=function(){this.C.getElement().focus()};p.xb=g("F");
p.Ca=function(){var a=this.oa(),b={id:this.getId(),Zu:"script-application-sidebar",iZb:"script-application-sidebar-header",moa:"script-application-sidebar-title",Mhb:"script-application-sidebar-close",oX:"script-application-sidebar-content",Ura:Pp("close-white"),IK:y(A(),"docs-eal")};b=yr(DAi,b,void 0,a);this.kb(b);this.H=a.Za("script-application-sidebar-title",b);this.D=a.Za("script-application-sidebar-close",b);this.F=a.Za("script-application-sidebar-content",b)};
p.Ia=function(){BR.prototype.Ia.call(this);this.getHandler().sf(this.D,Fl,w(this.fka,this))};p.ah=m(!1);p.Ma=function(){delete this.H;delete this.D;delete this.F;delete this.C;BR.prototype.Ma.call(this)};function wBi(a,b){NR.call(this,a,b)}v(wBi,NR);wBi.prototype.oo=function(){return O("macros-application-focus")};wBi.prototype.Nf=function(){return O("macros-application-sidebar")};function xBi(a,b){var c=null;c=c||rr("",{target:"_blank",height:500,width:600,top:(screen.height-500)/2,left:(screen.width-600)/2,scrollbars:!0});nf(c.location,a);b!=Aa&&(a=new dfc(function(){return c?c.closed:!0}),a.Cx=b,a.start(100,-1))};function yBi(a,b,c,d,e){Ov.call(this,void 0,!0,c);this.H=a;this.F=d||Aa;rs(this,b);this.setVisible(!0);this.dj=!0;Bs(this,!1);Cs(this,(new ws).Cf(fXa,!0).Cf(Gs,!1,!0));this.setTitle(e||"Authorization Required");Ms(this,fXa.key)}v(yBi,Ov);yBi.prototype.Ia=function(){Ov.prototype.Ia.call(this);this.addEventListener("dialogselect",this.C)};yBi.prototype.Bd=function(){Ov.prototype.Bd.call(this);this.removeEventListener("dialogselect",this.C)};
yBi.prototype.C=function(a){"cancel"!=a.key?xBi(this.H,this.F):this.F();this.setVisible(!1)};function zBi(a){Ov.call(this,void 0,void 0,void 0);this.F=a;this.C=null;this.dj=!0;this.setTitle("Message details");Cs(this,gXa())}v(zBi,Ov);zBi.prototype.Ca=function(){Ov.prototype.Ca.call(this);var a=this.xb();bs(a,"script-error-dialog-content");this.C=mm(this.F);a.appendChild(this.C)};zBi.prototype.Ma=function(){Ov.prototype.Ma.call(this);this.C&&rm(this.C)};function ABi(a){B.call(this);this.C=a}v(ABi,B);function BBi(a,b){var c=Xd("Running script ");c=im("SPAN",null,c);b=b?Ru(c,"Cancel",b,"info",!0):Qu(c,"info",!0);a.C.postMessage(b);return b.getId()}function CBi(a,b,c){var d=(c=void 0===c?null:c)?c:"Script "+(vf(b)+" experienced an error");b=im("SPAN","script-error-message",d);b.style.maxWidth="600px";a.C.postMessage(Ru([b],"Details",function(){(new zBi(d)).setVisible(!0)},"warning",!0))}ABi.prototype.Ma=function(){delete this.C};function DBi(){B.call(this);this.C=null;this.D=new Pl;this.qa(this.D)}v(DBi,B);DBi.prototype.Ma=function(){EBi();FBi(this);B.prototype.Ma.call(this)};function FBi(a){a.D.Pc();a.C&&(a.C.dispose(),a.C=null);EBi()}function EBi(){var a=Zl("docs-script-button-bar");a&&pm(a)};var GBi=new SF(["http","https"]);function HBi(a){a=Bf(a);if(Wd(a)||Yd(a,'"'))return null;var b=Tk(1,a);return b?GBi.contains(b.toLowerCase())?a:null:null};function IBi(a,b,c,d,e,f,h){h=void 0===h?!1:h;Ov.call(this);this.Zi=Wd(Bf(b))?"You can find "+(a+" in the Add-ons menu."):b;this.ma=c;this.Ba=d;this.H=HBi(e);this.ea=HBi(f);this.L=h;this.R=or(this,JBi);this.C=VR("Learn more");this.Ga(this.C);this.F=new Au("Report an issue");this.Ga(this.F);this.O=new Au("View in store");this.Ga(this.O);this.setTitle(Xd("Help for "+a));a=new ws;a.Cf({key:Gs.key,caption:"Close"},!1,!0);Cs(this,a);Ms(this,"ok")}v(IBi,Ov);p=IBi.prototype;
p.Ca=function(){Ov.prototype.Ca.call(this);var a=this.xb();wr(a,IAi,{description:this.Zi,ids:this.R,H_b:this.L});bs(a,"script-help-dialog")};
p.Ia=function(){Ov.prototype.Ia.call(this);var a=this.oa().getElement(this.R.bca);this.L?(this.F.render(a),this.getHandler().listen(this.F,"action",this.ZWa),this.C.render(a),this.getHandler().listen(this.C,"action",this.x0a)):(this.H&&(this.C.render(a),this.getHandler().listen(this.C,"action",this.x0a)),this.F.render(a),this.getHandler().listen(this.F,"action",this.ZWa),this.O.render(a),this.getHandler().listen(this.O,"action",this.YXb))};
p.x0a=function(){this.L?rr("https://support.google.com/docs?p=GSM_migration"):this.H&&rr(this.H)};p.ZWa=function(){this.ea?rr(this.ea):(this.ma(),this.dispose())};p.YXb=function(){this.Ba();this.dispose()};var JBi={bca:"script-help-dialog-buttonbar"};function KBi(a,b,c,d){zl.call(this,"Ll");this.title=d}v(KBi,zl);function LBi(a,b,c,d,e,f){Ov.call(this,void 0,void 0,f);this.L=b;this.F=d;this.H=e;this.C=null;this.setTitle(a);vs(this,!0);a=new ws(f);for(b=0;b<c.length;++b)d=c[b],a.set(d,MBi[d]);a.D="0";Cs(this,a)}v(LBi,Ov);p=LBi.prototype;p.Ca=function(){Ov.prototype.Ca.call(this);var a=this.oa(),b=this.xb();bs(b,"script-prompt-contents");for(var c=a.Ca("DIV"),d=this.L.split("\n"),e=0;e<d.length;++e)0<e&&c.appendChild(a.Ca("BR")),c.appendChild(Lm(a,d[e]));b.appendChild(c);this.F&&(this.C=a.Ca("INPUT"),b.appendChild(this.C))};
p.ah=m(!1);p.Ia=function(){Ov.prototype.Ia.call(this);this.getHandler().listen(this,"dialogselect",w(this.k5b,this))};p.focus=function(){Ov.prototype.focus.call(this);this.C&&this.C.focus()};p.k5b=function(a){this.H(Number(a.key),this.F?this.C.value:null)};var MBi={1:"Ok",4:"Cancel",2:"Yes",3:"No"};function NBi(a,b){Ov.call(this);this.H=a;this.F=b;Cs(this,(new ws).Cf({key:"send",caption:"Send"},!0).Cf({key:"cancel",caption:"Cancel"},!1,!0));this.setTitle("Report an issue");this.C=new xu;this.Ga(this.C)}v(NBi,Ov);p=NBi.prototype;p.Ca=function(){Ov.prototype.Ca.call(this);Ms(this,"send");var a=this.xb();bs(a,"script-reportissue-dialog-content");wr(a,JAi,{Snb:this.F})};
p.Ia=function(){Ov.prototype.Ia.call(this);this.C.Va(this.Da("script-reportissue-dialog-nonanonymous-checkbox"));this.rab();var a=this.getHandler();a.listen(this.Da("script-reportissue-dialog-description"),"input",this.rab);a.listen(this,"dialogselect",this.l5b)};p.Nd=function(){return this.Da("script-reportissue-dialog-description").value};p.rab=function(){var a=!Wd(this.Nd());Es(this.D,"send",a)};p.l5b=function(a){if("send"!=a.key)return!0;this.H(this.Nd(),this.C.isChecked());return!0};function OBi(a,b){B.call(this);this.D={};this.F={};this.J=0;this.O=b;this.C=a;this.C.gK(w(this.j5b,this))}v(OBi,B);p=OBi.prototype;p.connect=function(a){this.C.isConnected();this.C.connect(a)};p.isConnected=function(){return this.C.isConnected()};p.fNb=function(a,b){var c=PBi(this,b[0]),d=PBi(this,b[1]);b=Fd(b,2);try{var e=a.apply(this,b);"function"===typeof e?e(c,d):c.call(this,e)}catch(f){d.call(this,null)}};
p.j5b=function(a,b){if(Pd(a,"callback.")&&ie(this.D,a)){var c=gfa(this.D,a);b=null!=b?JSON.parse(b):null;var d=this.F[a];d&&(oe(this.D,d),oe(this.F,a),oe(this.F,d));oe(this.D,a);c.call(this,b)}};function PBi(a,b){return w(function(c){c=null!=c?kn(c):null;this.C.send(b,c)},a)}p.Ma=function(){B.prototype.Ma.call(this);delete this.O;delete this.D;delete this.F;delete this.J;delete this.C};function QBi(a,b,c,d){c=new aC({role:0,ph:c,cn:"ide.api.ch",tp:1});c.oz=b;OBi.call(this,c,d||5E3);this.H=a;a=w(this.L,this);this.C.xf("method.getContainerInfo",w(this.fNb,this,a),!0)}v(QBi,OBi);QBi.prototype.L=function(){return PQe(this.H.call())};QBi.prototype.Ma=function(){var a=this.C;OBi.prototype.Ma.call(this);a.dispose();delete this.H};function RBi(a,b,c,d,e){B.call(this);this.H=a;this.L=b;this.R=c;this.F=d||null;this.J=e||null;this.C=this.D=null}v(RBi,B);RBi.prototype.open=function(){if(this.F){if(this.F.closed){this.F=null;return}this.D=this.F;this.F=null;nf(this.D.location,this.H)}else this.D=rr(this.H,{target:this.L});if(this.J)try{this.C=new QBi(this.J,this.D,this.R),this.C.connect(),Dn(w(this.O,this,!0),1E5)}catch(a){this.C=null}};
RBi.prototype.O=function(a){try{!this.C||a&&this.C.isConnected()||(this.C.dispose(),this.C=null)}catch(b){this.C=null}};RBi.prototype.close=function(){this.O();this.D&&!this.D.closed&&(this.D.close(),this.D=null)};RBi.prototype.Ma=function(){B.prototype.Ma.call(this);this.C&&this.C.dispose();delete this.F;delete this.D;delete this.C;delete this.H;delete this.L};function SBi(a,b,c,d,e,f,h,k,l){Jl.call(this);this.R=[];this.Ha=!!k;this.F=a;this.O=b;this.qa(this.O);this.ma=new DBi;this.qa(this.ma);this.C=new ABi(Ju.getInstance());this.qa(this.C);this.D=null;this.Aa=new wBi(new vBi,l);this.ea=null;e&&(this.ea=new rBi(new mBi(f,h),l));this.H=new PAi(void 0,k);this.H.Xd(this);this.qa(this.H);this.F.Nh(this.H);this.xa=c;this.Ba=d;this.L=this.J=null}v(SBi,Jl);function Mzi(a){return a.ea?a.ea.hc:null}p=SBi.prototype;p.Ob=g("Ha");
function TBi(a,b){if(null==b)a.H.reset(0);else{var c=a.H;c.reset(2);for(var d=0;d<b.length;d++)for(var e=b[d],f=Ki(e,ozi,4),h=0;h<f.length;h++){var k=f[h];k=new OAi(e.getId(),e.getName(),k.getName());c.Ga(k,!0)}0===c.Qb()&&c.reset(1);a.H.isVisible()&&a.H.focus()}}function UBi(a,b){var c=Zl("docs-script-button-bar");c&&(pm(c),Wd(Bf(a))||(a=new Au(a),a.Sb("docs-titlebar-button"),a.render(c),Dl(a,"action",b)))}
function Nzi(a,b,c){a.L&&!a.L.isDisposed()&&(Pv(a.F,a.L),a.L.dispose());a.L=new NBi(b,c);a.L.dj=!0;a.F.Nh(a.L);a.L.setVisible(!0)}
p.Luc=function(a,b,c){var d=this.F,e=c||null;c="<p>";var f="Thanks! Your feedback was sent to the creators of <strong>"+(Br(a)+"</strong>.");c=c+f+"</p>";e&&(c+="<p>",b?(a="You might not receive an individual reply, but if you'd like to learn more, check out <a href=\""+(U(Ir(e))+'" target="_blank">'+(Br(a)+" help</a>.")),c+=a):(a="You won't receive an individual reply, but if you'd like to learn more, check out <a href=\""+(U(Ir(e))+'" target="_blank">'+(Br(a)+" help</a>.")),c+=a),c+="</p>");c=T(c);
xQe(d,"Report an issue",vr(c),void 0,void 0,"Close")};p.Kuc=function(){xQe(this.F,"Report an issue","We're sorry, but we encountered an error sending your issue report. Please try again later.",void 0,void 0,"Close")};function Lzi(a){a.dispatchEvent("Ol")&&(a=a.Ba,a.C.isVisible()&&a.C.hide(),a.D.ub()||a.D.render(a.F||void 0),a.D.show())}p.wN=function(){this.dispatchEvent("Kl")&&this.Ba.D.hide()};p.wpc=function(a,b,c,d,e){a=new RBi(a,"MacroService"+nha(c),b,e,d);this.R.push(a);a.open()};
p.Ma=function(){Jl.prototype.Ma.call(this);Zf(this.R)};function VBi(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E,L,Q,R,aa){u=void 0===u?!1:u;z=void 0===z?null:z;Q=void 0===Q?!1:Q;B.call(this);this.L=a;this.R=l;this.Ta=k;this.Aa=n;this.O=b;this.xa=c;this.J=d;this.F=L;this.H=new Pl(this);this.qa(this.H);this.Pa=q;this.Qa=z;this.ma=new AAi(this.xa,this.J);this.qa(this.ma);this.La=Q;a=this.Aa;c=this.La;u=void 0===u?!1:u;this.C=new SBi(e,h,q,t,WBi(a),c,a,u,E);this.qa(this.C);this.Oa=new lzi;h=0;b.D?b.C&&(h=2):h=1;this.D=new Czi(this.Aa,e,f,this.C,this.Oa,this.L,this.xa,
this.R,h,this.F,R,aa);this.qa(this.D);this.Ba={};this.ea=this.Ha=null}v(VBi,B);p=VBi.prototype;
p.start=function(){if(Wn(this.L.H,1,1)){this.H.listen(this.J,"amep",w(this.V4b,this));this.H.listen(this.J,"stbep",w(this.b5b,this));this.H.listen(this.J,"sttep",w(this.c5b,this));this.H.listen(this.J,"spep",w(this.a5b,this));this.H.listen(this.J,"saep",w(this.Z4b,this));this.H.listen(this.J,"snep",w(this.$4b,this));this.H.listen(this.J,"paep",w(this.X4b,this));this.H.listen(this.J,"rfep",w(this.Y4b,this));this.H.listen(this.C,"dialogselect",w(this.jIb,this));this.H.listen(yH.getInstance(),"Yc",w(this.W4b,
this));this.Ta(w(this.fIb,this));var a=this.L.C;O("macros-exec").wb(mp,this.aIb,this);O("macros-resume").wb(mp,this.ISb,this);O("macros-manage").wb(mp,w(a.Ts,a,w(this.HMb,this)));O("macros-editor").wb(mp,this.dya,this);O("macros-extensions").wb(mp,w(this.HVa,this));O("macros-manage-extensions").wb(mp,w(this.GMb,this));O("macros-extension-menu-promo").wb(mp,w(this.HVa,this));O("macros-extension-disabled").wb(mp,this.qGb,this);O("macros-extension-help").wb(mp,this.rIb,this);O("macros-extension-install-start").wb(mp,
this.uLb,this);O("macros-trigger-0").wb(mp,w(this.IF,this,"0"));O("macros-trigger-1").wb(mp,w(this.IF,this,"1"));O("macros-trigger-2").wb(mp,w(this.IF,this,"2"));O("macros-trigger-3").wb(mp,w(this.IF,this,"3"));O("macros-trigger-4").wb(mp,w(this.IF,this,"4"));O("macros-trigger-5").wb(mp,w(this.IF,this,"5"));O("macros-trigger-6").wb(mp,w(this.IF,this,"6"));O("macros-trigger-7").wb(mp,w(this.IF,this,"7"));O("macros-trigger-8").wb(mp,w(this.IF,this,"8"));O("macros-trigger-9").wb(mp,w(this.IF,this,"9"));
this.ma.start();XBi(this.Aa,this.La)&&(O("macros-addon-sidebar-focus").Na(!0),O("macros-addon-sidebar-focus").ob(void 0,azi(19)));SAi(new RAi(this.O,this.D));a=this.O.J;var b=!this.O.C,c=this.xa,d=this.R().getState()||void 0;d=["ruid",Ia({}),c.C.C,c.D,c.C.D,d];b||d.push("addon_safe_mode",!0);a&&d.push("addon_dry_run",a);So(Uo(y7(c,c.C.Ha),"POST").setContent(""),d).Or().Se()}};
function YBi(a){TBi(a.C,null);var b=w(function(c){c.qr()?TBi(this.C,Ki(c,qzi,2)):(this.C.C.C.postMessage(Qu("Could not load scripts.","warning",!0)),TBi(this.C,[]))},a);zzi(a.xa,b)}
function ZBi(a,b,c,d,e,f){if(d){Lzi(a.C);var h=w(function(){var t=Xzi(this.D,b);t&&!ri(t,4)&&(K(t,4,!0),Ozi(this.D))},a);var k=w(function(){this.C.wN();this.L.Gp.dispatchEvent(new mn(!0))},a);var l=w(function(t){this.C.wN();8!=t.zE()&&CBi(this.C.C,c,t.Lf())},a);Kzi(a.D)}else{var n=BBi(a.C.C),q=w(function(t){this.ma.F.cancel(t);Ku(this.C.C.C,n)},a);h=w(function(t){Ku(this.C.C.C,n);n=BBi(this.C.C,Ka(q,t))},a);k=w(function(t){Ku(this.C.C.C,n);if(t.u5()){t=this.C.C;var u=Xd("Canceled script ");t.C.postMessage(Qu(u,
"info",!1,2500))}else t=this.C.C,u=Xd("Finished script "),t.C.postMessage(Qu(u,"info",!1,2500));this.L.Gp.dispatchEvent(new mn(!0))},a);l=w(function(t){Ku(this.C.C.C,n);8!=t.zE()&&CBi(this.C.C,c,t.Lf())},a)}a.Pa.Cb(3);Tje(a.L.C,w(a.ksc,a,b,c,h,k,l,d,e,f))}p.ksc=function(a,b,c,d,e,f,h,k){var l=this.R().getState()||void 0,n=this.ma;c=void 0===c?Aa:c;d=void 0===d?Aa:d;e=void 0===e?Aa:e;e=w(n.e5b,n,a,b,c,d,e);n.F.RYa(a,b,l,e,f,h,k)};
p.W4b=function(a){var b=Dd(this.D.D),c={};b=ha(b);for(var d=b.next();!d.done;d=b.next())d=d.value,c["ADD-ON:"+w7(d)]={name:d.getName(),"cws-id":J(d,1),"gsm-application-id":J(d,18),"app-key":w7(d)};te(a.jG,c)};p.qGb=function(a){a.data==this.Ha&&(a=this.C,a.dispatchEvent("Jl")&&a.Aa.hc.fka())};
p.V4b=function(a){a=a.Wf().zb();var b={},c=$Bi(this,a);if(1==ti(a,11,0)){var d=J(a,4);d=Xzi(this.D,d)}else d=void 0;var e=d,f=e&&(ri(e,10)||ri(e,9))||!1,h=e&&ri(e,19)||!1;d=this.Oa;var k=c,l=J(a,4),n=1==ti(a,11,0);f=new jzi(a,k,n,f,h);f.setVisible(!0);0==ti(a,11,0)&&(l=f.getLabel());d.C[ti(a,11,0)][l]=f;d.dispatchEvent("Nl");(d=Mzi(this.C))&&J(a,9)&&(1==J(a,12)||5==J(a,12))&&(l=J(a,4),d.J[l]=a,l&&l in d.D&&lBi(d.D[l],a));c=c.reverse();if(d=this.C.O){for(l=0;l<c.length;l++)if(f=c[l],h=f.getKey())if(b[h])Bi(f,
5);else{if(this.Ba[h])for(k="Ctrl+Alt+Shift+"+h.toUpperCase(),k=iu(O("macros-exec"),[k]),n=0;n<d.ma.length;n++){var q=d.ma[n];Am(q)==k&&ym(q,"")}this.Ba[h]=f.Me();b[h]=!0}if(1==ti(a,11,0)){b=null!=e?e:null;c=[];e=J(a,4);f=!!J(a,9)&&3!=J(a,12);l=d.C.F.get(e);l||(l=new Mt(""),l.Dc(e),h=J(a,10),l.setContent(mm(h)),l.Na(2==d.R?!1:f&&1==d.R?!1:!0),d.F.Pc(),Rzi(d.C,l),Szi(d));f||d.ea.push(e);f=new Ht;!b||ri(b,10)||ri(b,9)||ri(b,19)||(Tzi(d,f,b),h=new Myi,k=String(Ia(h)),K(h,1,k),f.Ga(YAi(d,h,c),!0));h=
b&&(ri(b,10)||ri(b,9))||!1;if(!b||h||!ri(b,19))for(a=a.lh(),h=0;h<a.length;++h)f.Ga(YAi(d,a[h],c,void 0,b?b:void 0),!0);b&&Uzi(d,f,e,c,b);d.xa[e]=c;l.Ce(f);l.dispatchEvent("load");d.Ba.push(e)}else{b=a.Yg();if(d.gt(b)){d.gt(b);c=d.D[b];delete d.D[b];d.H.removeChild(c,!0);if(d.L)for(e=d.Aa[b],l=0;l<e.length;++l)d.L.bU(e[l]);delete d.Aa[b];c.dispose()}10<=fe(d.D)||(b=[],a.lh(),c=a.Yg(),a=YAi(d,a,b,"Ctrl+Alt+Shift+").zb(),a=new Zu(c,a,VAi.getInstance(),void 0,!0),e=d.H.Qb()?d.H.Qb()-1:0,d.H.zf(a,e,!0),
d.D[c]=a,d.Aa[c]=b)}}};p.b5b=function(a){a=a.Wf();var b=a.Yg();b?UBi(b,w(function(c){var d=Bf(c.getUrl());Wd(d)||rr(d);d=Bf(c.getFunctionName());Wd(d)||ZBi(this,J(c,1),d,J(c,4)||void 0,void 0,c.Xq()||void 0)},this,a)):EBi()};
p.c5b=function(a){var b=a.Wf();a=b.getText();b=b.Qk();var c=this.C.ma,d=Zl("docs-script-button-bar");d&&(FBi(c),Wd(Bf(a))||(a=yr(EAi,{caption:a}),om(d,a),Wd(Bf(b))||(c.C=new nt,c.C.Sb("docs-script-button-bar-bubble"),c.C.setContent(yr(FAi,{text:b})),c.C.Ti(a),ot(c.C,!0),c.C.yF=!1,c.C.setPosition(1,1),c.C.Dp(!1),c.C.render(d),c.D.listen(a,"mouseover",w(c.C.setVisible,c.C,!0)).listen(a,"mouseout",w(c.C.setVisible,c.C,!1)))))};
p.a5b=function(a){this.C.wN();var b=a.Wf(),c=xi(b,6,!1);a=c?J(b,3).replace(/\n/g," ").replace(/\\n/g,"\n"):J(b,3);var d=J(b,7),e=this.C,f=b.getTitle(),h=J(b,4),k=xi(b,5,!1);b=w(this.iRb,this,J(b,1),c,d);e.D&&(e.D.setVisible(!1),Pv(e.F,e.D));e.D=new LBi(f,a,h,k,b);e.D.dj=!0;e.F.Nh(e.D);e.D.setVisible(!0)};p.iRb=function(a,b,c,d,e){var f=new fAi;K(f,1,d);K(f,3,b);K(f,4,c);null!==e&&K(f,2,e);O("macros-resume").ob([a,kn(f.Eb())])};
p.Z4b=function(a){a=a.Wf();var b=vse(M(a,eS,9));var c={};c.mid=this.O.H;b=Ie(b,c);switch(ti(a,6,0)){case 1:var d=this.C;c=J(a,3);var e=this.R,f=a.getTitle()||void 0;if(d.dispatchEvent(new KBi(b,c,e,f))){var h=d.xa;d=d.Aa.hc;d.ub()||(d.render(),d.resize());d.fka();var k=d.oa();k.He(d.H,f||"Apps Script application");f=w(h.Cb,h,3);d.C=new tBi(b,c,[new sBi("google.script.host.close",w(d.fka,d),0),new sBi("google.script.host.editor.focus",f,0)],e,k);Xf(d.C,f);d.Ga(d.C,!0);O("macros-application-focus").ob()}this.Ha=
J(a,7)||null;break;default:c=this.C,e=J(a,3),f=this.R,h=a.getTitle()||void 0,d=a.getWidth()||void 0,k=a.getHeight()||void 0,a=xi(a,8,!1),c.D&&(c.D.setVisible(!1),Pv(c.F,c.D)),c.D=new uBi(b,e,f,c.xa,h,d,k,a),c.D.dj=!0,c.F.Nh(c.D),c.D.setVisible(!0)}};p.$4b=function(a){a=a.Wf();var b=a.getType();this.Qa(b,a.getText(),a.getTitle()||void 0,J(a,4)||void 0)};
p.X4b=function(a){if(Ns().C){if(!this.ea){a=Wl();var b=Hm(a,"docs-hub-open-external-appbarbutton");this.ea=new vqd(b,a,"A script attached to this file needs your permission to run. To give permission, open in a new tab and rerun the script.","Authorization required");this.qa(this.ea);mr(this.ea,b)}this.ea.setVisible(!0)}else a=a.Wf(),(b=M(a,bAi,3))&&(oi(b,2)||oi(b,11))?(b=new Tyi(J(b,2),J(b,11)),ri(a,4)?(b=this.D.getExtension(b),null!=b&&ri(b,10)?(b="The add-on "+(b.getName()+" needs your permission to run in this document."),
a=a.getUrl(),new yBi(a,(new Ow).format(""),void 0,void 0,b)):(a=a.getUrl(),new yBi(a,(new Ow).format("A script attached to this document needs your permission to run."),void 0,void 0,"Updated add-on"))):this.D.AV(b)):(a=a.getUrl(),new yBi(a,(new Ow).format("A script attached to this document needs your permission to run."),void 0,void 0,void 0))};p.Y4b=function(a){a=a.Wf();ZBi(this,J(a,1),a.getFunctionName(),J(a,4)||void 0,void 0,a.Xq()||void 0)};
p.aIb=function(a){a=a.data;var b=Xzi(this.D,a.C);!b||ri(b,9)?ZBi(this,a.C,a.functionName,a.F||void 0,1,a.D||void 0):this.D.AV(x7(b))};p.ISb=function(a){Lzi(this.C);var b=a.data;a=b[0];b=b[1];var c=w(function(){this.C.C.C.postMessage(Qu("Error resuming script execution","warning",!0))},this);BAi(this.ma,a,b,c)};p.HMb=function(){this.C.H.setVisible(!0);YBi(this)};
p.dya=function(a){var b=a.data;a=b?b.scriptId:void 0;a=new il(Zzi(this.O,a?a:void 0));b&&(a=b.editorUri?new il(b.editorUri):a,b.filename&&a.zc("f",b.filename),b.lineNumber&&(a.zc("l",b.lineNumber),a.zc("s",b.lineNumber)));b=this.L.D;var c=null;Bo(this.L.C)||(c=sde("Loading\u2026",{target:"MacroService"+nha(b)}));this.L.C.Ts(w(this.C.wpc,this.C,a.toString(),this.O.O,b,this.R,c))};p.HVa=function(){this.D.AV()};
p.GMb=function(a){if(a.data)this.D.AV(a.data);else{a=this.D;var b=Jzi(a,!0),c=a.R;var d=c.D;b=fzi(d,d.C,b,void 0,!0);d=gzi(d,b);c.C=d;d=c.C;c.F.Nh(d);d.setVisible(!0);Kzi(a)}};
p.rIb=function(a){var b=this.D,c=Xzi(b,a.data);if(c){var d=x7(c);a=w(b.Q6a,b,d,w7(c),c.getName(),J(c,6)||void 0,J(c,11)||void 0);d=w(b.AV,b,d);var e=ri(c,19)||void 0,f=b.C,h=c.getName(),k=Bf(J(c,7)),l=J(c,6)||void 0;c=J(c,11)||void 0;e=void 0===e?!1:e;f.J&&!f.J.isDisposed()&&(Pv(f.F,f.J),f.J.dispose());f.J=new IBi(h,k,a,d,l,c,e);f.J.dj=!0;f.F.Nh(f.J);f.J.setVisible(!0);Kzi(b)}};
p.uLb=function(a){if(a.data){var b=Xzi(this.D,a.data);if(null!=b)if(a=this.D,b=x7(b),a.H){a:{if(1==a.H)b="Add-ons aren't allowed in your domain. Talk to your domain administrator for more information.";else if(2==a.H)b="Add-ons aren't allowed while in safe mode.";else break a;xQe(a.xa,"Oops",b,void 0,void 0,"Close")}Ozi(a)}else{var c=a.getExtension(b);c&&ri(c,9)?(b=a.getExtension(b).getName(),b=Xd(b+" is already installed"),a.C.C.C.postMessage(Qu(b,"info",!1,2500)),Ozi(a)):a.AV(b)}}};
p.jIb=function(a){"edit"==a.key?(a=a.target.ot.rf(),a=Zzi(this.O,a?a.MZa:void 0),this.dya(new np({editorUri:a}))):"new"==a.key?this.dya(new np({editorUri:this.O.ea})):"reload"==a.key?YBi(this):"run"==a.key&&(a=a.target.ot.rf(),ZBi(this,a.MZa,a.getFunctionName(),void 0,void 0,a.Xq()))};p.IF=function(a){(a=this.Ba[a])&&(a=XAi(this.C.O,a))&&a.isEnabled()&&a.dispatchEvent("action")};p.fIb=function(){for(var a=this.C,b=0;b<a.R.length;b++){var c=a.R[b];c.close();c.dispose()}a.R=[]};
function $Bi(a,b){var c=[];J(b,3)&&c.push(b);b=b.lh();for(var d=0;d<b.length;d++)c=c.concat($Bi(a,b[d]));return c}p.getView=g("C");function WBi(a){return a==(Iu(),Eu)||a==(Iu(),Gu)||a==(Iu(),Fu)}function XBi(a,b){return b&&(a==(Iu(),Eu)||a==(Iu(),Fu))};function aCi(a,b,c,d,e,f,h){B.call(this);var k=this;this.D=a;this.L=b;this.eb=e;this.F=d;this.ma=new Nl;this.C=f;this.xa=h;this.R=new ju(this);this.qa(this.R);this.R.wb(ilb,ip,this.J);this.ea=new Pl(this);this.qa(this.ea);this.ma.Ab(this.F.F,function(){return k.J()});this.H=new o2a(this.eb.Kb(),!0);this.qa(this.H);this.O={};this.J()}v(aCi,B);aCi.prototype.J=function(){var a=bCi(this),b=this.L.zb(Sz.getId(),!0);b.xd(!0);gv(this.L,b,[new MIe(a)]);bs(b.getElement(),"waffle-action-menu")};
function bCi(a){var b=Array.from(a.F.C.values());Yxi(b,function(t){return mh(t,8)});var c=Array.from(a.F.D.values());rv(a.xa,ted(0<b.length,0<c.length));Rz.setProperty("visible",!0);Qz.setProperty("visible",!0);var d={};c={};b=ha(b);for(var e=b.next();!e.done;c={gpa:c.gpa},e=b.next()){e=e.value;var f=mh(e,1),h=e.getFunctionName(),k=mh(e,8),l=ih(e,9)?mh(e,9):null,n="recorded-action-"+f+":"+h,q=a.D.ef(n);q||(q=(new Rp(n)).enabled(!0),q.Fa(29583),q=q.build(),c.gpa=new Lyi(f,h,void 0,void 0,void 0,ih(e,
12)?e.Xq():void 0),q.wb(mp,function(t){return function(){O("macros-exec").ob(t.gpa)}}(c)),Q1a(a.H,[q]),a.D.yp(q),a.C&&a.C.Th(q));q.setProperty("label",k);cCi(a,l)&&q.setProperty("keys",[l]);null==l&&null!=q.getProperty("keys")&&q.setProperty("keys",null);d[n]=q}be(a.O,function(t,u){d[u]||(t.setProperty("keys",null),a.D.oP(u),a.C&&a.C.bU(u),Yf(t))});a.O=d;return ge(d)}function cCi(a,b){return!ilb.Ed()&&null!=b&&/^Ctrl\+Alt\+Shift\+\d$/i.test(b)&&0==(a.H.C[kc(b)]||[]).length};function dCi(a,b){this.uFa=a;this.Hna=b};function eCi(a,b){a='<div class="waffle-recording-toast" role="complementary" tabIndex="0" aria-describedby="waffle-recording-toast-content"><div class="waffle-recording-toast-top"><div class="waffle-recording-toast-icon"><div class="waffle-recording-toast-outer-circle"><div class="waffle-recording-toast-inner-circle"></div></div></div><div class="waffle-recording-toast-content"><div class="waffle-recording-toast-new-content"></div><div class="waffle-recording-toast-default-content">Recording new macro\u2026</div></div><div class="waffle-recording-toast-right"><div class="waffle-recording-toast-cancel">Cancel</div><div class="waffle-recording-toast-stop">Save</div><div class="waffle-recording-toast-expand-section"><div class="waffle-recording-toast-expand"><div class="waffle-recording-toast-expand-icon"></div></div></div></div></div><div class="waffle-recording-toast-bottom" role="radiogroup"><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-absolute">'+
FO({label:Fr('Use absolute references<div class="waffle-recording-toast-label-description">When applying macro use exact location as recorded</div>')},b);a=a+'</div></div><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-relative">'+FO({label:Fr('Use relative references<div class="waffle-recording-toast-label-description">When applying macro use active selection</div>')},b);return T(a+"</div></div></div></div>")};function fCi(a){S.call(this,a);this.J=new rt("",new Wv,this.oa());this.Ga(this.J);this.F=new rt("",new Wv,this.oa());this.Ga(this.F);this.D=new lu;this.qa(this.D);this.H=null;this.C=0}v(fCi,S);p=fCi.prototype;p.Ca=function(){this.kb(yr(eCi))};
p.Ia=function(){S.prototype.Ia.call(this);this.O=new mV(this.oa(),void 0,"relative");this.L=new mV(this.oa(),void 0,"absolute");this.O.Va(this.Da("waffle-recording-toast-relative"));this.L.Va(this.Da("waffle-recording-toast-absolute"));var a=qe(ou);pe(a,"selected",!0);var b=mq(new lq,6).build();nu(this.D,this.O,Uz,a,void 0,b);nu(this.D,this.L,Vz,a,void 0,b);nu(this.D,this.J,O("recorded-action-stop"),void 0,void 0,b);nu(this.D,this.F,Pz,void 0,void 0,b);this.H=new IJ(this.Da("waffle-recording-toast-expand"),
this.Da("waffle-recording-toast-bottom"),klb.isVisible(),void 0,this.oa());this.qa(this.H);this.getHandler().listen(this.H,"toggle",this.WRb);this.J.Va(this.Da("waffle-recording-toast-stop"));this.F.Va(this.Da("waffle-recording-toast-cancel"))};p.setVisible=function(a){var b=this.Ka();P(b,a);Vr(b,"hidden",!a);a&&(a=this.oa().Kb(),a=hm(a)||window,b=$q(this.Ka()),this.Ka().style.left=Math.max(Math.floor(gm(a).width/2-b.width/2),0)+"px")};
function gCi(a,b){a.Da("waffle-recording-toast-default-content").style.opacity=0;var c=a.Da("waffle-recording-toast-new-content");a.oa().He(c,b);0!=a.C?hCi(a):(En(a.C),a.C=Dn(function(){return hCi(a)},400))}function hCi(a){var b=a.Da("waffle-recording-toast-new-content");ds(b,"waffle-recording-toast-slide-in");En(a.C);a.C=Dn(function(){bs(b,"waffle-recording-toast-slide-in");En(a.C);a.C=Dn(function(){return iCi(a)},2200)})}
function iCi(a){var b=a.Da("waffle-recording-toast-default-content"),c=a.Da("waffle-recording-toast-new-content");ds(c,"waffle-recording-toast-slide-in");b.style.opacity=1;En(a.C);a.C=Dn(function(){a.C=0},400)}p.WRb=function(a){klb.setVisible(a.vE)};p.Ma=function(){En(this.C);S.prototype.Ma.call(this)};function jCi(a,b,c,d){B.call(this);var e=this;this.O=a;this.L=c;this.D=d;this.C=N().Jyb()(N().$t()(),N().ixb()(),z7(this),Uz.Ed(),function(f){f="Action "+(N().Iyb()(e.C)+(": "+f));kCi(e,f)},N().JSa()());N().$Sa()(this.C);this.H=new fCi;this.qa(this.H);this.Ba=new ju(this);this.qa(this.Ba);this.Ba.wb(Uz,mp,this.TXb,this).wb(Vz,mp,this.SXb,this).wb(O("docs-doc-copy-made"),mp,this.HGb,this).wb(O("macros-exec"),mp,this.gTb,this).wb(jfb,mp,function(f){return lCi(e,f.data,2)},this).wb(pfb,mp,function(f){return lCi(e,
f.data,3)},this).wb(ifb,mp,function(f){return lCi(e,f.data,1)},this).wb(kfb,mp,function(f){return lCi(e,f.data,5)},this).wb(egb,mp,function(f){return lCi(e,f.data,4)},this).wb(Cfb,mp,function(f){f=f.data;switch(f.F){case "all-objects-for-all-datasources":N().yyb()(e.C,z7(e));break;case "all-objects-for-single-datasource":N().zyb()(e.C,z7(e),f.D);break;case "specific-ids":var h=f.C[0];f=N().yE()(h);var k=null;switch(f){case 4:k=mCi(e,h,!1);break;case 1:case 3:case 5:(h=N().dQa()(h,ZT(e.L)))&&0<h.length&&
(k=ao(h[0]),k=io(ho(go(eo(),k.fb()),k.Pb()),k.Mb()).build(),h=ayi(),3==f?(byi(h),Eh(h,6,k)):1==f?(byi(h),Eh(h,5,k)):5==f&&(byi(h),Eh(h,4,k)),k=h.build().qb());break;case 2:(h=N().cQa()(h))&&0<h.length&&(k=$xi(h[0]).build().qb())}k&&N().cTa()(e.C,z7(e),f,k)}}).wb(ufb,mp,function(){return N().Ayb()(e.C,z7(e),!1)},this).wb(hfb,mp,this.eFb,this).wb(lfb,mp,function(f){return N().uyb()(e.C,z7(e),f.data.qb())},this);this.F=new Nl;this.qa(this.F);this.F.Ab(a.Ta,function(){N().Oyb()(e.C,!0,z7(e))});this.F.Ab(a.La,
function(f){if(f.D){var h=f.C.D();"docs-edit"==h?"ritz-waffle"==f.C.C&&N().Lyb()(e.C,z7(e)):"docs-undo"==h?(kCi(e,"Undo previous action"),N().Pyb()(e.C)):"docs-redo"==h&&(kCi(e,"Redo previous action"),N().Myb()(e.C))}});this.F.Ab(b.ma,function(f){f.C||N().Fyb()(e.C,z7(e),f.D)});this.F.Ab(this.D.tb,function(f){return nCi(e,f)});this.F.Ab(this.D.Oc,function(){e.ma=z7(e)});this.F.Ab(this.D.Kc,function(f){switch(f.D){case "find-next-occurrence":N().vyb()(e.C,e.ma,z7(e),f.C.qb());break;case "replace-current-occurrence":N().Byb()(e.C,
z7(e),f.C.qb())}e.ma=null});this.F.Ab(this.D.$a.D,function(f){N().Eyb()(e.C,z7(e),f.F,f.H,f.J,f.L,f.id,f.C,f.D)});this.F.Ab(b.Gp,function(){N().syb()(e.C,e.Aa,z7(e),e.xa);e.Aa=null;e.xa=null});this.F.Ab(this.D.Qc,function(f){N().tyb()(e.C,e.J.D.C.qb(),f.getSelection().C.qb(),e.J.C.qb());e.J=null});this.ea=new Pl(this);this.qa(this.ea);this.J=this.ma=this.xa=this.Aa=this.R=null;this.ea.listen(this.D.C,"pa",this.Gfc).listen(this.D.C,"va",this.Ffc);this.H.render();this.H.setVisible(!0);oCi(this);setTimeout(function(){return NG("All actions are now being recorded. Please use the Tools menu to cancel or save recording.")})}
v(jCi,B);p=jCi.prototype;p.Ffc=function(){this.R=z7(this)};p.Gfc=function(a){!a.iG&&oJ(this.D)&&(void 0!==a.UW?(a=a.UW,N().Gyb()(this.C,this.R,z7(this),a)):(a=this.D.C.C.$d(),gCi(this.H,"Activating sheet "+a),N().Hyb()(this.C,this.R,z7(this),a)),this.R=null)};function kCi(a,b){gCi(a.H,b);NG("Macro recorder "+b)}function pCi(a){return N().Kyb()(a.C,z7(a))}p.gTb=function(a){this.xa=a.data.functionName;this.Aa=z7(this)};
function nCi(a,b){var c=z7(a);a.ea.Rc(a.D,"gc",function(){var d=z7(a);switch(b.H){case "adjust-next-data-region-edge":N().ryb()(a.C,c,d,b.D,b.C);break;case "move-next-data-region-edge":N().xyb()(a.C,c,d,b.D,b.C);break;case "select-all":N().Cyb()(a.C,c,d);break;case "select-rows-columns":N().Dyb()(a.C,c,d,"c"==b.F)}})}p.HGb=function(a){a=a.data;N().wyb()(this.C,z7(this),a.C)};p.eFb=function(a){a=a.data;var b=this.O.C.getSelection();this.J=new qCi(a,b)};
function lCi(a,b,c){var d=N().cTa(),e=a.C,f=z7(a);a:switch(c){case 4:b=mCi(a,b,!0);break a;case 3:case 1:case 5:var h=VG(a.L);h?(a=mo(a.O.C.getSelection()),rCi(b,a,h)?b=null:(a=RBc(h),rCi(b,a,h)?(b=iG(h.Sa().qg(a.y,a.x)),b=null!=b?b:io(ho(go(eo(),h.O.C.C.fb()),a.y),a.x).build(),h=ayi(),3==c?(byi(h),Eh(h,6,b)):1==c?(byi(h),Eh(h,5,b)):5==c&&(byi(h),Eh(h,4,b)),b=h.build().qb()):b=null)):b=null;break a;case 2:if(h=VG(a.L)){a=a.O.C.getSelection();var k=KWe(h);b=k&&nh(a.C,6).Eb().includes(k)?null:(a=IWe(h))&&
b==JWe(h)?$xi(a).build().qb():null}else b=null;break a;default:b=null}d(e,f,c,b)}function rCi(a,b,c){if(!b)return!1;b=c.Sa().qg(b.y,b.x);c=QBc(c,b);return a==c}function mCi(a,b,c){if(c&&(a=a.D.C.C)&&AC(a))return null;b=N().lM()(b);if(!b)return null;(b=N().hS()(b))?(a=ayi(),byi(a),b=yh(a,2,b).build().qb()):b=null;return b}p.TXb=function(){var a=!N().dTa()(this.C);sCi(this,!0);a&&(gCi(this.H,"Using relative references"),NG("Recording with relative references"))};
p.SXb=function(){var a=N().dTa()(this.C);sCi(this,!1);a&&(gCi(this.H,"Using absolute references"),NG("Recording with absolute references"))};function sCi(a,b){N().Nyb()(a.C,b);Uz.qc(b);Vz.qc(!b)}function oCi(a){(a=VG(a.L))&&RL(a)}function z7(a){return a.O.C.getSelection().C.qb()}p.Ma=function(){N().nSa()();B.prototype.Ma.call(this)};function qCi(a,b){this.C=a;this.D=b};function tCi(a,b,c,d){Yv.call(this,"Macro saved",Wl(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-saved"]);this.Qa=a;this.Aa=b;this.O=c;this.Ha=d}v(tCi,Yv);tCi.prototype.Ca=function(){Yv.prototype.Ca.call(this);var a=nr(this,"script-recorder-edit-link-id");this.It("EDIT SCRIPT",a)};tCi.prototype.Ia=function(){Yv.prototype.Ia.call(this);this.getHandler().sf(pr(this,"script-recorder-edit-link-id"),Fl,w(this.L,this,this.Qa,this.Aa,this.O))};
tCi.prototype.L=function(a,b,c){this.Ha.C(29645);O("macros-editor").ob(b?{scriptId:a,filename:b,lineNumber:c}:void 0)};function uCi(a,b,c,d,e,f,h,k,l,n){ov.call(this);var q=this;this.xa=a;this.ea=b;this.Pa=c;this.Ha=d;this.R=e;this.H=f;this.Ba=h;this.ma=k;this.L=n;this.Aa=new ju(this);this.qa(this.Aa);this.F=null;this.J=!1;this.C=null;this.La=l;this.Aa.subscribe(Tz,"action",this.Ltc).subscribe(O("recorded-action-stop"),"action",this.Avc).subscribe(llb,"action",this.nsc).subscribe(Pz,"action",this.ehb).subscribe(Qz,"action",this.luc).subscribe(Rz,"action",this.ruc);qv(this,vCi(this));zq(this.H,this);a=["not-revisions",
"sheet-access-edit",tv()];var t=new yq(a.concat(["docs-script-recording"]));jd([Pz,O("recorded-action-stop"),llb,jlb,Vz,Uz],function(u){q.H.C(u,t);q.H.D(u,t)});a=new yq(a.concat(["not-docs-script-recording"]));this.H.C(Tz,a);Pw()||this.H.D(Tz,a)}v(uCi,ov);p=uCi.prototype;p.Ltc=function(){var a=this;this.F=new jCi(this.Pa,this.Ha,this.R,this.Ba);rv(this,vCi(this));this.Ba.D.C.Ts(function(){To(tk(Uo(a.xa.Qe("/startrecordingscript"),"POST"),1).setTimeout(18E4)).Se()})};
p.Avc=function(){WG(this.R)&&VK(VG(this.R),!0);this.F.H.setVisible(!1);N().nSa()();Uxi(this.ea)};
p.nsc=function(a){var b=this,c=a.uFa;a=a.Hna;var d=pCi(this.F).sourceCode();wCi(this,aw(this.L,"Saving new macro",Wl(),!0,0,!1,void 0,!0,["waffle-recording-toast-saving"]),!0);this.J=!0;rv(this,vCi(this));To(vk(wk(tk(Uo(sk(sk(Ko(this.xa.Qe("/saverecordedscript"),["script",d]),"name",c),"shortcut",""!=a?"Ctrl+Alt+Shift+"+a:""),"POST"),1),function(e){var f=e.OS("scriptId"),h=e.OS("filename");e=Number(TG(e,"lineNumber"));f=new tCi(f,h,e,b.La);bw(b.L,f);wCi(b,f);b.J=!1;xCi(b)}),function(){wCi(b,aw(b.L,
"Failed to save macro",Wl(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-save-failed"]));b.J=!1;if(b.F){var e=b.F;N().$Sa()(e.C);e.H.setVisible(!0)}rv(b,vCi(b))}).setTimeout(18E4)).Se()};function xCi(a){Yf(a.F);a.F=null;rv(a,vCi(a))}p.ehb=function(){xCi(this);setTimeout(function(){return NG("Script recording canceled")})};function vCi(a){var b={},c=!!a.F;a=a.J;b["docs-script-recording"]=c&&!a;b["not-docs-script-recording"]=!c&&!a;return b}p.luc=function(){Vxi(this.ea,this.ma)};
p.ruc=function(){Wxi(this.ea,this.ma)};function wCi(a,b,c){a.C&&(cw(a.L,a.C),a.C.setVisible(!1),Yf(a.C));a.C=b;a.C.render();c&&(new Esf(!0,Wl())).render(dm("docs-ui-toast-content",b.getElement()));a.C.setVisible(!0)}p.Ma=function(){Yf(this.F);this.F=null;this.C&&(Yf(this.C),this.C=null);ov.prototype.Ma.call(this)};function yCi(a,b,c,d){1==a&&wQb(vf(c||""),vf(b),void 0!==d?d:-1,!0)};function zCi(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E,L,Q,R,aa){B.call(this);this.R=a;this.ma=b;this.Aa=c;this.Ba=d;this.O=e;this.Qa=f;this.Pa=h;this.C=k;this.F=l;this.Oa=n;this.L=q;this.ea=t;this.Ta=u;this.J=new Pl(this);this.qa(this.J);this.xa=new kyi(this.Aa,this.F);this.Ya=new uCi(this.Aa,this.O,this.ma,this.R,this.C.D,E,this.F,this.xa,L,Q);this.qa(this.Ya);this.Wa=new aCi(E.ai(),this.C.Aa.C,l,this.xa,z,this.C.Aa.La,R);this.qa(this.Wa);this.D=null;this.H=aa}v(zCi,B);
zCi.prototype.init=function(){var a=this.C.Aa.La;a.Th(Tz);a.Th(Pz);a.Th(O("recorded-action-stop"));a.Th(Uz);a.Th(Vz);a.Th(Qz);a.Th(Rz);a=this.F.yb.D;var b=this.F.yb.C;b&&(b+=a?"_"+a:"");a=A();var c=y(a,"docs-tintd")&&y(a,"docs-thtea");this.D=new sze(this.Ba,this.ma.C,this.C.D);this.qa(this.D);var d=this.R,e=SLa(this.L),f=TLa(this.L),h=this.O,k=this.Qa,l=this.Pa,n=w(this.ea.O,this.ea),q=w(this.D.C,this.D),t=(Iu(),Fu),u=this.Oa,z=this.Ta,E=this.Ba,L=Vw(Qw.getInstance()),Q=this.C.Aa.C;L=void 0===L?!1:
L;c=void 0===c?!1:c;var R=A();R=new Yzi(ed(R,"maestro_container_token"),ed(R,"maestro_domain"),ed(R,"maestro_script_editor_uri"),ed(R,"maestro_new_project_uri"),y(R,"docs-emae"),ed(R,"mae-pai"),y(R,"mae-cwssw"),y(R,"mae-aoeba"),y(R,"mae-esme"),ed(R,"mae-dret"),ed(R,"mae-ses"),y(R,"docs-tdd"),y(R,"mae-seitd"));e=new xzi(d.D,String(E),e,void 0);E=new zAi;E.bind(f);f=R.C?2:R.D?0:1;var aa=new lu(void 0,void 0,!0,iw.getInstance());l=l?new WAi(l,aa,f,Q,void 0):null;d=new VBi(d,R,e,E,h,k,l,n,q,t,u,z,L,yCi,
iRc,b,c);d.qa(e);d.qa(E);d.start();O("macros-addon-sidebar").Na(WBi(t));O("macros-addon-sidebar-focus").Na(XBi(t,c||!1));O("macros-application-focus").Na(!0);O("macros-application-sidebar").Na(!0);O("macros-editor").Na(!R.xa||R.F);O("macros-exec").Na(!0);O("macros-extension-disabled").Na(!0);O("macros-extension-help").Na(!0);O("macros-extension-install-start").Na(!0);O("macros-extension-menu-promo").Na(!0);O("macros-manage").Na(!0);O("macros-resume").Na(!0);O("macros-trigger-0").Na(!0);O("macros-trigger-1").Na(!0);
O("macros-trigger-2").Na(!0);O("macros-trigger-3").Na(!0);O("macros-trigger-4").Na(!0);O("macros-trigger-5").Na(!0);O("macros-trigger-6").Na(!0);O("macros-trigger-7").Na(!0);O("macros-trigger-8").Na(!0);O("macros-trigger-9").Na(!0);null!=this.H&&(a=y(a,"docs-isctp"),this.H.ea=a,this.J.listen(d.J,"scpep",w(this.La,this)));this.J.listen(LG,"runMacro",w(this.Ha,this))};zCi.prototype.La=function(a){null!=this.H&&(a=ri(a.Wf(),1),this.H.ea=a)};
zCi.prototype.Ha=function(a){var b=a.payload;a=nd(N().HS()(),fpa);a=sd(a,function(c){return c.getFunctionName()==b});null!=a&&ih(a,1)?O("macros-exec").ob(new Lyi(mh(a,1),b,void 0,void 0,void 0,ih(a,12)?a.Xq():void 0)):MG("Script function "+(b+" could not be found"))};function ACi(a){var b=a.tGa;a='<div class="waffle-record-script-dialog-name-section"><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-name-input" id="waffle-record-script-name-input-label">Name</label></div><div class="waffle-record-script-name"><input class="waffle-record-script-name-input jfk-textinput" id="waffle-record-script-name-input" maxlength="50" aria-labelledby="waffle-record-script-dialog-description-id waffle-record-script-name-input-label"/></div></div><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-shortcut-input">Shortcut (optional)</label></div><div class="waffle-record-script-shortcut"><label for="waffle-record-script-shortcut-input" id="waffle-record-script-shortcut-input-label">'+
(Br(b)+'</label><input class="waffle-record-script-shortcut-input jfk-textinput" id="waffle-record-script-shortcut-input" maxlength="1" aria-labelledby="waffle-record-script-shorcut-description-id"/><div id="waffle-record-script-shorcut-description-id" style="display:none;">');b="Optional numeric shortcut key, use with "+(Br(b)+" to run macro.");return T(a+b+"</div></div>")};function BCi(a,b){Ov.call(this,void 0,void 0,b);this.Uq=!1;Bs(this,!1);this.F=new uv;this.Ga(this.F);this.H=new SV(this.oa());this.Ga(this.H);this.L=new uv("Number");this.Ga(this.L);this.C=new SV(this.oa());this.Ga(this.C);Cs(this,(new ws).Cf({key:"discard",caption:"Discard"},!1).Cf(eXa,!0))}v(BCi,Ov);p=BCi.prototype;
p.Ca=function(){Ov.prototype.Ca.call(this);y(A(),"docs-egmd")?(bs(us(this),"waffle-record-script-dialog-gm"),Ms(this,"save")):bs(us(this),"waffle-record-script-dialog");this.setTitle("Save new macro");this.xb().appendChild(yr(ACi,{tGa:Mp?"\u2318 + Option + Shift +":"Ctrl + Alt + Shift +"}))};
p.Ia=function(){Ov.prototype.Ia.call(this);this.F.Va(this.Da("waffle-record-script-name-input"));y(A(),"docs-egmd")||bs(this.Da("waffle-record-script-name"),Lnf.getInstance().Rb());this.F.setValue("Untitled Macro");var a=this.F.Ka();this.H.setPosition(3,2);this.H.render();this.H.Ti(a);VV(this.H,a);UV(this.H);this.L.Va(this.Da("waffle-record-script-shortcut-input"));y(A(),"docs-egmd")||bs(this.Da("waffle-record-script-shortcut"),Lnf.getInstance().Rb());var b=this.L.Ka();this.C.setPosition(3,2);this.C.render();
this.C.Ti(b);VV(this.C,b);UV(this.C);this.getHandler().listen(this,"dialogselect",this.Hfc).listen(a,["focus","blur","change"],this.sOb).listen(b,["focus","blur","change"],this.GUb)};p.focus=function(){Ov.prototype.focus.call(this);xv(this.F)};p.sOb=function(){""!=this.F.getValue()&&UV(this.H)};p.GUb=function(){CCi(this)&&UV(this.C)};
p.Hfc=function(a){var b=this,c=mq(new lq,12).build();if("discard"==a.key)Pz.ob(void 0,c);else if("save"==a.key)if(""!=this.F.getValue()||TV(this.H,"Must not be empty.",!0),CCi(this)||setTimeout(function(){TV(b.C,"Must be a number from 0 to 9 or blank.",!0)}),DCi(this)&&setTimeout(function(){TV(b.C,"Conflicts with another shortcut.",!0)}),""!=this.F.getValue()&&CCi(this)&&!DCi(this)){a=this.F.getValue();var d=this.L.getValue();llb.ob(new dCi(a,d),c)}else a.preventDefault()};
function CCi(a){a=a.L.getValue();return""==a||/^\d$/.test(a)}function DCi(a){var b="Ctrl+Alt+Shift+"+a.L.getValue();return N().HS()().map(fpa).some(function(c){return ih(c,9)&&mh(c,9)==b})};function ECi(){Qn.apply(this,arguments)}v(ECi,Qn);ECi.prototype.F=function(){return zCi};ECi.prototype.H=function(){return BCi};ECi.prototype.C=function(a,b,c){return new pyi(a,b,c,void 0)};ECi.prototype.D=function(a,b,c){return new Fyi(a,b,c,void 0)};vo("ritzmaestro",ECi);
