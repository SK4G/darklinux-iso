function ajp(a){pj.call(this,a)}z(ajp,pj);ajp.prototype.getStatus=function(){return this.message.getStatus()};function bjp(a){this.Kb=aj(a,-1,0)}z(bjp,bj);bjp.prototype.Ab=function(){return new ajp(this)};bjp.prototype.getStatus=function(){return mj(this,1,0)};function cjp(a){pj.call(this,a)}z(cjp,pj);function djp(a){this.Kb=aj(a,-1,0)}z(djp,bj);djp.prototype.Ab=function(){return new cjp(this)};function ejp(a){pj.call(this,a)}z(ejp,pj);ejp.prototype.getStatus=function(){return this.message.getStatus()};
function fjp(a){this.Kb=aj(a,-1,0)}z(fjp,bj);fjp.prototype.Ab=function(){return new ejp(this)};fjp.prototype.getStatus=function(){return mj(this,1,0)};function gjp(a,b){return new xn(function(c,d){mx(a,"/dbx/createSchedule",[],b.Ob(),function(e){c(cj(bjp,JSON.stringify(e.jh())))},d)})}function hjp(a,b){return new xn(function(c,d){mx(a,"/dbx/updateSchedule",[],b.Ob(),function(e){c(cj(fjp,JSON.stringify(e.jh())))},d)})}
function ijp(a){if(!Vk().oKa()(a)||Vk().xec()(a))return!1;a=Vk().OW()(a);return W0c.has(a)}function jjp(a){var b=[];a=da(a.C.keys());for(var c=a.next();!c.done;c=a.next())c=c.value,ijp(c)&&b.push(c);return b}function kjp(a){if(a.V.Cj())return[];var b=[];a.C.forEach(function(c,d){J0c.has(c.D)&&ijp(d)&&b.push(d)});return b}function ljp(a,b,c){this.C=a;this.F=b;this.D=void 0===c?null:c}function mjp(a){a.Ic()&&fNk(a.F)}function njp(){var a=void 0===a?dj(rvk):a;return new qvk(a)}
function ojp(){var a=void 0===a?dj(tvk):a;return new svk(a)}function pjp(a){pj.call(this,a)}z(pjp,pj);function qjp(a,b){return xj(a,1,b)}function rjp(a){this.Kb=aj(a,-1,0)}z(rjp,bj);rjp.prototype.Ab=function(){return new pjp(this)};function sjp(){var a=void 0===a?dj(rjp):a;return new pjp(a)}function tjp(a){pj.call(this,a)}z(tjp,pj);function ujp(a,b){return sj(a,1,b)}function vjp(a,b){return xj(a,2,b)}function wjp(a){this.Kb=aj(a,-1,0)}z(wjp,bj);wjp.prototype.Ab=function(){return new tjp(this)};
function xjp(){var a=void 0===a?dj(wjp):a;return new tjp(a)}function yjp(a,b,c,d){rq.call(this,d);this.hb=c;this.$a=a;this.state=3;this.C=null;this.Ua=this.oa=!1;this.ob=new ws(this);this.Ea(this.ob);this.Ya=new OKk(500,500,"dbxScheduleOnCompleteAuth");this.Ea(this.Ya);zjp(this)}z(yjp,rq);function zjp(a){a.ob.Lc(D5b,Xo,function(b){b=b.data;Ajp(a,36713,b);Bjp(a,b,null)}).Lc(E5b,Xo,function(b){b=b.data;Ajp(a,36714,b);Cjp(a,b,null)}).Lc(F5b,Xo,a.wb).Lc(G5b,Xo,a.tb).Lc(hu,Wo,a.refresh)}
function Bjp(a,b,c,d){d=void 0===d?!0:d;var e=qjp(sjp(),b);c&&sj(e,2,c);gjp(lx.sb(),e.build()).then(function(f){return Djp(a,b,f.getStatus(),ij(f,2),!0,d)},function(){a.yWa()})}function Cjp(a,b,c,d){d=void 0===d?!0:d;var e=vjp(ujp(xjp(),a.C.getId()),b);c&&sj(e,3,c);hjp(lx.sb(),e.build()).then(function(f){return Djp(a,b,f.getStatus(),ij(f,2),!1,d)},function(){a.yWa()})}yjp.prototype.wb=function(){if(hu.isEnabled()){var a=Evk(this.C);Ajp(this,36715,a);a=a.Ab().Xa(!0).build();Cjp(this,a,null)}};
yjp.prototype.tb=function(){if(hu.isEnabled()){var a=Evk(this.C);Ajp(this,36716,a);a=a.Ab().Xa(!1).build();Cjp(this,a,null)}};function Ajp(a,b,c){var d=new bNa;c=Ejp(c.Io());d=R(d,10,c);d=Ark(d);d=Ap(yp(new xp,75),d).build();a.hb.C(b,d)}function Ejp(a){switch(a.Io()){case 4:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 0:return 0}}
function Fjp(a){a.state=3;a.refresh();Vvk().then(function(b){a.isDisposed()||(b=nj(b,1,Dvk).Pc(),0==b.length?(a.state=1,a.C=null):(a.state=4,a.C=b[0]),a.Ua?(a.Ua=!1,a.show()):a.refresh())},function(){Js.sb().postMessage(Ls("Error loading schedule configuration.","error",!0))})}function Gjp(a){return a.C&&gj(Evk(a.C),1)?(kj(a.C.getStatus(),1),!0):!1}
function Djp(a,b,c,d,e,f){a.Xmb(!0);switch(c){case 1:a.focus();Fjp(a);Pw.dispatchEvent("load-schedules-on-config-bar");break;case 2:if(!f)break;PKk(a.Ya,d,function(h){a.isDisposed()||(a.Xmb(!1),e?Bjp(a,b,h,!1):Cjp(a,b,h,!1))});break;default:a.yWa()}}yjp.prototype.show=function(){3==this.state?this.Ua=!0:(this.hb.C(116122),this.state=1==this.state?2:5,this.refresh())};function Hjp(a,b){J0k.call(this,a,b)}z(Hjp,J0k);Hjp.prototype.ma=function(){this.refresh()};Hjp.prototype.refresh=function(){if(this.Ic()){var a=hu.isEnabled();a=this.H&&this.J&&a&&0<kjp(this.O).length;this.C.Xa(a)}};Hjp.prototype.R=q("Refresh all");function Ijp(a,b){a=a||{};var c={};var d=c.color;c=c.EX;c=Jq(c,null)?18:c;d='<svg xmlns="http://www.w3.org/2000/svg" width="'+V(c)+'px" height="'+V(c)+'px" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-2 -2)"><polygon points="0 0 24 0 24 24 0 24"/><path fill="'+V(Jq(d,null)?"#188038":d)+'" fill-rule="nonzero" d="M22,4 L22,10 L16,10 L16,8 L18.91,8 C17.53,5.61 14.96,4 12,4 C7.58,4 4,7.58 4,12 C4,16.42 7.58,20 12,20 C16.42,20 20,16.42 20,12 L22,12 C22,17.52 17.52,22 11.99,22 C6.47,22 2,17.52 2,12 C2,6.48 6.47,2 11.99,2 C15.27,2 18.17,3.58 20,6.01 L20,4 L22,4 Z M13,12 L13,6 L11,6 L11,13 L15.97,16.49 L17.23,14.94 L13,12 Z"/></g></svg>';
d=Fq(d);a=""+kKk(Iq({title:"Refresh options",aH:"waffle-dataconnector-refresh-sidebar",UR:Lq(""+d),Cs:Lq('<div class="'+V("waffle-dataconnector-refresh-sidebar-container")+'"><div class="'+V("waffle-dataconnector-refresh-sidebar-refresh-widget")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-sidebar-backdrop")+'"></div>'),lja:!0,Jba:Lq('<div class="'+V("waffle-dataconnector-refresh-sidebar-footer-wrapper")+'"></div>')},a),b);return Fq(a)};function Jjp(){}z(Jjp,hs);Jjp.prototype.Bd=q("docs-calendar-select");Jjp.prototype.Sx=function(a){a=a.Ha("DIV",["docs-calendar-select-dropdown","docs-gm-arrow","goog-inline-block"],a.Ha("DIV",["docs-icon","goog-inline-block"],a.Ha("DIV",["docs-icon-img-container","docs-icon-img","docs-icon-arrow-dropdown"])));$q(a,"docs-material");return a};qa(Jjp);function Kjp(){return Fq('<div class="'+V("waffle-dataconnector-refresh-date-input-date-select")+'"></div><div class="'+V("waffle-dataconnector-refresh-date-input-date-picker")+'"></div>')};function Ljp(a,b,c){a=void 0===a?0:a;b=void 0===b?pte.sb():b;rq.call(this,c);this.F=new KLk(a,b,c);this.Na(this.F);this.D=null;this.C=new Date;this.C.setMinutes(0);this.C.setSeconds(0);this.C.setMilliseconds(0);this.F.setValue(Mjp(this.C))}z(Ljp,rq);u=Ljp.prototype;u.Ha=function(){rq.prototype.Ha.call(this);this.Qb(Dq(Kjp))};u.Oa=function(){rq.prototype.Oa.call(this);this.F.render(this.Ia("waffle-dataconnector-refresh-date-input-date-select"));this.getHandler().listen(this.F,"action",this.p$c)};
u.getDate=n("C");function Mjp(a){return(new Zt($t.MONTH_DAY_YEAR_MEDIUM)).format(a)}u.p$c=function(){var a=this;null==this.D?Njp(this,function(){return Ojp(a)}):Ojp(this)};function Ojp(a){a.D.position(a.Sa());null!=a.F.getValue()&&a.D.Uid(a.getDate())}function Njp(a,b){ro("datepicker",function(){var c=wo("datepicker");a.D=c.C(a.Da());a.Na(a.D);a.D.render(a.Ia("waffle-dataconnector-refresh-date-input-date-picker"));a.D.Z2c();a.getHandler().listen(a.D,"change",a.Euc);b()})}
u.Euc=function(a){this.setDate(new Date(a.C.getTime()));this.D.hide()};u.setDate=function(a){this.C=new Date(a);this.C.setMinutes(0);this.C.setSeconds(0);this.C.setMilliseconds(0);this.F.setValue(Mjp(a))};var Pjp=new at("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function Qjp(a,b){a=void 0===a?zv.sb():a;for(var c=new fs,d=1;28>=d;d++)c.Na(new bs(Pjp.format({DAY:d}),d),!0);Xzk.call(this,c,a,b)}z(Qjp,Xzk);function Rjp(){return Fq('<div class="'+V("waffle-dataconnector-refresh-day-of-month-widget")+'"><div><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-day-of-month-widget-label")+'"></div><div class="'+V("waffle-dataconnector-refresh-day-of-month-widget-add-day-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-day-of-month-widget-chip-container")+'"></div></div>')};var Sjp=new at("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function Tjp(a){rq.call(this,a);this.Wq=new rq;this.Na(this.Wq);this.C=new Qjp(Zr.sb(),a);ts(this.C,"Add day");this.Na(this.C);this.D=new Ujp}z(Tjp,rq);u=Tjp.prototype;u.Ha=function(){rq.prototype.Ha.call(this);this.Qb(Dq(Rjp));this.Wq.yb(this.Ia("waffle-dataconnector-refresh-day-of-month-widget-chip-container"));this.C.render(this.Ia("waffle-dataconnector-refresh-day-of-month-widget-add-day-select"))};
u.Oa=function(){rq.prototype.Oa.call(this);fn(this.Ia("waffle-dataconnector-refresh-day-of-month-widget-label"),"Repeat on");this.getHandler().listen(this.C,"change",this.Jbd).listen(this,"He",this.Kdd)};u.Jbd=function(){var a=this.C.getValue();NLb(this.C.Mr,null);Vjp(this,a);this.dispatchEvent("change")};u.Kdd=function(a){a=a.target;var b=vq(this.Wq,a);this.D.remove(b)&&(this.Wq.removeChild(a,this.Ic()),this.dispatchEvent("change"))};
function Vjp(a,b){if(!a.D.has(b)){var c=new MKk(Sjp.format({DAY:b}),a.Da());b=a.D.add(b);a.Wq.zj(c,b,a.Ic())}}u.Fg=function(){return this.D.C};function Wjp(a,b){for(var c=0;c<b.length;c++)Vjp(a,b[c])}function Ujp(){this.C=[]}Ujp.prototype.add=function(a){var b=dg(this.C,a);Pf(this.C,a,-b-1);return-b-1};Ujp.prototype.has=function(a){return-1<yf(this.C,a)};Ujp.prototype.remove=function(a){return Uf(this.C,a)};function Xjp(){}z(Xjp,nte);Xjp.prototype.Ha=function(a){return a.Da().Ha("INPUT",{type:"number",max:"100",min:"1"})};qa(Xjp);function Yjp(){var a='<div class="'+V("waffle-dataconnector-refresh-schedules-new-widget")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-header")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-top-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-header-title")+'"><span tabindex="0" class="'+V("waffle-dataconnector-refresh-schedules-new-title")+'" role="heading">';a=a+'Scheduled refresh</span></div><div class="'+(V("waffle-dataconnector-refresh-schedules-new-enable-switch")+
'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-spinner")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-setup-btn")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-overview-section")+'"><span class="'+V("waffle-dataconnector-refresh-schedules-new-overview-text")+'"></span><span class="'+V("waffle-dataconnector-refresh-schedules-new-edit-btn")+'"></span></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-fullview-section")+
'"><div class="waffle-dataconnector-refresh-schedules-new-fullview-text"></div><div><span class="'+V("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(V("waffle-dataconnector-refresh-schedules-new-edit-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-schedules-new-repeat-every-label")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+
'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-interval-input")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-frequency-select")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+V("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-day-of-month-widget")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+
'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-weekday-select")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-schedules-new-repeat-at-label")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+V("waffle-dataconnector-refresh-schedules-new-time-select-label")+
'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-time-select")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-schedules-new-start-date-label")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-start-date-select")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-start-time-select")+
'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-owner-info")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-btns")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-cancel-btn")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-save-btn")+'"></div></div></div></div>');return Fq(a)};function Zjp(){for(var a='<div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-weekday-select-label")+'"></div><div style="display: flex">',b=0;7>b;b++)a+='<div data-index="'+V(b)+'" class="'+V("waffle-dataconnector-refresh-weekday-select")+'"></div>';return Fq(a+"</div>")};function $jp(a){a=a.name;return Fq('<div class="'+V("waffle-dataconnector-refresh-weekday-toggle")+'">'+Eq(a)+"</div>")};function akp(a,b,c){$r.call(this,void 0,bkp.sb(),c);this.D=a;this.C=b;this.ck(16,!0)}z(akp,$r);akp.prototype.Cw=function(a){$r.prototype.Cw.call(this,a);this.isEnabled()&&this.dispatchEvent("change")};akp.prototype.getName=n("D");function bkp(){}z(bkp,Zr);bkp.prototype.Ha=function(a){var b=Dq($jp,{name:a.getName()});ar(b,this.iy(a));return b};bkp.prototype.Bd=q("waffle-dataconnector-refresh-weekday-toggle");qa(bkp);function ckp(a){rq.call(this,a);this.C=dkp(this,a)}z(ckp,rq);ckp.prototype.Ha=function(){rq.prototype.Ha.call(this);this.Qb(Dq(Zjp))};ckp.prototype.Oa=function(){var a=this;rq.prototype.Oa.call(this);fn(this.Ia("waffle-dataconnector-refresh-weekday-select-label"),"Repeat on");this.C.forEach(function(b,c){b.render(a.Lj("waffle-dataconnector-refresh-weekday-select")[c]);Xq(b.Sa(),Vt.WEEKDAYS[c])})};ckp.prototype.Fg=function(){return this.C.filter(function(a){return a.Me()}).map(function(a){return a.C})};
function dkp(a,b){var c=(Vt.FIRSTDAYOFWEEK+1)%7,d=Vt.NARROWWEEKDAYS.map(function(e,f){return new akp(e,(f+6)%7+1,b)});d=d.slice(c).concat(d.slice(0,c));d.forEach(function(e){return a.Na(e)});return d};function ekp(){}z(ekp,nte);ekp.prototype.Ha=function(a){a=a.Da().Ha("INPUT",{type:"text"});a.setAttribute("readonly","readonly");return a};qa(ekp);var fkp=new at("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function gkp(a,b,c,d){yjp.call(this,a,b,c,d);this.R=new HLk(0,Xjp.sb(),d);this.R.setValue("1");this.Na(this.R);a=new fs;a.Na(new bs("hours",4),!0);a.Na(new bs("days",1),!0);a.Na(new bs("weeks",2),!0);a.Na(new bs("months",3),!0);this.D=new Xzk(a,Jjp.sb(),d);ts(this.D,"Add frequency");this.D.vd("waffle-dataconnector-refresh-schedule-frequency");this.Na(this.D);this.J=new Tjp(d);this.Na(this.J);this.va=new ckp(d);this.Na(this.va);this.H=new Xzk(hkp(),Jjp.sb(),d);ts(this.H,"Add time");this.H.vd("waffle-dataconnector-refresh-schedule-time");
this.Na(this.H);this.Fa=new Ljp(0,ekp.sb(),d);this.ma=new Xzk(hkp(),Jjp.sb(),d);ts(this.ma,"Add time");this.Na(this.Fa);this.V=new Iz("Cancel");this.Na(this.V);this.X=new Tt("Save",d);this.X.Xa(!1);this.Na(this.X);this.Ba=new $r("",ax.sb(),d);this.Na(this.Ba);this.Ra=new $r("Setup now",ax.sb(),d);this.Na(this.Ra);this.Pa=new $r("",ax.sb(),d);this.Na(this.Pa);this.F=new z2j(d);this.F.Fh("Enable schedule");this.Na(this.F);this.Ka=b;this.O=new vLk(d);this.O.Ed("waffle-dataconnector-refresh-schedules-new-info-icon");
this.O.setVisible(!1);this.Cb=new tY(!0,"#0f9d58")}z(gkp,yjp);u=gkp.prototype;
u.Ha=function(){yjp.prototype.Ha.call(this);this.Qb(Dq(Yjp));var a=this.Ia("waffle-dataconnector-refresh-schedules-new-title");a.id=tq(this,"waffle-dataconnector-refresh-schedules-new-title");Uq(a,"heading");Vq(this.Sa(),"labelledby",a.id);a=this.O.C;a.setContent(fh("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.O.render(this.Ia("waffle-dataconnector-refresh-schedules-new-header-title"));a=a.Mc();Vq(this.O.Sa(),
"labelledby",a.id)};
u.Oa=function(){yjp.prototype.Oa.call(this);this.V.render(this.Ia("waffle-dataconnector-refresh-schedules-new-cancel-btn"));this.Ba.render(this.Ia("waffle-dataconnector-refresh-schedules-new-edit-btn"));this.F.render(this.Ia("waffle-dataconnector-refresh-schedules-new-enable-switch"));this.R.render(this.Ia("waffle-dataconnector-refresh-schedules-new-interval-input"));this.D.render(this.Ia("waffle-dataconnector-refresh-schedules-new-frequency-select"));this.X.render(this.Ia("waffle-dataconnector-refresh-schedules-new-save-btn"));this.Ra.render(this.Ia("waffle-dataconnector-refresh-schedules-new-setup-btn"));
this.Pa.render(this.Ia("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn"));this.H.render(this.Ia("waffle-dataconnector-refresh-schedules-new-time-select"));this.J.render(this.Ia("waffle-dataconnector-refresh-schedules-new-day-of-month-widget"));this.va.render(this.Ia("waffle-dataconnector-refresh-schedules-new-weekday-select"));this.Cb.render(this.Ia("waffle-dataconnector-refresh-schedules-new-spinner"));this.Fa.render(this.Ia("waffle-dataconnector-refresh-schedules-new-start-date-select"));
this.ma.render(this.Ia("waffle-dataconnector-refresh-schedules-new-start-time-select"));ikp(this,!1);jkp(this,!1);lq(this.Ia("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),!1);lq(this.Ia("waffle-dataconnector-refresh-schedules-new-time-select"),!1);lq(this.Ia("waffle-dataconnector-refresh-schedules-new-start-time-select"),!1);fLb(this.H,new Tq(null,13));fLb(this.ma,new Tq(null,13));fn(this.Ia("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),"Repeat at");fn(this.Ia("waffle-dataconnector-refresh-schedules-new-repeat-every-label"),
"Repeat every");fn(this.Ia("waffle-dataconnector-refresh-schedules-new-start-date-label"),"Start date");var a=this.Ia("waffle-dataconnector-refresh-schedules-new-repeat-every-label");a.id=tq(this,"waffle-dataconnector-refresh-schedules-new-repeat-every-label");Vq(this.D.Sa(),"labelledby",a.id);Vq(this.R.Sa(),"labelledby",a.id);a=this.Ia("waffle-dataconnector-refresh-schedules-new-repeat-at-label");a.id=tq(this,"waffle-dataconnector-refresh-schedules-new-repeat-at-label");Vq(this.H.Sa(),"labelledby",
a.id);a=this.Ia("waffle-dataconnector-refresh-schedules-new-start-date-label");a.id=tq(this,"waffle-dataconnector-refresh-schedules-new-start-date-label");Vq(this.Fa.Sa(),"labelledby",a.id);this.getHandler().listen(this.Ba,"action",this.show).listen(this.V,"action",this.t$c).listen(this.X,"action",this.w$c).listen(this.Ra,"action",this.show).listen(this.F,"action",this.u$c).listen(this.D,"change",this.v$c).listen(this.J,"change",this.J3).listen(this.va,"change",this.J3).listen(this.J,"change",this.J3).listen(this.H,
"change",this.J3).listen(this.ma,"change",this.J3).listen(this.R,"action",this.J3).listen(this.Pa,"action",this.x$c).listen(this.Sa(),"keydown",this.s$c);0<Array.from(this.$a.C.keys()).length?(lq(this.Sa(),!0),Fjp(this)):lq(this.Sa(),!1)};
u.refresh=function(){if(!this.isDisposed()){var a=this.Ia("waffle-dataconnector-refresh-schedules-new-edit-section"),b=this.Ia("waffle-dataconnector-refresh-schedules-new-overview-section"),c=this.Ia("waffle-dataconnector-refresh-schedules-new-fullview-section"),d=this.Ia("waffle-dataconnector-refresh-schedules-new-owner-info"),e=this.Ia("waffle-dataconnector-refresh-schedules-new-setup-btn"),f=this.Ia("waffle-dataconnector-refresh-schedules-new-enable-switch"),h=this.Ia("waffle-dataconnector-refresh-schedules-new-spinner");
lq(e,!1);lq(f,!1);lq(a,!1);lq(b,!1);lq(c,!1);lq(d,!1);lq(h,!1);dr(this.Sa(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!1);var k=!1;this.O.setVisible(!1);switch(this.state){case 1:lq(e,!0);break;case 2:lq(c,!0);lq(a,!0);lq(d,!0);dr(this.Sa(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!0);k=!0;kkp(this);lkp(this);this.J3();this.V.Xa(!0);this.O.setVisible(!0);Wjp(this.J,[Math.min((new Date).getDate(),28)]);break;case 3:lq(h,!0);break;case 5:lq(c,!0);lq(f,!0);lq(a,!0);
lq(d,!0);dr(this.Sa(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!0);k=!0;mkp(this);kkp(this);lkp(this);a=Evk(this.C);this.F.Zc(!!gj(a,1));b=a.Io().Io();this.D.setValue(b);switch(b){case 4:jkp(this,!1);ikp(this,!1);break;case 1:jkp(this,!1);ikp(this,!1);this.H.setValue(lj(a.Io(),2));break;case 2:jkp(this,!0);ikp(this,!1);c=this.va;d=eX(a.Io(),4).Pc();e=da(c.C);for(f=e.next();!f.done;f=e.next())f.value.Zc(!1);for(e=0;e<c.C.length;e++)f=c.C[e],0<=d.indexOf(f.C)&&f.Zc(!0);this.H.setValue(lj(a.Io(),
2));break;case 3:jkp(this,!1),ikp(this,!0),Wjp(this.J,eX(a.Io(),5).Pc()),this.H.setValue(lj(a.Io(),2))}c=ej(a.Io(),7)?new Date(kj(a.Io(),7)):new Date;this.Fa.setDate(c);4===b?this.ma.setValue(c.getHours()):this.H.setValue(lj(a.Io(),2));this.R.setValue(mj(a.Io(),6,1).toString());this.J3();this.V.Xa(!0);this.O.setVisible(!0);break;case 4:lq(f,!0),lq(b,!0),mkp(this),b=this.Ia("waffle-dataconnector-refresh-schedules-new-overview-text"),Gjp(this)?(a=this.C.getStatus(),fn(b,"Next: "),b=new Date(1E3*kj(a,
2)),a=new Date(1E3*kj(a,3)),this.Ba.setContent(tn(this.Da(),aMk(b,a,this.Ka,!0,!0)))):(fn(b,"Paused"),this.Ba.setContent("Edit"))}this.oa!=k&&(this.oa=k,this.dispatchEvent(k?"oj":"nj"))}};function mkp(a){var b=!!gj(Evk(a.C),1),c=hu.isEnabled();a.F.Zc(b);a.F.Xa(c)}function kkp(a){var b=a.Ia("waffle-dataconnector-refresh-schedules-new-owner-info"),c="Will run as you.";a.C&&(a=ij(a.C.Cc(4,djp),1))&&(c+=" Currently running as "+a);fn(b,c)}
function lkp(a){var b=a.Ia("waffle-dataconnector-refresh-schedules-new-fullview-text");if(Gjp(a)){var c=a.C.getStatus(),d=new Date(1E3*kj(c,2));c=new Date(1E3*kj(c,3));var e=a.Da();e.jf(b);e.appendChild(b,tn(e,oh(fh("Next: "),aMk(d,c,a.Ka,!1,!0))))}else fn(b,"");a.Pa.setContent($Lk(a.Ka))}u.t$c=function(){nkp(this)};function nkp(a){a.state=2==a.state?1:4;a.refresh();a.Ia("waffle-dataconnector-refresh-schedules-new-title").focus()}
u.v$c=function(){switch(this.D.getValue()){case 4:jkp(this,!1);ikp(this,!1);okp(this,!0);break;case 1:jkp(this,!1);ikp(this,!1);okp(this,!1);break;case 2:ikp(this,!1);jkp(this,!0);okp(this,!1);break;case 3:jkp(this,!1),ikp(this,!0),okp(this,!1)}this.J3()};function okp(a,b){lq(a.Ia("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),!b);lq(a.Ia("waffle-dataconnector-refresh-schedules-new-time-select"),!b);lq(a.Ia("waffle-dataconnector-refresh-schedules-new-start-time-select"),b)}
u.w$c=function(){this.X.Xa(!1);this.V.Xa(!1);var a=this.D.getValue(),b=njp().s$(a);if(2===a)for(var c=da(this.va.Fg()),d=c.next();!d.done;d=c.next())zva(b,4,d.value);else if(3===a)for(c=da(this.J.Fg()),d=c.next();!d.done;d=c.next())zva(b,5,d.value);d=this.Fa.getDate();4===a&&d.setHours(this.ma.getValue());d=d.getTime();tj(b,7,d);4!==a&&(a=this.H.getValue(),uj(b,2,a));a=parseInt(this.R.getValue(),10);uj(b,6,a);b=uj(ojp().s$(b),3,1);2==this.state?(b.Xa(!0),D5b.hc(b.build())):(b.Xa(this.F.Me()),E5b.hc(b.build()))};
u.u$c=function(){var a=this;if(4==this.state){var b=this.F.Me();this.F.Zc(!b);this.F.Xa(!1);if(b){var c=pkp(this);c.render();c.setVisible(!0);c.Ol().then(function(){ii(c);F5b.hc()},function(){ii(c);mkp(a)})}else G5b.hc()}};u.s$c=function(a){27==a.keyCode&&this.oa&&(nkp(this),a.stopPropagation())};u.x$c=function(){Gbc.hc()};
u.J3=function(){var a=!!this.D.gj(),b=3!==this.D.getValue()||0<this.J.Fg().length,c=2!==this.D.getValue()||0<this.va.Fg().length,d=!!this.H.gj()||4===this.D.getValue(),e=!!this.ma.gj()||4!==this.D.getValue(),f=hu.isEnabled(),h=parseInt(this.R.getValue(),10);this.X.Xa(a&&b&&c&&d&&e&&f&&0<h&&100>=h)};u.focus=function(){this.Ia("waffle-dataconnector-refresh-schedules-new-title").focus()};u.Xmb=function(a){this.F.Xa(a)};
function ikp(a,b){lq(a.Ia("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget"),b)}function jkp(a,b){lq(a.Ia("waffle-dataconnector-refresh-schedules-new-weekday-select"),b)}
function pkp(a){var b=new q3k;b.Ed("waffle-dataconnector-refresh-schedules-new-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=Evk(a.C);switch(c.Io().Io()){case 1:var d="Daily ";break;case 2:d=qkp();var e=eX(c.Io(),4).Pc();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(eX(c.Io(),5).Pc().map(function(l){return fkp.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=YLk(a.Ka);var h=new Date(wa()),k=new Date(1E3*kj(f,2));f=new Date(1E3*kj(f,3));d+=ZLk(k,f,c)+" ("+mZb(oZb(c,h))+")";a="Will run as "+ij(a.C.Cc(4,djp),1);a=oh(fh("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),lh("H4",void 0,"Schedule"),fh(d),lh("BR"),fh(a));pr(b,a);return b}u.yWa=function(){Js.sb().postMessage(Ls("Error saving schedule.","error",!0));this.X.Xa(!0);this.V.Xa(!0);this.F.Xa(!0)};
function qkp(){var a=(Vt.FIRSTDAYOFWEEK+1)%7,b=Vt.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))}function hkp(){for(var a=new fs,b=new Date(wa()),c=Array(24),d=0;24>d;d++){b.setHours(d,0,0,0);var e=new Date(b.getTime()),f=new Date(b.getTime());f.setHours(e.getHours()+1);f=ZLk(e,f);c[e.getHours()]={value:d,label:f}}for(b=0;24>b;b++)d=new bs(c[b].label,c[b].value),a.Na(d,!0);return a};function rkp(a,b,c){gi.call(this);this.H=a;this.J=b;this.O=c;this.D=[];this.F=[];this.C=[]}z(rkp,gi);rkp.prototype.Va=function(){skp(this);gi.prototype.Va.call(this)};function tkp(a,b,c){var d=Zw(a.H);b.forEach(function(e){var f=e.rect;f&&qv(f)&&(d&&$X(a.H)==e.gid?(e=Cwd(d,f,ukp(c)),a.Ea(e),e.setVisible(!0),a.D.push(e)):vkp(a,e.gid,c))})}
function wkp(a,b,c){var d=Zw(a.H);b.forEach(function(e){if(d){var f=Xod(d.J,e);if(f&&f.Ic()&&f instanceof F2k){a.C.push(f);$q(n2k(f.D),ukp(c));return}}(e=a.O.J.rs(e))&&vkp(a,e.Fb(),c)})}function vkp(a,b,c){b=yxk(a.J,b);$q(b.Sa(),ukp(c));a.F.push(b)}function ukp(a){return a?"waffle-dataconnector-refreshall-highlight-valid":"waffle-dataconnector-refreshall-highlight-error"}
function skp(a){ji(a.D);a.D=[];a.F.forEach(function(b){cr(b.Sa(),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.F=[];a.C.forEach(function(b){cr(n2k(b.D),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.C=[]};function xkp(){return Fq('<div class="'+V("waffle-dataconnector-refresh-all-pane")+'"><div class="'+V("waffle-dataconnector-refresh-all-datasources-container")+'"></div></div>')}function ykp(){return Fq('<div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-items-container")+'"></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer-container")+'"></div>')}
function zkp(a,b){return Fq('<div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title")+'"></div>'+ykp(null,b))}function Akp(){return Fq('<div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer")+'"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper")+'"></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper")+'"></div></div>')}
function Bkp(a){a=a.title;a='<div class="'+V("waffle-dataconnector-refresh-all-dbobject-item")+'" tabindex="0"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-icon-wrapper")+'"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh")+'">'+JRc(null)+'</div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-title")+'" role="heading">'+Eq(a)+'</div><div class="'+
V("waffle-dataconnector-refresh-all-dbobject-item-status-wrapper")+'"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-timestamp")+'"></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-error")+'">';a=a+'Error</div><div class="'+(V("waffle-dataconnector-refresh-all-dbobject-item-loading")+'">');a=a+'Loading\u2026</div><div class="'+(V("waffle-dataconnector-refresh-all-dbobject-item-running")+'">');return Fq(a+"Running\u2026</div></div></div>")};function Ckp(a,b,c,d,e,f,h){rq.call(this,h);this.F=a;this.ma=b;this.X=c;this.V=d.R;this.O=e;this.C=new rkp(e,f,d);this.Ea(this.C);this.R=new Hld;this.H=new tY(!1,"#0f9d58");this.D=this.J=!0}z(Ckp,rq);u=Ckp.prototype;u.Ha=function(){this.Qb(Dq(Bkp,{title:this.ma}));var a=this.Ia("waffle-dataconnector-refresh-all-dbobject-item-title");a.id=tq(this,"waffle-dataconnector-refresh-all-dbobject-item-title");Uq(a,"heading");Vq(this.Sa(),"labelledby",a.id)};
u.Oa=function(){rq.prototype.Oa.call(this);$q(this.Sa(),"waffle-dataconnector-refresh-all-dbobject-item-enabled");this.H.render(this.Ia("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"));this.getHandler().listen(this.Sa(),"click",this.HSb).listen(this.Sa(),"keydown",this.r$c).listen(this.Sa(),["mouseenter","focus"],this.q$c).listen(this.Sa(),["mouseleave","blur"],this.Rsc);Dkp(this)};
function Dkp(a){var b=cwk(a.V,a.F),c=b.getType(),d=a.Sa();switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":case "offline":er(d,"valid-highlight","error-highlight");a.D=!1;break;case "loading":case "no-results":case "fetch-successful":er(d,"error-highlight","valid-highlight");a.D=!0;break;case "fetching-results":case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":Ekp(a,
"waffle-dataconnector-refresh-all-dbobject-item-error");Fkp(a);break;case "offline":Fkp(a);break;case "loading":Ekp(a,"waffle-dataconnector-refresh-all-dbobject-item-loading");Gkp(a);break;case "fetching-results":Ekp(a,"waffle-dataconnector-refresh-all-dbobject-item-running");Gkp(a);break;case "no-results":Hkp(a);Fkp(a);break;case "fetch-successful":b=kj(b.C,8);b=a.R.format(b);fn(a.Ia("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);Xq(a.Ia("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),
b);Ekp(a,"waffle-dataconnector-refresh-all-dbobject-item-timestamp");Fkp(a);break;case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}}u.Xa=function(a){this.J=a;var b=this.Sa();this.Da().po(b,a);a?er(b,"waffle-dataconnector-refresh-all-dbobject-item-disabled","waffle-dataconnector-refresh-all-dbobject-item-enabled"):er(b,"waffle-dataconnector-refresh-all-dbobject-item-enabled","waffle-dataconnector-refresh-all-dbobject-item-disabled")};
u.q$c=function(){var a=this;switch(this.X){case 1:case 3:case 5:var b=Vk().cyb()(this.F,$X(this.O)).map(function(c){return Fv(no(c))});tkp(this.C,b,this.D);break;case 2:b=Vk().byb()(this.F);wkp(this.C,b,this.D);break;case 4:Vk().ayb()(this.F).forEach(function(c){vkp(a.C,c,a.D)})}};u.Rsc=function(){skp(this.C)};function Ekp(a,b){Hkp(a);lq(a.Ia(b),!0)}
function Fkp(a){a.H.setActive(!1);lq(a.Ia("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!1);lq(a.Ia("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!0)}function Gkp(a){a.H.setActive(!0);lq(a.Ia("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!1);lq(a.Ia("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!0)}u.r$c=function(a){13===a.keyCode&&this.HSb()};u.HSb=function(){if(this.J){var a=new Kv("refresh-db-object-request");a.zwb=this.F;this.dispatchEvent(a)}};
function Hkp(a){["waffle-dataconnector-refresh-all-dbobject-item-timestamp","waffle-dataconnector-refresh-all-dbobject-item-error","waffle-dataconnector-refresh-all-dbobject-item-loading","waffle-dataconnector-refresh-all-dbobject-item-running"].forEach(function(b){return lq(a.Ia(b),!1)})};function Ikp(a,b,c,d,e,f,h,k){rq.call(this,k);this.R=a;this.J=new Set(b);this.oa=c;this.V=c.R;this.F=[];this.X=f;this.ma=h;this.H=d;this.D=this.C=null;e&&(this.C=new Jkp(this.Da()),this.D=new GKk(this.H,this.Da(),!0));this.O=new Map([[1,0],[2,0],[3,0],[4,0],[5,0]])}z(Ikp,rq);u=Ikp.prototype;u.Ha=function(){if(this.D){var a=Um("DIV","waffle-dataconnector-refresh-all-dbobject-list-parent");this.Qb(a);this.Na(this.D,!0);this.D.setContent(Dq(ykp));$q(this.D.getElement(),"waffle-dataconnector-refresh-all-dbobject-list-collapsible")}else this.Qb(Dq(zkp))};
u.Oa=function(){rq.prototype.Oa.call(this);this.D||fn(this.Ia("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),this.H);Kkp(this);Lkp(this);var a=this.getHandler();this.C&&(this.C.render(this.Ia("waffle-dataconnector-refresh-all-dbobject-list-footer-container")),a.listen(this.C,"action",this.YGc))};function Mkp(a){var b=a.getHandler();a.F.forEach(function(c){b.ge(c,"refresh-db-object-request",a.UEb)})}
function Lkp(a){var b=a.getHandler();a.F.forEach(function(c){b.listen(c,"refresh-db-object-request",a.UEb)})}function Kkp(a){var b=a.Ia("waffle-dataconnector-refresh-all-dbobject-list-items-container");a.J.forEach(function(c){var d=Vk().OW()(c);c=new Ckp(c,Nkp(a,d),d,a.oa,a.X,a.ma,a.Da());a.F.push(c);c.render(b)})}
function Nkp(a,b){switch(b){case 1:return"Pivot table "+Okp(a,1);case 2:return"Chart "+Okp(a,2);case 3:return"Function "+Okp(a,3);case 4:return"Preview";case 5:return"Extract "+Okp(a,5);default:throw Error("Unexpected DbObjectType");}}function Okp(a,b){var c=a.O.get(b);a.O.set(b,c+1);return 0==c?"":c.toString()}function Pkp(a){a.O.forEach(function(b,c,d){return d.set(c,0)})}
u.YGc=function(){var a=this,b=Array.from(this.J).filter(function(c){return J0c.has(cwk(a.V,c).D)});l5b.hc(new ljp(b,"all-objects-for-single-datasource",this.R))};u.UEb=function(a){a=a.zwb;J0c.has(cwk(this.V,a).D)&&l5b.hc(new ljp([a],"specific-ids"))};function Qkp(a){a.F.forEach(function(b){return Dkp(b)})}function Rkp(a,b){a.C&&(b=b.filter(function(c){return ej(c,3)&&a.J.has(c.pv())}),Skp(a.C,b))}u.expand=function(){this.D.Mm().Zc(!0)};u.Kg=n("R");
function Tkp(a,b){a.H=b;a.D?a.D.Mm().setContent(b):fn(a.Ia("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),b)}u.Xa=function(a){this.C&&this.C.Xa(a);this.F.forEach(function(b){return b.Xa(a)})};function Jkp(a){rq.call(this,a);this.D=new Iz("Refresh",this.Da());this.Na(this.D);this.C=new I0k;this.Na(this.C)}z(Jkp,rq);Jkp.prototype.Ha=function(){this.Qb(Dq(Akp))};
Jkp.prototype.Oa=function(){rq.prototype.Oa.call(this);this.D.render(this.Ia("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper"));this.C.render(this.Ia("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper"))};function Skp(a,b){var c=0;b.forEach(function(d){return c+=parseInt(ij(d,2),10)});iNk(a.C,c);a.D.Xa(!0)}Jkp.prototype.Xa=function(a){this.D.Xa(a)};function Ukp(a,b,c,d){rq.call(this,d);this.F=a;this.J=a.R;this.D=new rq;this.Na(this.D);this.C=[];this.H=b;this.O=c}z(Ukp,rq);Ukp.prototype.Ha=function(){this.Qb(Dq(xkp))};Ukp.prototype.Oa=function(){var a=this;rq.prototype.Oa.call(this);this.D.yb(this.Ia("waffle-dataconnector-refresh-all-datasources-container"));Vkp(this);this.getHandler().listen(this.F.C,"wa",function(b){return Wkp(a,b)})};
function Vkp(a){var b=a.D.jf(!0);ji(b);a.C=[];b=Xkp(a);if(1==b.size)b=b.entries().next().value,Ykp(a,b[0],b[1],!1),$q(a.D.Sa(),"waffle-dataconnector-refresh-all-single-datasource-container");else{for(var c=da(b.keys()),d=c.next();!d.done;d=c.next()){d=d.value;var e=b.get(d);Ykp(a,d,e,!0)}br(a.D.Sa(),"waffle-dataconnector-refresh-all-single-datasource-container")}1<a.C.length&&a.C[0].expand()}
function Zkp(a){var b=Xkp(a);1!=b.size&&1!=a.C.length||b.size==a.C.length?(a.C.forEach(function(c){var d=c.Kg();if(b.has(d)){var e=b.get(d);Mkp(c);ji(c.F);c.F=[];Pkp(c);c.J=new Set(e);Kkp(c);Lkp(c)}else $kp(a,c);b.delete(d)}),b.forEach(function(c,d){return Ykp(a,d,c,!0)})):Vkp(a)}function $kp(a,b){a.C=a.C.filter(function(c){return b!=c});ii(b)}function Ykp(a,b,c,d){var e=Vk().Sba()(b);e=tw(a.F.C,e).bh();b=new Ikp(b,c,a.F,e,d,a.H,a.O,a.Da());a.C.push(b);a.D.Na(b,!0)}
function Xkp(a){var b=new Map;jjp(a.J).forEach(function(c){var d=Vk().U5()(c);b.has(d)?b.get(d).push(c):b.set(d,[c])});return b}function alp(a,b){a.C.forEach(function(c){return Rkp(c,b)})}function blp(a){a.C.forEach(function(b){b.C&&gNk(b.C.C)})}function clp(a){a.C.forEach(function(b){b.C&&(b=b.C,fNk(b.C),b.D.Xa(!1))})}function dlp(a){a.C.forEach(function(b){return Qkp(b)})}Ukp.prototype.Xa=function(a){this.C.forEach(function(b){return b.Xa(a)})};
function Wkp(a,b){3==tw(a.F.C,b.Jm).hj()&&(a=a.C.find(function(c){return c.H==b.C}))&&Tkp(a,b.Gv)};function elp(a,b,c){b=void 0===b?yv.sb():b;Or.call(this,"",void 0,c);a&&flp(a);this.C=new glp(a,b,c);this.Na(this.C)}z(elp,Or);u=elp.prototype;u.Ha=function(){this.C.Ha();this.Qb(this.C.Sa())};u.He=function(a){a.Zw(!0);this.C.He(a)};u.KD=function(a,b){a.Zw(!0);this.C.KD(a,b)};u.Rk=function(a){return this.C.Rk(a)};u.xn=function(){return this.C.xn()};u.Fg=function(){return this.C.C.map(function(a){return a.getValue()})};
function hlp(a,b){a=a.C;for(var c=da(a.C),d=c.next();!d.done;d=c.next())d.value.Zc(!1);if(0==b.length)a.C=[];else{c=[];d=b.length;for(var e=0;e<a.xn();e++){var f=a.Rk(e),h=f.getValue();if(0<=b.indexOf(h)&&(f.Zc(!0),c.push(f),0==--d))break}a.C=c}a.m_()}u.Oc=function(){return this.C.Oc()};u.Lh=function(a){flp(a);this.C.Lh(a)};u.vd=function(a){this.C.vd(a)};function flp(a){for(var b=0;b<a.Ad();b++)a.Ud(b).Zw(!0)}function glp(a,b,c){b=void 0===b?yv.sb():b;kY.call(this,a,b,c);this.C=[]}z(glp,kY);
glp.prototype.Lh=function(a){kY.prototype.Lh.call(this,a);this.C=[];this.m_()};glp.prototype.rA=function(a){a.stopPropagation();a=a.target;if(a.Me()){var b=this.Oc();nia(this.C,a,function(c,d){return gg(vq(b,c),vq(b,d))})}else Tf(this.C,a);this.m_();this.dispatchEvent("change")};glp.prototype.D=function(){var a;0==this.C.length?a=this.H:a=this.C.map(function(b){return b.Nl()}).join(", ");return a||""};function ilp(){var a='<div class="'+V("waffle-dataconnector-refresh-schedules-widget")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-header")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-top-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-header-title")+'"><span tabindex="0" class="'+V("waffle-dataconnector-refresh-schedules-title")+'" role="heading">';a=a+'Scheduled refresh</span></div><div class="'+(V("waffle-dataconnector-refresh-schedules-enable-switch")+
'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-spinner")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-setup-btn")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-overview-section")+'"><span class="'+V("waffle-dataconnector-refresh-schedules-overview-text")+'"></span><span class="'+V("waffle-dataconnector-refresh-schedules-edit-btn")+'"></span></div><div class="'+V("waffle-dataconnector-refresh-schedules-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-fullview-text"></div><div><span class="'+
V("waffle-dataconnector-refresh-schedules-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(V("waffle-dataconnector-refresh-schedules-edit-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-frequency-select")+" "+V("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-edit-section-row")+
" "+V("waffle-dataconnector-refresh-schedules-edit-section-row-date")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-date-select")+" "+V("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-time-select")+" "+V("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-owner-info")+'"></div><div class="'+
V("waffle-dataconnector-refresh-schedules-btns")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-cancel-btn")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-save-btn")+'"></div></div></div></div>');return Fq(a)};var jlp=new at("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function klp(a,b,c,d){yjp.call(this,a,b,c,d);this.Ka=of(pf(),"fdsrfu")?1:4;a=new fs;a.Na(new bs("Every day",1),!0);a.Na(new bs("Every week",2),!0);a.Na(new bs("Every month",3),!0);this.H=new kY(a,yv.sb(),d);ts(this.H,"Add frequency");this.H.vd("waffle-dataconnector-refresh-schedule-frequency");this.H.setContent("Frequency");this.Na(this.H);this.D=new elp(void 0,yv.sb(),d);ts(this.D.C,"Add date");this.D.vd("waffle-dataconnector-refresh-schedule-date");this.D.C.setContent("On date");this.Na(this.D);
var e=this.Ka;a=new fs;var f=new Date(wa());c=Array(24);for(var h=0;24>h;h++){f.setHours(h,0,0,0);var k=new Date(f.getTime()),l=new Date(f.getTime());l.setHours(k.getHours()+e);l=ZLk(k,l);c[k.getHours()]={value:h,label:l}}for(e=0;24>e;e++)f=new bs(c[e].label,c[e].value),a.Na(f,!0);this.J=new kY(a,yv.sb(),d);ts(this.J,"Add time");this.J.vd("waffle-dataconnector-refresh-schedule-time");this.J.setContent("Between");this.Na(this.J);this.R=new Iz("Cancel");this.Na(this.R);this.V=new Tt("Save",d);this.V.Xa(!1);
this.Na(this.V);this.X=new $r("",ax.sb(),d);this.Na(this.X);this.Ba=new $r("Setup now",ax.sb(),d);this.Na(this.Ba);this.va=new $r("",ax.sb(),d);this.Na(this.va);this.F=new z2j(d);this.F.Fh("Enable schedule");this.Na(this.F);this.ma=b;this.O=new vLk(d);this.O.Ed("waffle-dataconnector-refresh-schedules-info-icon");this.O.setVisible(!1);this.Fa=new tY(!0,"#0f9d58")}z(klp,yjp);u=klp.prototype;
u.Ha=function(){yjp.prototype.Ha.call(this);this.Qb(Dq(ilp));var a=this.Ia("waffle-dataconnector-refresh-schedules-title");a.id=tq(this,"waffle-dataconnector-refresh-schedules-title");Uq(a,"heading");Vq(this.Sa(),"labelledby",a.id);a=this.O.C;a.setContent(fh("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.O.render(this.Ia("waffle-dataconnector-refresh-schedules-header-title"));a=a.Mc();Vq(this.O.Sa(),"labelledby",
a.id)};
u.Oa=function(){yjp.prototype.Oa.call(this);this.R.render(this.Ia("waffle-dataconnector-refresh-schedules-cancel-btn"));this.X.render(this.Ia("waffle-dataconnector-refresh-schedules-edit-btn"));this.F.render(this.Ia("waffle-dataconnector-refresh-schedules-enable-switch"));this.H.render(this.Ia("waffle-dataconnector-refresh-schedules-frequency-select"));this.V.render(this.Ia("waffle-dataconnector-refresh-schedules-save-btn"));this.Ba.render(this.Ia("waffle-dataconnector-refresh-schedules-setup-btn"));this.va.render(this.Ia("waffle-dataconnector-refresh-schedules-timezone-setting-btn"));
this.J.render(this.Ia("waffle-dataconnector-refresh-schedules-time-select"));this.D.render(this.Ia("waffle-dataconnector-refresh-schedules-date-select"));this.Fa.render(this.Ia("waffle-dataconnector-refresh-schedules-spinner"));llp(this,!1);fLb(this.J,new Tq(null,13));this.getHandler().listen(this.X,"action",this.show).listen(this.R,"action",this.z$c).listen(this.V,"action",this.C$c).listen(this.Ba,"action",this.show).listen(this.F,"action",this.A$c).listen(this.H,"change",this.B$c).listen(this.D,
"change",this.XDa).listen(this.J,"change",this.XDa).listen(this.va,"action",this.D$c).listen(this.Sa(),"keydown",this.y$c);0<Array.from(this.$a.C.keys()).length?(lq(this.Sa(),!0),Fjp(this)):lq(this.Sa(),!1)};
u.refresh=function(){if(!this.isDisposed()){var a=this.Ia("waffle-dataconnector-refresh-schedules-edit-section"),b=this.Ia("waffle-dataconnector-refresh-schedules-overview-section"),c=this.Ia("waffle-dataconnector-refresh-schedules-fullview-section"),d=this.Ia("waffle-dataconnector-refresh-schedules-owner-info"),e=this.Ia("waffle-dataconnector-refresh-schedules-setup-btn"),f=this.Ia("waffle-dataconnector-refresh-schedules-enable-switch"),h=this.Ia("waffle-dataconnector-refresh-schedules-spinner");
lq(e,!1);lq(f,!1);lq(a,!1);lq(b,!1);lq(c,!1);lq(d,!1);lq(h,!1);dr(this.Sa(),"waffle-dataconnector-refresh-schedules-widget-opened",!1);var k=!1;this.O.setVisible(!1);switch(this.state){case 1:lq(e,!0);break;case 2:lq(c,!0);lq(a,!0);lq(d,!0);dr(this.Sa(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);k=!0;mlp(this);nlp(this);this.XDa();this.R.Xa(!0);this.O.setVisible(!0);break;case 3:lq(h,!0);break;case 5:lq(c,!0);lq(f,!0);lq(a,!0);lq(d,!0);dr(this.Sa(),"waffle-dataconnector-refresh-schedules-widget-opened",
!0);k=!0;olp(this);mlp(this);nlp(this);a=Evk(this.C);this.F.Zc(!!gj(a,1));b=a.Io().Io();this.H.setValue(b);switch(b){case 1:llp(this,!1);break;case 2:hlp(this.D,eX(a.Io(),4).Pc());llp(this,!0);break;case 3:hlp(this.D,eX(a.Io(),5).Pc()),llp(this,!0)}this.J.setValue(lj(a.Io(),2));this.XDa();this.R.Xa(!0);this.O.setVisible(!0);break;case 4:lq(f,!0),lq(b,!0),olp(this),b=this.Ia("waffle-dataconnector-refresh-schedules-overview-text"),Gjp(this)?(a=this.C.getStatus(),fn(b,"Next: "),b=new Date(1E3*kj(a,2)),
a=new Date(1E3*kj(a,3)),this.X.setContent(tn(this.Da(),aMk(b,a,this.ma,!0,!0)))):(fn(b,"Paused"),this.X.setContent("Edit"))}this.oa!=k&&(this.oa=k,this.dispatchEvent(k?"oj":"nj"))}};function olp(a){var b=!!gj(Evk(a.C),1),c=hu.isEnabled();a.F.Zc(b);a.F.Xa(c)}function mlp(a){var b=a.Ia("waffle-dataconnector-refresh-schedules-owner-info"),c="Will run as you.";a.C&&(a=ij(a.C.Cc(4,djp),1))&&(c+=" Currently running as "+a);fn(b,c)}
function nlp(a){var b=a.Ia("waffle-dataconnector-refresh-schedules-fullview-text");if(Gjp(a)){var c=a.C.getStatus(),d=new Date(1E3*kj(c,2));c=new Date(1E3*kj(c,3));var e=a.Da();e.jf(b);e.appendChild(b,tn(e,oh(fh("Next: "),aMk(d,c,a.ma,!1,!0))))}else fn(b,"");a.va.setContent($Lk(a.ma))}u.z$c=function(){plp(this)};function plp(a){a.state=2==a.state?1:4;a.refresh();a.Ia("waffle-dataconnector-refresh-schedules-title").focus()}
u.B$c=function(){var a=this.H.getValue();hlp(this.D,[]);switch(a){case 1:llp(this,!1);break;case 2:llp(this,!0);a=this.D;var b=a.Lh,c=new fs,d=qlp();d=da(d);for(var e=d.next();!e.done;e=d.next())e=e.value,c.Na(new bs(e.label,e.value),!0);a=b.call(a,c);ii(a);break;case 3:llp(this,!0);a=this.D;b=a.Lh;c=new fs;for(d=1;28>=d;d++)c.Na(new bs(jlp.format({DAY:d}),d),!0);a=b.call(a,c);ii(a)}this.XDa()};
u.C$c=function(){this.V.Xa(!1);this.R.Xa(!1);var a=this.H.getValue(),b=njp().s$(a);if(2===a){var c=da(this.D.Fg());for(a=c.next();!a.done;a=c.next())zva(b,4,a.value)}else if(3===a)for(c=da(this.D.Fg()),a=c.next();!a.done;a=c.next())zva(b,5,a.value);a=this.J.getValue();uj(b,2,a);b=uj(ojp().s$(b),3,1);2==this.state?(b.Xa(!0),D5b.hc(b.build())):(b.Xa(this.F.Me()),E5b.hc(b.build()))};
u.A$c=function(){var a=this;if(4==this.state){var b=this.F.Me();this.F.Zc(!b);this.F.Xa(!1);if(b){var c=rlp(this);c.render();c.setVisible(!0);c.Ol().then(function(){ii(c);F5b.hc()},function(){ii(c);olp(a)})}else G5b.hc()}};u.y$c=function(a){27==a.keyCode&&this.oa&&(plp(this),a.stopPropagation())};u.D$c=function(){Gbc.hc()};u.XDa=function(){var a=!!this.H.gj(),b=1===this.H.getValue()||0<this.D.Fg().length,c=!!this.J.gj(),d=hu.isEnabled();this.V.Xa(a&&b&&c&&d)};u.focus=function(){this.Ia("waffle-dataconnector-refresh-schedules-title").focus()};
u.Xmb=function(a){this.F.Xa(a)};function llp(a,b){lq(a.Ia("waffle-dataconnector-refresh-schedules-edit-section-row-date"),b)}
function rlp(a){var b=new q3k;b.Ed("waffle-dataconnector-refresh-schedules-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=Evk(a.C);switch(c.Io().Io()){case 1:var d="Daily ";break;case 2:d=qlp();var e=eX(c.Io(),4).Pc();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(eX(c.Io(),5).Pc().map(function(l){return jlp.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=YLk(a.ma);var h=new Date(wa()),k=new Date(1E3*kj(f,2));f=new Date(1E3*kj(f,3));d+=ZLk(k,f,c)+" ("+mZb(oZb(c,h))+")";a="Will run as "+ij(a.C.Cc(4,djp),1);a=oh(fh("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),lh("H4",void 0,"Schedule"),fh(d),lh("BR"),fh(a));pr(b,a);return b}u.yWa=function(){Js.sb().postMessage(Ls("Error saving schedule.","error",!0));this.V.Xa(!0);this.R.Xa(!0);this.F.Xa(!0)};
function qlp(){var a=(Vt.FIRSTDAYOFWEEK+1)%7,b=Vt.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))};function slp(a,b,c,d,e,f){wY.call(this,f);this.F=b.R;this.J=a;this.V=d;this.d$=new Ukp(b,c,this.V,this.Da());this.Na(this.d$);this.D=new Hjp(this.F,f);this.Ea(this.D);this.C=null;this.R=of(pf(),"fdsrfu");this.H=null;this.O=e}z(slp,wY);u=slp.prototype;u.Ha=function(){wY.prototype.Ha.call(this);this.Qb(Dq(Ijp,{id:this.getId()}));this.D.render(this.Ia("waffle-dataconnector-refresh-sidebar-footer-wrapper"))};
u.Oa=function(){var a=this;wY.prototype.Oa.call(this);tlp(this);this.getHandler().listen(this,["nj","oj"],this.kIc);this.d$.render(this.Ia("waffle-dataconnector-refresh-sidebar-refresh-widget"));ulp(this,!0);this.getHandler().listen(this.D,"refresh-db-object-request",function(){var b=kjp(a.F);l5b.hc(new ljp(b,"all-objects-for-all-datasources"))});this.D.refresh();lq(this.Ia("waffle-dataconnector-refresh-sidebar-backdrop"),!1)};function vlp(a){null!=a.C&&(ii(a.C),ii(a.H),tlp(a))}
u.DYa=function(){null!=this.C&&this.C.show()};function wlp(a,b){alp(a.d$,b);var c=0;b.forEach(function(d){return c+=parseInt(ij(d,2),10)});a.D.Hy(c)}function ulp(a,b){a.d$.Xa(b);b?a.D.refresh():a.D.C.Xa(b)}
u.kIc=function(a){var b=this;a="oj"===a.type;lq(this.Ia("waffle-dataconnector-refresh-sidebar-backdrop"),a);ulp(this,!a);Sp(this.Ia("waffle-sidebar-content"),"overflow-y",a?"hidden":"auto");ii(this.H);a?setTimeout(function(){if(b.C.Ic()){var c=b.C.Sa();b.H=new Mt(c,b.Da());b.Ea(b.H);Nt(b.H);c.focus()}},500):this.resize()};function tlp(a){a.C=a.R?new gkp(a.F,a.J,a.O,a.Da()):new klp(a.F,a.J,a.O,a.Da());a.Na(a.C);a.C.render(a.Sa());lq(a.Ia("waffle-dataconnector-refresh-sidebar-backdrop"),!1)}
u.resize=function(){if(this.C&&!this.C.oa){var a=eq(this.Ia("waffle-sidebar-content")).height-eq(this.C.Sa()).height,b=this.Ia("waffle-dataconnector-refresh-sidebar-refresh-widget");dq(b,a)}};function xlp(a,b,c){eY.call(this,a,b);var d=this;this.C=c;this.F=new Dm;this.Ea(this.F);this.F.Nc(this.C.D,function(e){if("dbobjectmodel-event-add"==e.getType()||"dbobjectmodel-event-remove"==e.getType())e=d.Hd,Zkp(e.d$),0<kjp(e.F).length||e.dispatchEvent("close-sidebar");ylp(d);dlp(d.Hd.d$)});this.D.listen(Pw,"show-db-objects-refresh-sidebar",this.H)}z(xlp,eY);xlp.prototype.Yj=function(){return n5b};xlp.prototype.ux=function(){return o5b};
function ylp(a){var b=kjp(a.C),c=a.Hd;0==b.length?mjp(c.D):(blp(c.d$),K0k(c.D),bVj(a.C,b,function(d){a.isDisposed()||c.isDisposed()||wlp(c,d)},function(d){a.isDisposed()||c.isDisposed()||(d=new P_c(d[0].pv(),d[0].Bj()),clp(c.d$),c.D.WR(d))}))}xlp.prototype.H=function(a){var b=this;vlp(this.Hd);ylp(this);Ixk(this);a.DYa&&this.Hd.DYa();wn(function(){b.Hd.Sa().focus()})};function zlp(){ho.apply(this,arguments)}z(zlp,ho);zlp.prototype.C=function(){return xlp};zlp.prototype.D=function(){return slp};vo("dbrefresh",zlp);
