A_j.prototype.Yea=x(4193,function(a){this.C.C.g$(a)});I_j.prototype.Yea=x(4192,function(a){this.D.Yea(a)});n_a.prototype.uva=x(244,function(){return mk(this,3)});l4a.prototype.uva=x(243,function(){return mk(this,3)});tPa.prototype.vB=x(238,function(){return mk(this,2)});aTa.prototype.vB=x(237,function(){return mk(this,1)});Kva.prototype.kB=x(206,function(){return ij(this,12)});Mva.prototype.kB=x(205,function(){return this.message.kB()});zXj.prototype.kB=x(204,function(){return Q(this,2)});
FXj.prototype.kB=x(203,function(){return Q(this,2)});function Kcs(a){Yy(a,function(b){b=new (b.H())(a.H,a.Ib);Xy(a,b);b.setVisible(!0)},"ritzmaestro")}function Lcs(a,b){Yy(a,function(c){c=c.C(b,this.H,this.wb);Xy(this,c);c.setVisible(!0)},"ritzmaestro")}function Mcs(a,b){Yy(a,function(c){c=c.D(b,this.H,this.wb);Xy(this,c);c.setVisible(!0)},"ritzmaestro")}function Ncs(a,b){a.D=b}function Ocs(a,b){var c=gg;hg(a,function(d,e){return c(b(d),b(e))})}function Pcs(a){pj.call(this,a)}z(Pcs,pj);
Pcs.prototype.Kg=function(){return this.message.Kg()};function Qcs(a){var b=Rcs();Scs(b);return sj(b,3,a)}function Scs(a){a.Rp(1,2,3,4,5,6)}function Tcs(a){this.Kb=aj(a,-1,0)}z(Tcs,bj);Tcs.prototype.Ab=function(){return new Pcs(this)};Tcs.prototype.Kg=function(){return ij(this,1)};function Rcs(){var a=void 0===a?dj(Tcs):a;return new Pcs(a)}function Ucs(a){pj.call(this,a)}z(Ucs,pj);Ucs.prototype.getFunctionName=function(){return this.message.getFunctionName()};function Vcs(a){this.Kb=aj(a,-1,0)}
z(Vcs,bj);Vcs.prototype.Ab=function(){return new Ucs(this)};Vcs.prototype.getFunctionName=function(){return ij(this,2)};function Wcs(){var a=void 0===a?dj(Vcs):a;return new Ucs(a)}function Xcs(a){pj.call(this,a)}z(Xcs,pj);function Ycs(a,b){return wj(a,1,b)}function Zcs(a){this.Kb=aj(a,-1,0)}z(Zcs,bj);Zcs.prototype.Ab=function(){return new Xcs(this)};function $cs(){var a=void 0===a?dj(Zcs):a;return new Xcs(a)}
function ads(a,b){var c=this;this.J=a;this.F=new di;this.C=new Map;this.D=new Map;this.H=new Gm(this);this.H.listen(b,"external_data_change",function(){bds(c);c.F.dispatchEvent(null)});bds(this)}
function cds(a,b,c){for(var d=da(nj(b,1,Vcs).Pc()),e=d.next();!e.done;e=d.next()){var f=e.value;ej(f,2);e=f.getFunctionName();var h=a.C.get(e);if(h)if(gj(f,5))a.C.delete(e),a.D.set(e,h);else{h=h.Ab();ej(f,3);var k=ij(f,3);sj(h,8,k);ej(f,4)?(f=ij(f,4),sj(h,9,f)):qj(h,9);a.C.set(e,h.build())}else h=a.D.get(e).Ab(),ej(f,3),f=ij(f,3),sj(h,8,f),a.C.set(e,h.build()),a.D.delete(e)}a.F.dispatchEvent(null);Pl(Jo(Bo(a.J.Ci("/editactions"),{data:JSON.parse(b.Ob())}),"POST"),c).Ei()}
function bds(a){var b=Vk().xca()().map(Lva),c=new Map,d=new Map;b=da(b);for(var e=b.next();!e.done;e=b.next())e=e.value,ej(e,8)?c.set(e.getFunctionName(),e):gj(e,11)||d.set(e.getFunctionName(),e);a.C=c;a.D=d}function dds(){return Fq('<div class="waffle-edit-actions-dialog-scroll"><div class="waffle-edit-actions-dialog-actions-row-container"></div><div class="waffle-edit-actions-empty" role="alert">There are no macros</div></div>')}
function eds(a){return Fq('<div class="waffle-edit-actions-row"><div class="waffle-edit-actions-row-name"><input class="waffle-edit-actions-name-input jfk-textinput" maxlength="50"/><div class="waffle-edit-actions-shortcut-conflict-message"></div></div><div class="waffle-edit-actions-options"><div class="waffle-edit-actions-row-shortcut-prefix">'+Eq(a.Bnb)+'</div><div class="waffle-edit-actions-row-shortcut"><input class="waffle-edit-actions-row-shortcut-input jfk-textinput" maxlength="1"/></div><div class="waffle-edit-actions-row-menu"></div></div></div>')}
;function fds(a,b,c,d){wt.call(this,void 0,!1,d);var e=this;this.V=a;this.R=Array.from(this.V.C.values());Ocs(this.R,function(f){return f.getFunctionName()});this.F=b;this.X=c;this.C=new Map;this.O=null;this.H=new O$c("Macro removed","UNDO",function(){return gds(e)},void 0,this.Da(),"off");this.Ea(this.H);LVb(this.X,this.H);ur(this,(new sr).Fj(wr,!1,!0).set("save","Update",!0))}z(fds,wt);
fds.prototype.Ha=function(){wt.prototype.Ha.call(this);this.hB=!1;tr(this,!1);hds(this,!1);$q(qr(this),"waffle-edit-actions-dialog-gm");zr(this,"save");this.setTitle("Manage macros");this.Mc().appendChild(Dq(dds));for(var a=this.Ia("waffle-edit-actions-dialog-actions-row-container"),b=da(this.R),c=b.next();!c.done;c=b.next()){c=c.value;var d=new ids(c,this.F);this.Na(d);this.C.set(c.getFunctionName(),d);d.render(a)}lq(this.Ia("waffle-edit-actions-empty"),!1);this.H.render();$q(this.H.Sa(),"waffle-edit-actions-undo-remove-toast")};
function hds(a,b){vr(a.D,"save").disabled=!b}fds.prototype.Oa=function(){var a=this;wt.prototype.Oa.call(this);jds(this);this.getHandler().listen(this,"dialogselect",this.ma).listen(this.Sa(),"keydown",function(b){13==b.keyCode&&"INPUT"==b.target.tagName&&(b.target.setSelectionRange(0,0),b.target.blur(),b.preventDefault());90==b.keyCode&&b.ctrlKey&&gds(a)});kds(this)};
function jds(a){for(var b={},c=da(a.C.values()),d=c.next();!d.done;b={laa:b.laa},d=c.next())b.laa=d.value,a.getHandler().listen(b.laa.X,"action",function(e){return function(){return lds(a,e.laa)}}(b)).listen(mds(b.laa),"input",function(e){return function(){var f=e.laa;nds(f)?IY(f.N8):HY(f.N8,"Must be a number from 0 to 9 or blank.",!0);f=!kds(a)&&nds(f);hds(a,f)}}(b)).listen(ods(b.laa),"input",function(){a.F.C(29573);hds(a,!0)})}
function kds(a){var b=new Map;a=da(a.C.values());for(var c=a.next();!c.done;c=a.next())c=c.value,b.has(pds(c))?b.get(pds(c)).push(c):b.set(pds(c),[c]);a=!1;c=null;b=da(b);for(var d=b.next();!d.done;d=b.next()){var e=da(d.value);d=e.next().value;e=e.next().value;1<e.length&&""!=d?(a=!0,c=d,e.forEach(function(h){h=h.Ia("waffle-edit-actions-shortcut-conflict-message");fn(h,"Conflicts with another shortcut");lq(h,!0)})):e.forEach(function(h){h=h.Ia("waffle-edit-actions-shortcut-conflict-message");lq(h,
!1)})}if(a){var f="Can't save conflicting shortcut "+c;setTimeout(function(){return Rw(f)})}return a}function lds(a,b){hds(a,!0);a.O=b;a.C.delete(b.va);lq(b.Sa(),!1);kds(a);a.H.setVisible(!0);0==a.C.size&&lq(a.Ia("waffle-edit-actions-empty"),!0);a.Sa().focus();var c="Macro "+(b.C.getValue()+" was removed, Ctrl-Z to Undo");setTimeout(function(){return Rw(c)});a.F.C(29572)}
function gds(a){if(null!=a.O){var b=a.O;a.C.set(b.va,b);lq(b.Sa(),!0);lq(a.Ia("waffle-edit-actions-empty"),!1);kds(a);a.O=null;var c="Macro "+(b.C.getValue()+" is restored.");setTimeout(function(){return Rw(c)});a.F.C(29577)}}
fds.prototype.ma=function(a){var b=this;if("cancel"==a.key)this.F.C(29569);else if("save"==a.key){for(var c=da(this.C.values()),d=c.next();!d.done;d=c.next())if(d=d.value,!nds(d)||""!=qds(d)){a.preventDefault();return}kds(this)?a.preventDefault():(a=rds(this),cds(this.V,a,function(){var e=Lt(b.X,"Failed to update macros.",Lm(),!0,0,!0,void 0,!0,["waffle-edit-actions-update-failed"]);e.C=!0;e.render();e.setVisible(!0)}),this.F.C(29574),setTimeout(function(){return Rw("Macros updated")}))}};
function rds(a){for(var b=$cs(),c=da(a.R),d=c.next();!d.done;d=c.next()){var e=d.value;d=Wcs();var f=!1,h=a.C.get(e.getFunctionName()),k=ij(e,9),l=ij(e,8);h?(k!=pds(h)&&(k=pds(h),f=!0),l!=h.C.getValue()&&(l=h.C.getValue(),f=!0)):(rj(d,5,!0),f=!0);f&&(f=ij(e,1),sj(d,1,f),e=e.getFunctionName(),sj(d,2,e),sj(d,3,l),k&&sj(d,4,k),d=d.build(),vj(b,1,d))}return b.build()}
function ids(a,b,c){rq.call(this,c);this.oa=a;this.Fa=ij(a,8);this.va=a.getFunctionName();this.J=(a=ij(a,9))?a.split("+"):[];this.D=new it;this.Na(this.D);this.O=this.R=null;this.C=new it;this.Na(this.C);this.ma=new zt;this.Ea(this.ma);this.Ba=b;b=Mr(Zr,"waffle-overflow-menu-material");this.H=new js(void 0,void 0,b,this.Da());this.Ea(this.H);this.V=new bs("Edit script");this.Ea(this.V);this.X=new bs("Remove");this.Ea(this.X);this.N8=new GY(this.Da());this.Ea(this.N8);this.F=new GY(this.Da());this.Ea(this.F)}
z(ids,rq);ids.prototype.Ha=function(){var a=(Mf(this.J)?sds:this.J.slice(0,this.J.length-1)).join(" + ")+" + ";a=Dq(eds,{Bnb:fp?a.replace(/Ctrl/g,"\u2318").replace(/Alt/g,"Option"):a});this.Qb(a)};
ids.prototype.Oa=function(){var a=this;this.D.yb(this.Ia("waffle-edit-actions-row-shortcut-input"));this.D.setValue(xf(this.J)||"");var b=this.Ia("waffle-edit-actions-name-input");this.C.yb(b);this.C.setValue(this.Fa);this.ma.yb(b);this.N8.setPosition(3,2);this.N8.render();b=this.D.Sa();this.N8.gp(b);JY(this.N8,b);IY(this.N8);this.F.setPosition(0,2);this.F.render();b=this.C.Sa();this.F.gp(b);JY(this.F,b);IY(this.F);b=new Tq(this.H.Mc(),13);fLb(this.H,b);this.H.pR=!0;this.H.He(this.V);this.H.He(this.X);
b=this.Ia("waffle-edit-actions-row-menu");this.H.yb(b);"black"==qs()&&$q(b,"waffle-overflow-menu-material-white");this.getHandler().listen(this.V,"action",function(){U("macros-editor").hc({scriptId:ij(a.oa,1),filename:ij(a.oa,10)});a.Ba.C(29570)}).listen(this.C.Sa(),"blur",function(){""==qds(a)?IY(a.F):HY(a.F,qds(a),!0)}).listen(this.D.Sa(),"click",function(){return a.D.Sa().select()}).listen(mds(this),"input",function(){return a.Ba.C(29571)});Xq(this.Ia("waffle-edit-actions-name-input"),"Macro name");
Xq(this.D.Sa(),"Numeric shortcut key");Xq(b,"More options button")};function pds(a){var b=a.D.getValue();return""==b?"":(Mf(a.J)?sds:a.J.slice(0,a.J.length-1)).join("+")+"+"+b}function mds(a){null==a.R&&(a.R=new yt(a.D.Sa()),a.Ea(a.R));return a.R}function ods(a){null==a.O&&(a.O=new yt(a.C.Sa()),a.Ea(a.O));return a.O}function nds(a){a=a.D.getValue();return""==a||/^\d$/.test(a)}
function qds(a){a=a.C.getValue();return""==a?"Macro name must be not be empty.":/\r|\n/.test(a)?"Macro name must not contain line-break characters.":""}var sds=["Ctrl","Alt","Shift"];function tds(){return Fq('<div class="waffle-import-custom-function-actions-title-separator"></div><div class="waffle-import-custom-function-actions-dialog-scroll"><div class="waffle-import-custom-functions-row-container"></div></div>')}
function uds(a){var b=a.Rfd,c=a.fileName;a='<div class="waffle-import-custom-function-row" tabindex="0"><div class="waffle-import-custom-function-name">'+Eq(a.functionName)+'</div><div class="waffle-import-custom-function-metadata"><div class="waffle-import-custom-function-project-name"><span class="waffle-import-custom-function-description-label">';a=a+'Project:</span><span class="function-description-seperator"></span>'+(Eq(b)+'</div><div class="waffle-import-custom-function-file-name"><span class="waffle-import-custom-function-description-label">');
a=a+'File:</span><span class="function-description-seperator"></span>'+(Eq(c)+'</div></div><div class="waffle-import-custom-function-view-script"></div><div class="waffle-import-custom-function-add-function"></div></div>');return Fq(a)};function vds(a,b,c,d){wt.call(this,void 0,!1,d);this.ma=a;this.H=Array.from(this.ma.D.values());Ocs(this.H,function(e){return e.getFunctionName()});this.X=b;this.Ba=c;this.V=[];this.F=[];this.C=Lt(this.Ba,"Function added.",Lm(),!1,3E3,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);this.Ea(this.C);this.Fa=new Bt(this.Da());this.Ea(this.Fa);this.O=new fo(this.R,3E3,this);this.Ea(this.O)}z(vds,wt);
vds.prototype.Ha=function(){wt.prototype.Ha.call(this);$q(qr(this),"waffle-import-custom-function-actions-dialog");this.setTitle("Import");var a=this.Da().Ha("DIV","waffle-import-custom-function-title-description",cu()?"Added functions will appear in the menu under Extensions > Macros":"Added functions will appear in the menu under Tools > Macros");MIb(this).appendChild(a);this.Mc().appendChild(Dq(tds));a=this.Ia("waffle-import-custom-functions-row-container");for(var b=da(this.H),c=b.next();!c.done;c=
b.next())c=new wds(c.value,this.X),this.Na(c),c.render(a),this.V.push(c);this.C.render();this.C.setVisible(!1);ur(this,null)};vds.prototype.Oa=function(){var a=this;wt.prototype.Oa.call(this);for(var b={},c=da(this.V),d=c.next();!d.done;b={$Ga:b.$Ga},d=c.next())b.$Ga=d.value,this.getHandler().listen(b.$Ga.D,"action",function(e){return function(){return xds(a,e.$Ga)}}(b));this.getHandler().listen(this,"hide",function(){return a.R()})};
function xds(a,b){yds(b);var c=zds(b.C);Ads(a,c);b=b.Ia("waffle-import-custom-function-add-function");b.setAttribute("tabindex","0");Xq(b,"This function has been added.");b.focus();a.X.C(29576);setTimeout(function(){return a.C.setVisible(!0)})}function zds(a){var b=Wcs();var c=ij(a,1);b=sj(b,1,c);c=a.getFunctionName();b=sj(b,2,c);a=a.getFunctionName();return sj(b,3,a).build()}function Ads(a,b){a.F.push(b);a.O.start()}
vds.prototype.R=function(){var a=this;if(0<this.F.length){var b=Ycs($cs(),this.F).build();cds(this.ma,b,function(){var c=Lt(a.Ba,"Failed to add function.",Lm(),!1,1E4,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);c.C=!0;c.render();c.setVisible(!0)});this.F=[]}};function wds(a,b,c){rq.call(this,c);this.C=a;this.H=b;a=Dt.sb();this.D=new $r("Add Function",a,c);this.Na(this.D);this.F=new $r("Edit Script",a,c);this.Na(this.F)}z(wds,rq);
wds.prototype.Ha=function(){rq.prototype.Ha.call(this);var a=Dq(uds,{functionName:this.C.getFunctionName(),Rfd:ij(this.C,2),fileName:ij(this.C,10)});this.Qb(a);this.D.render(this.Ia("waffle-import-custom-function-add-function"));this.F.render(this.Ia("waffle-import-custom-function-view-script"))};
wds.prototype.Oa=function(){var a=this;rq.prototype.Oa.call(this);this.getHandler().listen(this.F,"action",function(){U("macros-editor").hc({scriptId:ij(a.C,1),filename:ij(a.C,10)});a.H.C(29575)});var b="Function: "+(this.C.getFunctionName()+(", from project: "+(ij(this.C,2)+(", defined in file: "+ij(this.C,10)))));Xq(this.Sa(),b)};function yds(a){lq(a.D.Sa(),!1);$q(a.Ia("waffle-import-custom-function-add-function"),"waffle-import-custom-function-actions-checkmark")};function Bds(a,b,c,d,e,f){gi.call(this);this.C=a;this.functionName=b;this.F=d||null;this.D=void 0!==f?f:null}z(Bds,gi);function Cds(a){P(this,a,0,-1,Dds,null)}A(Cds,O);var Dds=[6];u=Cds.prototype;u.Aa=function(){var a=new K;Eds(this,a);return L(a)};
function Eds(a,b){var c=Q(a,1);null!=c&&b.Ga(1,c);c=Q(a,2);null!=c&&b.Ga(2,c);c=Q(a,3);null!=c&&b.Ga(3,c);c=Q(a,4);null!=c&&b.Ga(4,c);c=Q(a,5);null!=c&&b.Ga(5,c);c=a.Cm();0<c.length&&ck(b,6,c,Eds);c=Q(a,7);null!=c&&N(b,7,c);c=Q(a,9);null!=c&&b.Ga(9,c);c=Q(a,10);null!=c&&b.Ga(10,c);c=Q(a,11);null!=c&&Wj(b,11,c);c=Q(a,12);null!=c&&Wj(b,12,c);c=Q(a,13);null!=c&&b.Ga(13,c)}u.Xh=function(){return Q(this,1)};u.Nl=function(){return Q(this,2)};u.ws=function(a){R(this,2,a)};
u.getKey=function(){return Q(this,5)};u.Cm=function(){return Ek(this,Cds,6)};u.He=function(a,b){return Hk(this,6,a,Cds,b)};u.Xa=function(a){return R(this,7,a)};u.kB=function(){return Q(this,13)};function Fds(a){P(this,a,"amep",-1,null,null)}A(Fds,O);Fds.prototype.Aa=function(){var a=new K;var b=this.Oc();null!=b&&a.xa(1,b,Eds);return L(a)};Fds.messageId="amep";Fds.prototype.Oc=function(){return T(this,Cds,1,1)};Fds.prototype.Lh=function(a){return xk(this,1,a)};Fds.prototype.Yta=function(){wk(this,1)};Fds.prototype.cE=function(){return kk(this,1)};function Gds(a){sm.call(this,a)}z(Gds,sm);function Hds(a){sm.call(this,"amep");this.C=new Fds(a)}z(Hds,Gds);Hds.prototype.lk=n("C");function Ids(a){P(this,a,0,-1,null,null)}A(Ids,O);Ids.prototype.Aa=function(){var a=new K;Jds(this,a);return L(a)};
function Jds(a,b){var c=Q(a,1);null!=c&&b.Ga(1,c);c=Q(a,2);null!=c&&b.Ga(2,c);c=Q(a,3);null!=c&&b.Ga(3,c);c=Q(a,4);null!=c&&N(b,4,c);c=Q(a,5);null!=c&&b.Ga(5,c);c=Q(a,6);null!=c&&b.Ga(6,c);c=Q(a,7);null!=c&&b.Ga(7,c);c=Q(a,8);null!=c&&N(b,8,c);c=Q(a,9);null!=c&&N(b,9,c);c=Q(a,10);null!=c&&N(b,10,c);c=Q(a,11);null!=c&&b.Ga(11,c);c=Q(a,12);null!=c&&N(b,12,c);c=Q(a,13);null!=c&&b.Ga(13,c);c=Q(a,14);null!=c&&b.Ga(14,c);c=Q(a,15);null!=c&&b.Ga(15,c);c=Q(a,16);null!=c&&b.Ga(16,c);c=Q(a,17);null!=c&&b.Ga(17,
c);c=Q(a,18);null!=c&&Rj(b,18,c);c=Q(a,19);null!=c&&N(b,19,c)}function L9(a){return Q(a,2)}Ids.prototype.getName=function(){return Q(this,3)};Ids.prototype.Gq=function(){return Q(this,13)};function Kds(a,b){this.D=void 0===a?null:a;this.C=(void 0===b?null:b)||null}Kds.prototype.F=n("C");function Lds(a,b){return of(pf(),"docs-emgsmw")?null==a.F||null==Q(b,18)?!1:a.C===Q(b,18):a.D===Q(b,1)}function Mds(a){return new Kds(Q(a,1),Q(a,18))};function Nds(a){P(this,a,"der",-1,null,null)}A(Nds,O);Nds.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);return L(a)};Nds.messageId="der";Nds.prototype.vB=function(){return mk(this,1)};function Ods(a){P(this,a,"eer",-1,null,null)}A(Ods,O);Ods.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);return L(a)};Ods.messageId="eer";Ods.prototype.vB=function(){return mk(this,1)};function Pds(a,b,c){this.D=a;this.C=b;this.F=c}Pds.prototype.getVersionInfo=n("F");function Qds(a,b){this.C=a;this.D=b}Qds.prototype.getVersionInfo=n("D");function Rds(a,b){this.C=a;this.Qg=b}Rds.prototype.getExtension=n("C");Rds.prototype.isEnabled=n("Qg");function Sds(a){wt.call(this);this.C=a;rr(this,!0);this.oM(!1);ur(this,null);tr(this,!1)}z(Sds,wt);Sds.prototype.Ha=function(){wt.prototype.Ha.call(this);this.C.render(this.Mc())};Sds.prototype.Oa=function(){wt.prototype.Oa.call(this);var a=this.Sa();Wq(a,"labelledby");Xq(a,"Add-ons");$q(qr(this),"gsm-widget")};function Tds(a,b){var c=new Pk,d=new RCa;if(b){if(Q(b,1)){var e=Q(b,1);R(d,1,e)}e=mk(b,12);R(d,2,e);kk(b,18)&&(e=Q(b,18),R(d,5,e));b=mk(b,19);R(d,6,b)}b=qf(pf(),"docs-tcmt");e=!!b;R(d,3,e);e&&R(d,4,b);xk(c,73,d);return yp(zp(new xp,c),a).build()}function Uds(a){var b=new Pk,c=new RCa;null!=a.D&&R(c,1,a.D);null!=a.C&&R(c,5,a.C);xk(b,73,c);return yp(zp(new xp,b),90).build()};function Vds(a,b,c){mQk.call(this,a);this.D=b;this.F=c;this.D.Qp=!0}z(Vds,mQk);u=Vds.prototype;u.Uhb=function(){U("macros-extension-store-render").hc()};u.DUa=function(a,b,c){a=new Kds(null,a);U("macros-extension-store-install").hc(new Pds(a,String(b),c),Uds(a))};u.Thb=function(a,b){a=new Kds(null,a);U("macros-extension-store-uninstall-item").hc(new Qds(a,b),Uds(a))};
u.kQb=function(a){var b=new iQk,c=this.F(new Kds(null,a));if(!c)return b;a=c.getExtension();c=c.isEnabled();var d=new kQk;d.ws("Use in this document");R(d,3,"useInDoc");d.Zc(!!mk(a,4)||!!mk(a,12));d.Xa(c);var e=new kQk;e.ws("Help");R(e,3,"help");d=[d,e];mk(a,9)&&(e=new kQk,R(e,1,!0),d.push(e),mk(a,8)&&(a=new kQk,a.Xa(c),a.ws("Settings"),R(a,3,"settings"),d.push(a)),a=new kQk,a.ws("Report an issue"),R(a,3,"reportIssue"),d.push(a));Gk(b,1,d);return b};
u.jQb=function(a,b){var c=new Kds(null,a);a=Uds(c);switch(b){case "help":b=this.F(c);if(!b)break;b=b.getExtension();U("macros-extension-help").hc(L9(b),a);break;case "reportIssue":U("macros-extension-store-report").hc(c,a);break;case "settings":U("macros-extension-store-settings").hc(c,a);ii(this.D);break;case "useInDoc":U("macros-extension-store-use-in-doc").hc(c,a)}};u.oWa=function(){this.D.setVisible(!1)};function Wds(a,b,c){gi.call(this);this.C=Xds(a);this.F=b;this.D=c}z(Wds,gi);function Yds(a,b,c,d,e){b=new jYk(b,null,e);kYk(b,wf(pf(),"docs-gsmd"));a.D&&nYk(b,a.D);Ncs(b,c.map(function(f){return f.C}));d&&d.C&&(b.F=d.C);a=wf(pf(),"gaia_session_id");a=qg(a)?NaN:Number(a);isNaN(a)||lYk(b,a);return b.build()}function Zds(a,b){var c=new Sds(b);a=new Vds(b,c,a.F);c.Ea(a);return c}
function Xds(a){if(a==(Is(),XNb))return"docs_addon";if(a==(Is(),YNb))return"sheets_addon";if(a==(Is(),ZNb))return"slides_addon";if(a==(Is(),aOb))return"forms_addon";throw Error("Unsupported document type for GSM  ["+a+"]");};function $ds(a,b,c,d,e,f){gi.call(this);this.F=b;this.D=new Wds(a,d,f);this.C=null}z($ds,gi);function aes(a){P(this,a,"iar",-1,null,null)}A(aes,O);aes.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);b=Q(this,2);null!=b&&a.Ga(2,b);b=Q(this,3);null!=b&&N(a,3,b);return L(a)};aes.messageId="iar";aes.prototype.vB=function(){return mk(this,1)};function bes(a,b,c,d){var e=Q(a,4)+"-polymorphic-"+(a.Xh()||"");jDb.call(this,e);this.C=a;this.R=Ef(b,function(f){return new bes(f,[],!1)},this);this.Xa(this.isEnabled());this.va=c;this.oa="boolean"===typeof d?d:!0}z(bes,jDb);bes.prototype.isInstalled=n("oa");bes.prototype.hc=function(){U("macros-polymorphic-item").hc(this)};bes.prototype.isEnabled=function(){return this.R&&(0<this.R.length?!0:!!mk(this.C,7))};bes.prototype.getLabel=function(){return this.C.Nl()||Q(this.C,10)||""};function ces(){sm.call(this,"Pl")}z(ces,sm);function des(){Cm.call(this);this.C={};this.C[1]={};this.C[0]={};this.D=new ws(this);this.Ea(this.D);this.D.subscribe(U("macros-polymorphic-item"),"action",this.F)}z(des,Cm);des.prototype.F=function(a){a.va||0<a.R.length?this.dispatchEvent(new ces(a)):(a=new Bds(Q(a.C,4),Q(a.C,3),void 0,Q(a.C,9)||void 0,void 0,a.C.kB()||void 0),U("macros-exec").hc(a))};function ees(a){P(this,a,"ger",-1,fes,null)}A(ees,O);var fes=[1];ees.prototype.Aa=function(){var a=new K;var b=this.PKa();0<b.length&&ck(a,1,b,Jds);return L(a)};ees.messageId="ger";ees.prototype.PKa=function(){return Ek(this,Ids,1)};function ges(a){P(this,a,0,-1,null,null)}A(ges,O);ges.prototype.Aa=function(){var a=new K;hes(this,a);return L(a)};function hes(a,b){var c=Q(a,1);null!=c&&b.Ga(1,c);c=Q(a,2);null!=c&&b.Ga(2,c)}ges.prototype.getName=function(){return Q(this,1)};function ies(a){P(this,a,0,-1,jes,null)}A(ies,O);var jes=[4];u=ies.prototype;u.Aa=function(){var a=new K;kes(this,a);return L(a)};function kes(a,b){var c=Q(a,1);null!=c&&b.Ga(1,c);c=Q(a,2);null!=c&&b.Ga(2,c);c=Q(a,3);null!=c&&b.Ga(3,c);c=Ek(a,ges,4);0<c.length&&ck(b,4,c,hes)}u.getId=function(){return Q(this,1)};u.vd=function(a){return R(this,1,a)};u.getName=function(){return Q(this,2)};u.Mg=function(){return Q(this,3)};u.Vn=function(a){return R(this,3,a)};function les(a){P(this,a,"llr",-1,mes,null)}A(les,O);var mes=[2];les.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);b=Ek(this,ies,2);0<b.length&&ck(a,2,b,kes);return L(a)};les.messageId="llr";les.prototype.vB=function(){return mk(this,1)};function nes(a){P(this,a,"rar",-1,null,null)}A(nes,O);nes.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);b=Q(this,2);null!=b&&a.Ga(2,b);return L(a)};nes.messageId="rar";nes.prototype.vB=function(){return mk(this,1)};function oes(a){P(this,a,"uer",-1,null,null)}A(oes,O);oes.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);return L(a)};oes.messageId="uer";oes.prototype.vB=function(){return mk(this,1)};function pes(a,b,c,d){gi.call(this);this.D=a;this.F=c;this.C=d||new qes}z(pes,gi);u=pes.prototype;u.ZGb=function(a,b,c,d,e,f,h){a=["ruid",ta({}),this.C.C,this.D,this.C.F,a,this.C.R,b,this.C.D,c,this.C.oa,e,this.C.va,f,this.C.ma,h];a=Ho(Ol(Jo(res(this,this.C.V),"POST"),2),a).fC();d&&(Ql(a,ua(this.rVc,this,d)),Pl(a,ua(this.EAc,this,d)));a.Ei()};u.cancel=function(a){a=["ruid",ta({}),this.C.C,this.D,this.C.H,a];Ho(Ol(Jo(res(this,this.C.J),"POST"),2),a).fC().Ei()};
function ses(a,b){var c=["ruid",ta({}),a.C.C,a.D];c=Ho(Ol(res(a,a.C.X),2),c);b&&(Ql(c,ua(a.kBc,a,b)),Pl(c,ua(a.jBc,a,b)));c.Ei()}u.rVc=function(a,b){b=b.jh();b=new aes(b[0]);a(b)};u.EAc=function(a){var b=new aes;R(b,1,!1);a(b)};u.kBc=function(a,b){b=b.jh();b=new les(b[0]);a(b)};u.jBc=function(a){var b=new les;R(b,1,!1);a(b)};u.sVc=function(a,b){b=b.jh();b=new nes(b[0]);a(b)};u.PHc=function(a){var b=new nes;R(b,1,!1);a(b)};
function tes(a,b){var c=["ruid",ta({}),a.C.C,a.D];Pl(Ql(Ho(Ol(res(a,"/scripts/getitems"),1),c),ua(a.Myc,a,b)),pa).Ei()}u.Myc=function(a,b){b=b.jh();b=new ees(b[0]);a(b)};function ues(a,b,c,d){function e(h,k){k=k.jh();k=new oes(k[0]);h(k)}var f=["ruid",ta({}),a.C.C,a.D];null!=b.D&&f.push("storeitemid",b.D);null!=b.C&&f.push("appid",b.C);d&&f.push("versioninfo",d);b=Ho(Jo(res(a,"/scripts/uninstallitem"),"POST"),f).fC();c&&(Ql(b,ua(e,a,c)),a=new oes,R(a,1,!1),Pl(b,va(c,a)));b.Ei()}
u.gwb=function(a,b,c,d,e,f){a=["ruid",ta({}),this.C.C,this.D,this.C.D,e,"extensionid",a,"justInstalled",d];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);f&&a.push("versioninfo",f);b=Ho(Ol(Jo(res(this,"/scripts/enableitem"),"POST"),1),a).fC();c&&(Ql(b,ua(this.Uwc,this,c)),Pl(b,ua(this.Twc,this,c)));b.Ei()};u.Uwc=function(a,b){b=b.jh();b=new Ods(b[0]);a(b)};u.Twc=function(a){var b=new Ods;R(b,1,!1);a(b)};
u.f9b=function(a,b,c,d){a=["ruid",ta({}),this.C.C,this.D,this.C.D,d,"extensionid",a];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);b=Ho(Ol(Jo(res(this,"/scripts/disableitem"),"POST"),1),a).fC();c&&(Ql(b,ua(this.svc,this,c)),Pl(b,ua(this.rvc,this,c)));b.Ei()};u.svc=function(a,b){b=b.jh();b=new Nds(b[0]);a(b)};u.rvc=function(a){var b=new Nds;R(b,1,!1);a(b)};function res(a,b){return Io(a.F.Ci(b)).setTimeout(4E4)}
function qes(a,b,c,d,e,f,h,k,l,m,p,r,t,v,y,G,M,S){gi.call(this);this.C=a||"id";this.F=c||"lib";this.R=d||"func";this.D=e||"ctx";this.H=f||"pid";this.oa=G||"eei";this.va=M||"usit";this.ma=void 0!==S?S:"did";this.O=h||"ca";this.V=k||"/scripts/invoke";this.J=l||"/scripts/cancel";this.X=m||"/scripts/libraries";this.Ba=p||"/scripts/resume";this.Fa=t||"/scripts/uiready"}z(qes,gi);function ves(a,b,c,d,e,f,h,k,l,m,p,r){gi.call(this);var t=this;this.Fa=m?F9c(m):void 0;this.Ba=m?G9c(m):void 0;this.va=a;this.C=d;this.Ka=e;this.oa=b;this.R=f;this.F=h;this.O=k;this.D=[];this.H=l;this.J=new EJb("mae-show_addons_menu_promo");Hr(c,this.J,"mae-show_addons_menu_promo");this.ma=p||null;this.X=r||null;this.V=new $ds(this.va,this.oa,this,function(v){if(v=t.getExtension(v)){var y=2==t.H?!1:1==t.H?!(!mk(v,10)||!mk(v,9)):!0;v=new Rds(v,y)}else v=void 0;return v},this.Ba,this.Fa);this.Ea(this.V);
U("macros-extension-store-install").Lc(Xo,this.nxc,this);U("macros-extension-store-install").Xa(!0);U("macros-extension-store-render").Lc(Xo,this.oxc,this);U("macros-extension-store-render").Xa(!0);U("macros-extension-store-report").Lc(Xo,this.pxc,this);U("macros-extension-store-report").Xa(!0);U("macros-extension-store-settings").Lc(Xo,this.qxc,this);U("macros-extension-store-settings").Xa(!0);U("macros-extension-store-uninstall-item").Lc(Xo,this.rxc,this);U("macros-extension-store-uninstall-item").Xa(!0);
U("macros-extension-store-use-in-doc").Lc(Xo,this.sxc,this);U("macros-extension-store-use-in-doc").Xa(!0)}z(ves,gi);u=ves.prototype;u.oxc=function(){wes(this)};u.nxc=function(a){a=a.data;xes(this,a.C,a.D,a.getVersionInfo())};u.pxc=function(a){a=this.getExtension(a.data);var b=Mds(a);this.OVb(b,L9(a),a.getName(),Q(a,6)||void 0,Q(a,11)||void 0)};u.qxc=function(a){a=this.getExtension(a.data);yes(this,L9(a))};
u.rxc=function(a){a=a.data;var b=this.getExtension(a.C),c=b&&L9(b);b=Mds(b);zes(this,c,b,pa,a.getVersionInfo())};u.sxc=function(a){var b=this.getExtension(a.data);a=Mds(b);mk(b,4)||mk(b,12)?Aes(this,L9(b),a,function(c){c&&(R(b,4,!1),R(b,12,!1))}):Bes(this,L9(b),a,function(c){c&&R(b,4,!0)})};u.jha=function(a){var b=Ces(this,!1),c=this.V;var d=c.D;a=Yds(d,d.C,b,a,!1);d=Zds(d,a);c.C=d;d=c.C;c.F.zn(d);d.setVisible(!0);Des(this)};
function Ces(a,b){return(void 0===b?0:b)?a.D.map(function(c){return Mds(c)}):a.D.filter(function(c){return mk(c,10)&&mk(c,9)}).map(function(c){return Mds(c)})}function yes(a,b){Ees(a.C);var c=ua(function(d,e){this.C.d7();d&&d(e)},a,void 0);cVj(a.R.C,ua(a.F.ZGb,a.F,b,"doSettings",a.O().getState()||void 0,c))}
function Bes(a,b,c,d){Ees(a.C);cVj(a.R.C,ua(a.F.gwb,a.F,b,c,ua(function(e,f){if(f.vB()){var h=a.getExtension(c);h&&R(h,4,!0);wes(a)}a.C.d7();e&&e(f.vB())},a,d),void 0,a.O().getState()||void 0))}function Aes(a,b,c,d){Ees(a.C);cVj(a.R.C,ua(a.F.f9b,a.F,b,c,ua(function(e,f){if(f.vB()){U("macros-extension-disabled").hc(b);var h=a.getExtension(c);h&&(R(h,4,!1),R(h,12,!1));wes(a)}a.C.d7();e&&e(f.vB())},a,d),a.O().getState()||void 0))}
function zes(a,b,c,d,e){ues(a.F,c,ua(function(f,h){if(h.vB()&&b){U("macros-extension-disabled").hc(b);var k=a.D.findIndex(function(l){return Lds(c,l)});-1!=k&&Uf(a.D,k);(k=Fes(a.C))&&Kg(k.J,b)}wes(a,function(){return f(h.vB())})},a,d),e)}
u.OVb=function(a,b,c,d,e){e?yq(e):(Ges(this.C,ua(function(f,h){var k=this.F,l=ua(this.C.Qkd,this.C,c,h,d),m=ua(this.C.Pkd,this.C);f=["ruid",ta({}),k.C.C,k.D,k.C.F,b,"issuedesc",f,"includeUserInfo",h];null!=a.D&&f.push("storeitemid",a.D);null!=a.C&&f.push("appid",a.C);Ho(Pl(Ql(Ol(Jo(res(k,"/scripts/sendissuereport"),"POST"),1),Yg(l)),Yg(m)),f).fC().Ei()},this),c),Des(this))};
function xes(a,b,c,d){Ees(a.C);cVj(a.R.C,ua(a.F.gwb,a.F,b,c,function(e){a.C.d7();e.vB()?wes(a):(e=Ls("Unable to install add-on","warning",!0),a.C.C.C.postMessage(e),e.getId(),Hes(a))},!0,a.O().getState()||void 0,d))}function wes(a,b){b=void 0===b?pa:b;tes(a.F,ua(function(c,d){d=d.PKa();Nf(this.D);d=da(d);for(var e=d.next();!e.done;e=d.next())this.D.push(e.value);Ies(this);Hes(this);c()},a,b))}
function Ies(a){var b=a.Ka,c=Zf(a.D);b.C[1]={};b.C[0]={};for(var d=0;d<c.length;++d){var e=c[d],f=L9(e),h=new Cds,k=String(ta(h));R(h,1,k);h.ws(e.getName());k=L9(e);R(h,4,k);h.Xa(!0);k=e.getName();R(h,10,k);R(h,11,1);k=!(!mk(e,10)&&!mk(e,9));e=new bes(h,[],!0,k,mk(e,19)||!1);e.setVisible(!0);b.C[nk(e.C,11,0)][f]=e}b.dispatchEvent("Nl");if(b=a.C.R)if(Mf(a.D))!a.J.getValue()&&U("macros-extension-menu-promo").isEnabled()&&(a=a.va,dhb(b.F.F,"mae-promo-id")||(a=new Jes(a),a.render(),c=new bs(""),c.vd("mae-promo-id"),
c.Ed("script-promo-menu-item"),c.setContent(a.getElement()),ys(b.R,c,U("macros-extension-menu-promo"),void 0,void 0,Tds(3)),b.C.Cd(),b.F.Cd(),Kes(b.F,c)),Les(b));else{c=Zf(a.D);if(b.J){hg(c,b.Ka);f=new em;bhb(f,b.C.F);b.F.Cd();b.C.Cd();d=[];for(e=0;e<c.length;++e){k=c[e];var l=L9(k),m=!(!mk(k,10)&&!mk(k,9));d.push(l);h=f.get(l);var p=mk(k,19);if(h)l=h.Oc(),m&&!p&&(m=l.Ud(0),p="addon-menu-install-"+L9(k),m&&m.getId()==p&&(l.Xw(0).dispose(),2==l.Ad()&&(l.Ud(0),l.Xw(0).dispose())));else{h=new is("");
h.vd(l);h.Xa(2==b.V?!1:1==b.V?!!(k&&mk(k,10)&&mk(k,9)):!0);var r=new fs;m||p||Mes(b,r,k);Nes(b,r,l,[],k);h.Lh(r)}k=k.getName();m=Vm("span");m.appendChild(Wm(k));h.setContent(m);Kes(b.C,h)}for(e=0;e<b.X.length;++e)Kes(b.C,f.get(b.X[e]));if(b.O)for(f=f.Qi(),e=0;e<f.length;++e)if(0>d.indexOf(f[e])&&0>b.X.indexOf(f[e])&&(h=b.oa[f[e]])){for(k=0;k<h.length;++k)b.O.Yea(h[k]);delete b.oa[f[e]]}U("macros-manage-extensions").Xa(!!c.length);Les(b)}a.X&&a.X.C(!!a.D.length)}}
function Hes(a){var b=Fes(a.C);if(b){var c=Zf(a.D),d=a.H;b.C=[];for(var e=0;e<c.length;e++){var f=c[e];if(mk(f,12)||mk(f,4))nia(b.C,f,b.qcc),b.H&&!mk(f,12)&&(b.H=!1)}U("macros-addon-sidebar-focus").Xa(0<b.C.length);b.X=0==d;b.R=!0;b.O=1==b.C.length&&null!=Oes(b);b.Ic()&&Pes(b);a.ma&&a.ma.C(0<b.C.length)}}u.getExtension=function(a){return this.D.find(function(b){return Lds(a,b)})};function Qes(a,b){return a.D.find(function(c){return L9(c)===b})}
function Des(a){if(!a.J.getValue()&&(a.J.setValue(!0),Mf(a.D))){var b=a.C.R;if(b){var c=Rm("docs-menu-superscript",b.H.getElement());c&&WFb(c,0);b.F.Cd();Les(b);Ies(a)}}};function Res(a,b,c,d,e,f,h,k,l,m,p,r,t){this.H=a;this.R=b;this.O=c;this.X=d;this.V=e;this.va=h;this.D=k;this.C=l;this.J=m;this.ma=p;this.oa=r;this.F=t}function Ses(a,b){a=a.O;if(b){a=new lm(a);var c=a.F;c+=mg(c,"/")?"":"/";mg(c,"/start/")&&(c=c.replace("start/",""));c+=Qka("d/%s/edit",b);om(a,c);a=a.toString()}return a};function Tes(a){P(this,a,0,-1,null,null)}A(Tes,O);Tes.prototype.Aa=function(){var a=new K;Ues(this,a);return L(a)};function Ues(a,b){var c=Q(a,1);null!=c&&b.Ga(1,c);c=Q(a,2);null!=c&&b.Ga(2,c);c=Q(a,3);null!=c&&Qj(b,3,c);c=Q(a,4);null!=c&&b.Ga(4,c)};function Ves(a){P(this,a,0,-1,null,null)}A(Ves,O);Ves.prototype.Aa=function(){var a=new K;Wes(this,a);return L(a)};function Wes(a,b){var c=Q(a,1);null!=c&&b.Ga(1,c);c=Q(a,2);null!=c&&b.Ga(2,c);c=Q(a,3);null!=c&&b.Ga(3,c);c=Q(a,5);null!=c&&Rj(b,5,c);c=Q(a,6);null!=c&&Wj(b,6,c);c=T(a,Tes,7);null!=c&&b.xa(7,c,Ues);c=Q(a,8);null!=c&&Wj(b,8,c);c=Q(a,9);null!=c&&Rj(b,9,c);c=Q(a,10);null!=c&&Rj(b,10,c);c=Q(a,11);null!=c&&Rj(b,11,c)}Ves.prototype.Ij=function(){return Q(this,3)};function Xes(a){P(this,a,"paep",-1,null,null)}A(Xes,O);Xes.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ga(1,b);b=Q(this,2);null!=b&&a.Ga(2,b);b=T(this,Ves,3);null!=b&&a.xa(3,b,Wes);b=Q(this,4);null!=b&&N(a,4,b);return L(a)};Xes.messageId="paep";Xes.prototype.getUrl=function(){return Q(this,1)};Xes.prototype.Rj=function(){return Q(this,2)};function Yes(a){sm.call(this,"paep");this.C=new Xes(a)}z(Yes,Gds);Yes.prototype.lk=n("C");function Zes(a){P(this,a,0,-1,null,null)}A(Zes,O);Zes.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&Wj(a,1,b);b=Q(this,2);null!=b&&a.Ga(2,b);b=Q(this,3);null!=b&&N(a,3,b);b=Q(this,4);null!=b&&a.Ga(4,b);return L(a)};Zes.prototype.aq=function(){return Q(this,2)};function $es(a){P(this,a,"rfep",-1,null,null)}A($es,O);$es.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ga(1,b);b=Q(this,2);null!=b&&a.Ga(2,b);b=Q(this,4);null!=b&&a.Ga(4,b);b=Q(this,5);null!=b&&a.Ga(5,b);return L(a)};$es.messageId="rfep";$es.prototype.getFunctionName=function(){return Q(this,2)};$es.prototype.kB=function(){return Q(this,5)};function afs(a){sm.call(this,"rfep");this.C=new $es(a)}z(afs,Gds);afs.prototype.lk=n("C");function bfs(a){P(this,a,"sfep",-1,null,null)}A(bfs,O);bfs.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ga(1,b);b=Q(this,2);null!=b&&Wj(a,2,b);b=Q(this,3);null!=b&&a.Ga(3,b);return L(a)};bfs.messageId="sfep";bfs.prototype.SW=function(){return Q(this,2)};bfs.prototype.Rj=function(){return Q(this,3)};function cfs(a){sm.call(this,"sfep");this.C=new bfs(a)}z(cfs,Gds);cfs.prototype.lk=n("C");function dfs(a){P(this,a,"step",-1,null,null)}A(dfs,O);dfs.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ga(1,b);b=Q(this,2);null!=b&&N(a,2,b);return L(a)};dfs.messageId="step";dfs.prototype.uva=function(){return mk(this,2)};function efs(a){sm.call(this,"step");this.C=new dfs(a)}z(efs,Gds);efs.prototype.lk=n("C");function ffs(a){P(this,a,"scpep",-1,null,null)}A(ffs,O);ffs.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&N(a,1,b);return L(a)};ffs.messageId="scpep";function gfs(a){sm.call(this,"scpep");this.C=new ffs(a)}z(gfs,Gds);gfs.prototype.lk=n("C");function hfs(a){P(this,a,"saep",-1,null,null)}A(hfs,O);hfs.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ga(1,b);b=Q(this,2);null!=b&&a.Ga(2,b);b=Q(this,3);null!=b&&a.Ga(3,b);b=Q(this,4);null!=b&&a.Ma(4,b);b=Q(this,5);null!=b&&a.Ma(5,b);b=Q(this,6);null!=b&&Wj(a,6,b);b=Q(this,7);null!=b&&a.Ga(7,b);b=Q(this,8);null!=b&&N(a,8,b);b=T(this,tX,9);null!=b&&a.xa(9,b,W2j);return L(a)};hfs.messageId="saep";u=hfs.prototype;u.getTitle=function(){return Q(this,2)};
u.setTitle=function(a){return R(this,2,a)};u.zc=function(){return Q(this,4)};u.setWidth=function(a){return R(this,4,a)};u.Ec=function(){return Q(this,5)};u.setHeight=function(a){return R(this,5,a)};u.bE=function(){return kk(this,6)};function ifs(a){sm.call(this,"saep");this.C=new hfs(a)}z(ifs,Gds);ifs.prototype.lk=n("C");function jfs(a){P(this,a,"snep",-1,null,null)}A(jfs,O);jfs.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&Wj(a,1,b);b=Q(this,2);null!=b&&a.Ga(2,b);b=Q(this,3);null!=b&&a.Ga(3,b);b=Q(this,4);null!=b&&a.rb(4,b);return L(a)};jfs.messageId="snep";u=jfs.prototype;u.getType=function(){return nk(this,1,0)};u.qc=function(a){return R(this,1,a)};u.Gd=function(){uk(this,1)};u.yd=function(){return kk(this,1)};u.getText=function(){return Q(this,2)};u.Fk=function(){return kk(this,2)};
u.getTitle=function(){return Q(this,3)};u.setTitle=function(a){return R(this,3,a)};function kfs(a){sm.call(this,"snep");this.C=new jfs(a)}z(kfs,Gds);kfs.prototype.lk=n("C");function lfs(a){P(this,a,"spep",-1,mfs,null)}A(lfs,O);var mfs=[4];lfs.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ga(1,b);b=Q(this,2);null!=b&&a.Ga(2,b);b=Q(this,3);null!=b&&a.Ga(3,b);b=Q(this,4);0<b.length&&ak(a,4,b);b=Q(this,5);null!=b&&N(a,5,b);b=Q(this,6);null!=b&&N(a,6,b);b=Q(this,7);null!=b&&a.Ga(7,b);return L(a)};lfs.messageId="spep";lfs.prototype.getTitle=function(){return Q(this,2)};lfs.prototype.setTitle=function(a){return R(this,2,a)};
lfs.prototype.Fj=function(a,b){return Ck(this,4,a,b)};function nfs(a){sm.call(this,"spep");this.C=new lfs(a)}z(nfs,Gds);nfs.prototype.lk=n("C");function ofs(a){P(this,a,"stbep",-1,null,null)}A(ofs,O);ofs.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ga(1,b);b=Q(this,2);null!=b&&a.Ga(2,b);b=Q(this,3);null!=b&&a.Ga(3,b);b=Q(this,4);null!=b&&a.Ga(4,b);b=Q(this,5);null!=b&&a.Ga(5,b);b=Q(this,6);null!=b&&a.Ga(6,b);return L(a)};ofs.messageId="stbep";u=ofs.prototype;u.getFunctionName=function(){return Q(this,2)};u.Nl=function(){return Q(this,3)};u.ws=function(a){R(this,3,a)};u.getUrl=function(){return Q(this,5)};
u.kB=function(){return Q(this,6)};function pfs(a){sm.call(this,"stbep");this.C=new ofs(a)}z(pfs,Gds);pfs.prototype.lk=n("C");function qfs(a){P(this,a,"sttep",-1,null,null)}A(qfs,O);qfs.prototype.Aa=function(){var a=new K;var b=Q(this,1);null!=b&&a.Ga(1,b);b=Q(this,2);null!=b&&a.Ga(2,b);return L(a)};qfs.messageId="sttep";qfs.prototype.getText=function(){return Q(this,1)};qfs.prototype.Fk=function(){return kk(this,1)};qfs.prototype.Fs=function(){return Q(this,2)};qfs.prototype.Tg=function(a){R(this,2,a)};function rfs(a){sm.call(this,"sttep");this.C=new qfs(a)}z(rfs,Gds);rfs.prototype.lk=n("C");function sfs(){Cm.call(this);var a=this;this.C=null;this.D=function(b){switch(b[0]){case "amep":b=new Hds(b);a.dispatchEvent(b);break;case "paep":b=new Yes(b);a.dispatchEvent(b);break;case "rfep":b=new afs(b);a.dispatchEvent(b);break;case "sfep":b=new cfs(b);a.dispatchEvent(b);break;case "step":b=new efs(b);a.dispatchEvent(b);break;case "saep":b=new ifs(b);a.dispatchEvent(b);break;case "snep":b=new kfs(b);a.dispatchEvent(b);break;case "spep":b=new nfs(b);a.dispatchEvent(b);break;case "stbep":b=new pfs(b);
a.dispatchEvent(b);break;case "sttep":b=new rfs(b);a.dispatchEvent(b);break;case "scpep":b=new gfs(b),a.dispatchEvent(b)}}}z(sfs,Cm);sfs.prototype.bind=function(a){this.C=a;this.C.subscribe("13",this.D)};sfs.prototype.Va=function(){this.C&&this.C.unsubscribe("13",this.D);Cm.prototype.Va.call(this)};function tfs(a,b){Cm.call(this);this.D=new Gm(this);this.Ea(this.D);this.C={};this.F=a;this.H=b}z(tfs,Cm);u=tfs.prototype;u.start=function(){this.D.listen(this.H,"sfep",ua(this.BNb,this));this.D.listen(this.H,"step",ua(this.qVc,this))};function ufs(a,b,c,d){var e=void 0;e=void 0===e?pa:e;d=void 0===d?pa:d;d=ua(a.pVc,a,b,e,d);a=a.F;b=["ruid",ta({}),a.C.C,a.D,a.C.H,b,a.C.O,c];b=Ho(Ol(Jo(res(a,a.C.Ba),"POST"),2),b).fC();d&&(Ql(b,ua(a.sVc,a,d)),Pl(b,ua(a.PHc,a,d)));b.Ei()}
u.oVc=function(a,b,c,d,e,f){f.vB()?(a=Q(f,2),this.C[a]=new vfs(a,b,d,e),c(a,rk(f,3,!1))):(b=new bfs,R(b,2,6),e(b))};u.pVc=function(a,b,c,d){d.vB()?b():(c(),b=new bfs,R(b,1,a),R(b,2,6),this.BNb(new cfs(b.Pc())))};u.qVc=function(a){a=a.lk();var b=Q(a,1);if(Hg(this.C,b)){var c=Mia(this.C,b);(0,c.nVc)(a);c.dispose();Kg(this.C,b)}};u.BNb=function(a){a=a.lk();var b=Q(a,1);if(Hg(this.C,b)){var c=Mia(this.C,b);(0,c.Gcc)(a);c.dispose();Kg(this.C,b)}a="Google Apps Script: "+a.Rj();window.console.log(a)};
u.Va=function(){ji(this.C);Cm.prototype.Va.call(this)};function vfs(a,b,c,d){gi.call(this);this.C=b;this.nVc=c;this.Gcc=d}z(vfs,gi);vfs.prototype.getFunctionName=n("C");function wfs(a,b){var c=a.z4,d=a.id,e=a.oOc,f=a.WYa,h=a.i7b,k=a.Pia,l=a.i2a;return Fq('<div class="'+V(a.aH)+'" aria-labelledby="title'+V(d)+'" tabindex="0"'+(c?' role="complementary"':' role="region"')+'><div class="'+V(e)+'"><div class="'+V(f)+'" id="title'+V(d)+'"></div><div class="'+V(h)+'" tabindex="0" title="'+V("Close sidebar")+'" aria-label="'+V("Close sidebar")+'" role="button">'+Et({icon:l},b)+'</div></div><div class="'+V(k)+'"></div></div>')}
function xfs(a){a=a.caption;return Fq('<div class="'+V("docs-script-button-bar-text")+" "+V("docs-titlebar-button")+" "+V("goog-inline-block")+'" tabindex="0">'+Eq(a)+"</div>")}function yfs(a){a=a.text;return Fq('<div class="'+V("docs-script-button-bar-bubble-content")+'">'+Eq(a)+"</div>")}
function zfs(a){var b=a.iconName,c=a.title;a=a.description;return Fq('<div class="'+V("script-promo-menu-item-content")+'"><div class="'+V("script-promo-menu-item-icon")+'" aria-hidden="true"><img src="//ssl.gstatic.com/docs/common/'+V(b)+'.svg"/></div><div class="'+V("script-promo-menu-item-text")+'"><div class="'+V("script-promo-menu-item-title")+'">'+Eq(c)+'</div><div class="'+V("script-promo-menu-item-description")+'">'+Eq(a)+"</div></div></div>")}
function Afs(a){var b=a.functionName;a=a.Xlb;return Fq('<div class="'+V("func-entry")+'" aria-checked="false" role="radio" tabindex="-1"><div class="'+V("goog-inline-block")+" "+V("func-entry-rb")+'">&nbsp;</div><div class="'+V("goog-inline-block")+" "+V("func-entry-func")+'">'+Eq(b)+'</div><div class="'+V("goog-inline-block")+" "+V("func-entry-lib")+'">'+Eq(a)+"</div></div>")}
function Bfs(a){var b=a.ids,c=a.description;a=a.OPc;var d='<div class="'+V("script-help-dialog-content")+'"><div class="'+V("script-help-dialog-content-left")+" "+V("goog-inline-block")+(a?" "+V("script-help-dialog-content-left-gsm-onhold")+" ":"")+'">';a?(c=d,a='<div class="'+V("script-help-dialog-content-section")+" "+V("script-help-dialog-content-section-gsm-onhold")+'" tabindex="0"><div class="'+V("script-help-dialog-content-title")+'">',d=d={wIa:"script-help-dialog-content-title-caution-icon"},
d=d.wIa,d=Fq("<div"+(d?' class="'+V(d)+'"':"")+'><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11,15 L13,15 L13,17 L11,17 L11,15 Z M11,7 L13,7 L13,13 L11,13 L11,7 Z M11.99,2 C6.47,2 2,6.48 2,12 C2,17.52 6.47,22 11.99,22 C17.52,22 22,17.52 22,12 C22,6.48 17.52,2 11.99,2 Z M12,20 C7.58,20 4,16.42 4,12 C4,7.58 7.58,4 12,4 C16.42,4 20,7.58 20,12 C20,16.42 16.42,20 12,20 Z" id="path-1"></path></defs><g id="caution" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="alert/error_outline_24px"><mask id="mask-2" fill="white"><use xlink:href="#path-1"></use></mask><g id="ic_error_outline_24px" fill-rule="nonzero"></g><g id="_c/Red/600" mask="url(#mask-2)" fill="#D93025" fill-rule="evenodd"><rect id="swatch" x="0" y="0" width="24" height="24"></rect></g></g></g></svg></div>'),
d=c+(a+d+"<span>Add-on not available in \r\n G Suite Marketplace</span></div><div>The developer of this add-on has not accepted the terms and conditions of G Suite Marketplace.</div></div>")):(d+='<div class="'+V("script-help-dialog-content-section")+'" tabindex="0"><div class="'+V("script-help-dialog-content-title")+'">',d=d+"Getting started</div><div>"+(Eq(c)+"</div></div>"));d+='</div><div id="'+V(b.lHa)+'" class="'+V("script-help-dialog-buttons")+" "+V("goog-inline-block")+'"></div></div>';return Fq(d)}
function Cfs(a){var b=a.pcc;a='<p class="'+V("script-reportissue-dialog-description-label")+'" tabindex="0">';var c="Describe the issue for the creators of <strong>"+(Eq(b)+"</strong>:");a=a+c+('</p><textarea class="'+V("jfk-textinput")+" "+V("script-reportissue-dialog-description")+'"></textarea><p class="'+V("script-reportissue-dialog-disclaimer")+'" tabindex="0">');a=a+'Only this description will be sent, no information from your open document.</p><div class="'+(V("script-reportissue-dialog-nonanonymous")+
'" tabindex="0"><div class="'+V("script-reportissue-dialog-nonanonymous-control")+" "+V("goog-inline-block")+'"><div class="'+V("script-reportissue-dialog-nonanonymous-checkbox")+" "+V("jfk-checkbox")+'"></div></div><div class="'+V("script-reportissue-dialog-nonanonymous-label")+" "+V("goog-inline-block")+'"><div class="'+V("script-reportissue-dialog-nonanonymous-optional-text")+" "+V("goog-inline-block")+'">');a+="(Optional)</div> ";b="Include your name and email address so the creators of <strong>"+
(Eq(b)+" </strong>can follow up.");a=a+b+"</div></div>";return Fq(a)}
function Dfs(a,b){a=a||{};a=a.xd;var c='<div class="'+V("func-actions")+'">';c+=Gs({id:"func-action-new",content:Lq("New"),style:0},b);c+=Gs({id:"func-action-run",content:Lq("Run"),style:0,Oe:"jfk-button-collapse-right"},b);c+=Gs({id:"func-action-edit",content:Lq("Edit"),style:0,Oe:"jfk-button-collapse-left"},b);c+=Gs({id:"func-action-reload",content:Lq(""+Et({icon:a?"docs-icon-img docs-icon-reload-rtl":"docs-icon-img docs-icon-reload"},b)),style:0,width:1,title:"Reload"},b);c+='</div><div class="'+
V("func-header")+'"><div class="'+V("func-header-rb")+" "+V("goog-inline-block")+'"></div><div class="'+V("func-header-func")+" "+V("goog-inline-block")+'">';c=c+'Function</div><div class="'+(V("func-header-lib")+" "+V("goog-inline-block")+'">');c=c+'Script</div></div><div class="'+(V("func-entries")+'" role="radiogroup" tabindex="0"></div>');return Fq(c)}function Efs(){var a='<div class="'+V("func-loading")+'">';return Fq(a+"Fetching scripts\u2026</div>")}
function Ffs(){var a='<div class="'+V("func-none")+'">';return Fq(a+"No scripts found</div>")};function Gfs(){}z(Gfs,Lr);Gfs.prototype.Bd=q("func-entry");Gfs.prototype.Tl=q(!1);Gfs.prototype.Ha=function(a){return Dq(Afs,{functionName:a.getFunctionName(),Xlb:a.RQc},void 0,a.Da())};qa(Gfs);function Hfs(a,b,c,d,e,f){Or.call(this,null,d||Gfs.sb(),e);this.VHb=a;this.C=void 0!==f?f:null;this.RQc=b;this.D=c;this.ck(16,!0);this.ck(32,!0);Qr(this,16,!0);Pr(this,16,!1)}z(Hfs,Or);Hfs.prototype.$z=function(a){Or.prototype.$z.call(this,a);a&&this.getElement()&&this.getElement().focus()};Hfs.prototype.kB=n("C");Hfs.prototype.getFunctionName=n("D");Hfs.prototype.Id=function(a){Or.prototype.Id.call(this,a);this.Zc(a);this.getElement()&&gn(this.getElement(),a)};function Ifs(a,b){wt.call(this,void 0,void 0,a);this.R=b||!1;this.pE=new KLb;this.Ea(this.pE);this.Bh=new Ir;this.Ea(this.Bh);this.H=new Hs("");this.Ea(this.H);this.C=new Hs("");this.Ea(this.C);this.F=new Hs("");this.Ea(this.F);this.O=new Hs("");this.Ea(this.O);a=new sr(a);a.set("close","Close",!1,!0);rr(this,!1);ur(this,a);this.setTitle("Script manager")}z(Ifs,wt);u=Ifs.prototype;
u.reset=function(a){this.pE.clear();this.jf(!0);0===a?(a=Dq(Efs,{},void 0,this.Da()),a=new Or(a),a.ck(32,!1),this.Na(a,!0)):1===a&&(a=Dq(Ffs,{},void 0,this.Da()),a=new Or(a),a.ck(32,!1),this.Na(a,!0))};u.focus=function(){if(this.Ic()&&0<this.pE.xn()){var a=this.pE.gj();a&&a.$z(!0)}else wt.prototype.focus.call(this)};u.jf=function(a){a=wt.prototype.jf.call(this,a);this.pE.clear();Jfs(this);return a};
u.zj=function(a,b,c){wt.prototype.zj.call(this,a,b,c);a instanceof Hfs&&(b=a.Me(),this.pE.He(a),1==this.pE.xn()||b)&&(NLb(this.pE,a),a.$z(!0));Jfs(this)};u.Ha=function(){wt.prototype.Ha.call(this);var a=this.Mc();$q(a,"script-explorer-contents");Bq(a,Dfs,{xd:this.R});a=bn(pkb(a));this.H.yb(a[0]);this.F.yb(a[1]);this.C.yb(a[2]);this.O.yb(a[3]);zr(this,"run")};
u.Oa=function(){wt.prototype.Oa.call(this);Jr(this.Bh,this.Mc());Jfs(this);this.addEventListener("dialogselect",Vg(!0));wm(this,"action",this.EDb,void 0,this);wm(this.Bh,"key",this.iEb,void 0,this);var a=new UIb("new",this.H.getContent());wm(this.H,"action",ua(this.dispatchEvent,this,a));a=new UIb("run",this.F.getContent());wm(this.F,"action",ua(this.dispatchEvent,this,a));a=new UIb("edit",this.C.getContent());wm(this.C,"action",ua(this.dispatchEvent,this,a));a=new UIb("reload",this.O.getContent());
wm(this.O,"action",ua(this.dispatchEvent,this,a))};u.ag=function(){wt.prototype.ag.call(this);PJb(this.Bh);zm(this,"action",this.EDb,void 0,this);zm(this.Bh,"key",this.iEb,void 0,this);Bm(this.H);Bm(this.F);Bm(this.C);Bm(this.O)};u.Mc=function(){var a=wt.prototype.Mc.call(this),b=bn(a);return 0<b.length?b[2]:a};u.EDb=function(a){Jfs(this);a.target instanceof Hfs&&(NLb(this.pE,a.target),a.target.$z(!0))};
u.iEb=function(a){var b=this.pE.xn();if(0<b)switch(a.keyCode){case 38:var c=this.pE;b=Rgb(this.pE.Zn()-1,b);NLb(c,c.Rk(b));a.preventDefault();this.focus();break;case 40:c=this.pE,b=Rgb(this.pE.Zn()+1,b),NLb(c,c.Rk(b)),a.preventDefault(),this.focus()}};function Jfs(a){var b=!!a.pE.gj();a.F.setVisible(b);a.C.setVisible(b)};function Kfs(a,b){this.D=a;this.C=b}function Lfs(a){a.D.V&&wes(a.C,function(){if(U("macros-extensions").isEnabled()){a.D.va&&!a.D.C&&a.C.jha();var b=a.D.ma;if(b&&(b=a.C.getExtension(new Kds(b))||Qes(a.C,b))){var c=a.C,d=c.C.R;d&&(Ees(c.C),c=ua(c.C.d7,c.C),Mfs(d,L9(b),c))}}})};function Nfs(){gi.call(this);this.F=new em}z(Nfs,Ss);Nfs.prototype.C=function(){return this.F.Fg()};function Kes(a,b){a.F.set(b.getId(),b)}Nfs.prototype.Cd=function(){this.F.clear()};function Jes(a,b){rq.call(this,b);this.C=a}z(Jes,rq);
Jes.prototype.Ha=function(){rq.prototype.Ha.call(this);var a=this.C==(Is(),XNb)?"Do more with Docs":this.C==(Is(),aOb)?"Do more with Forms":this.C==(Is(),YNb)?"Do more with Sheets":this.C==(Is(),ZNb)?"Do more with Slides":"Do more with Docs",b=this.C==(Is(),XNb)?"Looking for even more Docs features? Get a few add-ons.":this.C==(Is(),aOb)?"Looking for even more Forms features? Get a few add-ons.":this.C==(Is(),YNb)?"Looking for even more Sheets features? Get a few add-ons.":this.C==(Is(),ZNb)?"Looking for even more Slides features? Get a few add-ons.":
"Looking for even more Docs features? Get a few add-ons.",c=this.C==(Is(),XNb)?"addon_docs_promo":this.C==(Is(),aOb)?"addon_forms_promo":this.C==(Is(),YNb)?"addon_sheets_promo":this.C==(Is(),ZNb)?"addon_slides_promo":"addon_docs_promo",d=this.Da();this.ke(Dq(zfs,{title:a,description:b,iconName:c},void 0,d))};function Ofs(){}z(Ofs,Zr);Ofs.prototype.Ha=function(a){a=Zr.prototype.Ha.call(this,a);Uq(a,"menuitem");return a};Ofs.prototype.Bd=q("goog-control");Ofs.prototype.iy=function(a){a=Zr.prototype.iy.call(this,a);a.push("menu-button","goog-inline-block");return a};qa(Ofs);function Pfs(a,b,c,d,e){gi.call(this);this.R=b;this.V=c;this.H=a;this.D={};this.va={};this.oa={};this.ma=[];this.X=[];this.J=d||null;this.O=e||null;this.C=new Nfs;this.F=new Nfs;this.Fa=new Gm;this.Ea(this.Fa);this.Ba=[]}z(Pfs,gi);Pfs.prototype.Va=function(){ji(this.D);gi.prototype.Va.call(this)};Pfs.prototype.cE=function(a){return Hg(this.D,a)};
function Qfs(a,b,c){c=c?[c]:Bg(a.D);for(var d=0;d<c.length;d++)for(var e=c[d].Oc(),f=0;f<e.Ad();f++){var h=e.Ud(f);if(h instanceof bs&&h.getId()==b||h instanceof is&&(h=Qfs(a,b,h)))return h}return null}
function Rfs(a,b,c,d,e){if(Q(b,3)){var f=mk(b,7)||!1,h=b.Nl(),k=Q(b,10),l=new bs("");l.vd(b.Xh()||String(ta(l)));var m=[Wm(h)];d&&b.getKey()&&(d+=b.getKey().toUpperCase(),d=FMb(l,U("macros-exec"),[d]),a.ma.push(d),m.push(d));l.setContent(m);b=new Bds(Q(b,4),Q(b,3),void 0,Q(b,9)||void 0,void 0,b.kB()||void 0);ys(a.R,l,U("macros-exec"),null,Vg(b),Tds(3,e));l.Xa(f);a.O&&f&&k&&(e=h+(" ("+(k+")")),c.push(a.O.bD(U("macros-exec"),[b],Vg(e),Vg(e))[0]));return l}if(!b.Nl())return new es;if(0<b.Cm().length){l=
new fs;f=b.Cm();for(h=0;h<f.length;h++)l.Na(Rfs(a,f[h],c,d,e),!0);a=new is(b.Nl());a.vd(b.Xh()||String(ta(a)));a.Lh(l);return a}throw Error("Unsupported menu item type.");}Pfs.prototype.Ka=function(a,b){return ng(a.getName(),b.getName())};function Nes(a,b,c,d,e){if(b.ONa()){var f=new Cds,h=String(ta(f));R(f,1,h);b.Na(Rfs(a,f,d),!0)}d=new bs("Help");d.vd(String(ta(d)));ys(a.R,d,U("macros-extension-help"),null,Vg(c),Tds(3,e));d.Xa(!0);b.Na(d,!0)}
function Mes(a,b,c){var d=new bs("");d.vd("addon-menu-install-"+L9(c));ys(a.R,d,U("macros-extension-install-start"),LMb,Vg(L9(c)),Tds(3,c));d.Xa(!0);b.Na(d,!0)}function Les(a){pRb(a.J,"docs-macros-extension-promo")||Ys(a.J,"docs-macros-extension-promo",[a.F,null]);pRb(a.J,"docs-macros-extensions")||Ys(a.J,"docs-macros-extensions",[a.C]);a.J.Oc("docs-extensions-menu",!0);cu()&&a.J.Oc("macros-extension-add-ons-menu",!0)}
function Mfs(a,b,c){var d=c||pa;(c=a.C.F.get(b))?-1===a.Ba.indexOf(b)?(b=Xn(ua(function(e){e.dispatchEvent("load")},a,c),1E4),b=ua(function(e,f,h){this.H.gCa("docs-extensions-menu");e.Wk(!0);e.d_();Yn(h);f()},a,c,d,b),a.Fa.qe(c,"load",b)):(a.H.gCa("docs-extensions-menu"),c.Y_(),c.Wk(!0),c.d_(),d()):d()};function Sfs(a,b){var c=a.i2a,d=a.z4;a='<div class="'+V(a.aH)+'" aria-labelledby="addon-sidebar-title" tabindex="0"'+(d?' role="complementary"':' role="region"')+'><div class="'+V("addon-sidebar-header")+'"><div class="'+V("addon-sidebar-title")+'" id="addon-sidebar-title">';a+="Document add-ons";c=Lq(""+Et({icon:c},b));a+="</div>"+Gs({Oe:"addon-sidebar-close docs-material",content:c,style:4,title:"Close sidebar"},b)+'</div><div class="'+V("addon-sidebar-content")+'"><div class="'+V("addon-sidebar-banner")+
'"></div><div class="'+V("addon-sidebar-introduction")+'"></div></div><div class="'+V("addon-sidebar-empty-caption")+'"><div class="'+V("addon-sidebar-empty-title")+'">';a=a+'No document add-ons</div><div class="'+(V("addon-sidebar-empty-description")+'">');return Fq(a+"This document doesn't include any add-ons</div></div></div>")}
function Tfs(a){var b=a.v5b;a=a.s5b;return Fq('<img class="'+V("addon-sidebar-banner-image")+'" src='+Oyk(Pq(b))+" alt="+Oyk(a)+' /><div class="'+V("addon-sidebar-banner-image-overlay")+'"></div>')};function Ufs(a){var b=a.icon,c=a.title,d=a.category,e=a.summary,f=a.isInstalled,h=a.Qnd;a=Fq;b='<div class="'+V("addon-sidebar-card")+'" aria-label="'+V(c)+'" tabindex="0" role="region"><div class="'+V("addon-sidebar-card-header")+'"><div class="'+V("addon-sidebar-card-icon")+'">'+(b?'<img class="'+V("addon-sidebar-card-icon-image")+'" src='+Oyk(Pq(b))+" alt="+Oyk(c)+" />":"")+'</div><div class="'+V("addon-sidebar-card-header-content")+'"><div class="'+V("addon-sidebar-card-title")+'"><div class="'+
V("addon-sidebar-card-title-caption")+(h?" "+V("addon-sidebar-card-two-line-title-caption"):"")+'">'+Eq(c)+"</div>";f?(c=c={wIa:"addon-sidebar-card-check",color:"#455A64"},f=c.wIa,c=c.color,f=Fq("<div"+(f?' class="'+V(f)+'"':"")+'><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 48 48" fill="'+V(null!=c?c:"#000")+'"><path d="M0 0h48v48H0z" fill="none"/><path d="M24 4C12.95 4 4 12.95 4 24c0 11.04 8.95 20 20 20 11.04 0 20-8.96 20-20 0-11.05-8.96-20-20-20zm-4 30L10 24l2.83-2.83L20 28.34l15.17-15.17L38 16 20 34z"/></svg></div>')):
f="";return a(b+f+'</div><div class="'+V("addon-sidebar-card-category")+'">'+Eq(d)+"</div></div></div>"+(e?'<div class="'+V("addon-sidebar-card-summary")+'">'+Eq(e)+"</div>":"")+"</div>")};function Vfs(){}z(Vfs,Av);Vfs.prototype.Bd=q("docs-material-menu-button-flat-primary");Vfs.prototype.Sx=function(){return Dq(Kld,{className:"docs-material-menu-button-flat-primary-dropdown"})};qa(Vfs);function Wfs(a,b,c,d,e){c=void 0===c?Vfs.sb():c;js.call(this,a,b,c,d,e)}z(Wfs,js);function Xfs(){}z(Xfs,Av);Xfs.prototype.Bd=q("docs-material-menu-button-raised-primary");Xfs.prototype.Sx=function(){return Dq(Kld,{className:"docs-material-menu-button-raised-primary-dropdown"})};qa(Xfs);function Yfs(a,b,c,d,e){c=void 0===c?Xfs.sb():c;js.call(this,a,b,c,d,e)}z(Yfs,js);function Zfs(a,b,c,d,e){gi.call(this);this.D=a;this.C=b;this.F=c;this.H=d;this.Ib=e||Lm()}z(Zfs,gi);
function $fs(a,b){if(!b)return ags(a);b=b.Cm();if(1==b.length&&Q(b[0],3)){var c=ags(a);b=b[0];c.Xa(!!mk(b,7));b=new Bds(Q(b,4),Q(b,3),void 0,Q(b,9)||void 0);ys(a.D,c,U("macros-exec"),{enabled:!0},Vg(b),a.F);return c}c=new fs(a.Ib);for(var d=0;d<b.length;d++)c.Na(bgs(a,b[d]),!0);b=[Wm("Use")];a=a.C?new Yfs(b,c,void 0,a.Ib):new Wfs(b,c,void 0,a.Ib);a.Fh("Use");a.Ed("addon-sidebar-card-menu-button");a.Xa(!0);return a}
function bgs(a,b){if(Q(b,3)){var c=b.Nl(),d=new bs("");d.Ed(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");d.setContent([Wm(c)]);c=new Bds(Q(b,4),Q(b,3),void 0,Q(b,9)||void 0);ys(a.D,d,U("macros-exec"),{enabled:!0},Vg(c),a.F);d.Xa(!!mk(b,7));return d}if(!b.Nl())return new es;if(0<b.Cm().length){d=new fs(a.Ib);c=b.Cm();for(var e=0;e<c.length;e++)d.Na(bgs(a,c[e]),!0);b=new is(b.Nl());b.Ed(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");
b.Lh(d);return b}throw Error("Unsupported menu item type.");}function ags(a){var b=[Wm("Use")];a=a.C?new C5k(b,a.Ib):new $te(b,a.Ib);a.Fh("Use");a.Ed("addon-sidebar-card-button");a.Xa(!1);return a};function cgs(a,b,c,d,e){rq.call(this,e);this.C=a;this.ma=b;this.V=mk(this.C,19)||!1;this.H=!(!mk(this.C,10)&&!mk(this.C,9));this.O=new xs(void 0,void 0,!0,Pt.sb());this.Ea(this.O);this.X=Tds(10,this.C);this.J=new Or(void 0,void 0,e);this.Ea(this.J);this.F=new Zfs(this.O,c,this.X,d,e);this.Ea(this.F);if(this.H)a=$fs(this.F);else{a=this.F;b=this.C;a:switch(a.H){case Is(),XNb:c="Add to Docs";break a;case Is(),ZNb:c="Add to Slides";break a;case Is(),YNb:c="Add to Sheets";break a;default:throw Error("Unsupported document type");
}d=[Wm(c)];d=a.C?new C5k(d,a.Ib):new $te(d,a.Ib);d.Fh(c);d.Ed("addon-sidebar-card-button");d.Xa(!1);ys(a.D,d,U("macros-extension-install-start"),{enabled:!0},Vg(L9(b)),a.F);a=d}this.D=a;a=this.F;b=this.C;c=new $te([Wm("Help")],a.Ib);c.Fh("Help");c.Ed("addon-sidebar-card-button");c.Xa(!1);c.Tg("Help");ys(a.D,c,U("macros-extension-help"),{enabled:!0},Vg(L9(b)),a.F);this.R=c}z(cgs,rq);
cgs.prototype.Ha=function(){rq.prototype.Ha.call(this);var a=Q(this.C,15)||"";a&&(a=mm(new lm(a),"https").toString());var b=this.Da();a={icon:a,title:this.C.getName(),category:this.C.Gq(),isInstalled:this.H,summary:Q(this.C,14),Qnd:Oh};b=Dq(Ufs,a,void 0,b);this.Qb(b);this.ke(b)};cgs.prototype.ke=function(a){rq.prototype.ke.call(this,a);a=this.Ia("addon-sidebar-card-title-caption");Uq(a,"button");this.Na(this.J);this.J.yb(a)};
cgs.prototype.Oa=function(){rq.prototype.Oa.call(this);ys(this.O,this.J,U("macros-manage-extensions"),{},Vg(Mds(this.C)),this.X);dgs(this);!this.H&&this.V&&(this.Na(this.R,!0),this.R.Xa(!0))};cgs.prototype.Va=function(){ii(this.D);ii(this.R);rq.prototype.Va.call(this)};function egs(a,b){a.H&&(a.D.getParent()==a&&a.removeChild(a.D,!0),ii(a.D),a.D=$fs(a.F,b),a.Ic()&&dgs(a))}
function dgs(a){a.Na(a.D,!0);a.H||(a.D.Xa(a.ma&&!a.V),a.ma?a.V&&a.D.Tg("Add-on not available in G Suite Marketplace"):a.D.Tg("Disabled for your organization"))};function fgs(a,b,c){pX.call(this,c);this.D={};this.C=[];this.X=!1;this.H=a;this.ma=b;this.J={};this.F=new Agd(this.Da(),"addon-sidebar-spinner");this.Na(this.F);this.V=new Hs(void 0,this.Da());this.O=this.R=!1}z(fgs,pX);u=fgs.prototype;u.Ha=function(){pX.prototype.Ha.call(this);var a={aH:"addon-sidebar",i2a:hp("close-white"),z4:of(pf(),"docs-eal")};a=Dq(Sfs,a,void 0,this.Da());this.Qb(a);this.ke(a)};
u.ke=function(a){pX.prototype.ke.call(this,a);this.F.render(this.Mc());a=this.F.Sa();Xq(a,"Loading");Uq(a,"status");Vq(a,"live","polite")};u.Oa=function(){pX.prototype.Oa.call(this);ggs(this,!1);hgs(this,!1);this.V.yb(this.Ia("addon-sidebar-close"));this.getHandler().ij(this.V.Sa(),ym,ua(this.CNb,this)).listen(this.getElement(),"keyup",this.yKc);this.R&&Pes(this)};u.Mc=function(){return this.Eb("addon-sidebar-content")};
function Pes(a){a.F.setVisible(!1);hgs(a,a.H);ggs(a,0==a.C.length);igs(a,a.O);jgs(a);Bf(a.C,function(b){var c=L9(b);b=new cgs(b,this.X,this.O,this.ma,this.Da());egs(b,this.J[c]);this.Na(b,!0);this.D[c]=b},a)}function jgs(a){xg(a.D,function(b){this.removeChild(b,!0);ii(b)},a);Lia(a.D)}function ggs(a,b){if(a.Ic()){var c=a.Ia("addon-sidebar-empty-caption");lq(c,b)}b&&hgs(a,!1)}
function hgs(a,b){if(a.Ic()){var c=a.Ia("addon-sidebar-introduction");b&&!hn(c)&&fn(c,1<a.C.length?"This template is optimized to work with these add-ons":"This template is optimized to work with this add-on");lq(c,b)}}function Oes(a){return 0==a.C.length?null:(a=Q(a.C[0],16)||Q(a.C[0],17))?mm(new lm(a),"https").toString():null}
function igs(a,b){if(a.Ic()){dr(a.getElement(),"addon-sidebar-with-banner",b);var c=a.Ia("addon-sidebar-banner");b?(b=Oes(a))&&Bq(c,Tfs,{v5b:b,s5b:a.C[0].getName()}):$m(c)}}u.qcc=function(a,b){return ng(a.getName(),b.getName())};u.yKc=function(a){27==a.keyCode&&(this.getElement()==a.target&&this.CNb(),a.stopPropagation())};u.CNb=function(){this.setVisible(!1);hgs(this,!1);this.H=!1;U("docs-focus-editor").hc()};u.Tl=q(!1);function kgs(a,b){rX.call(this,a,b)}z(kgs,rX);kgs.prototype.ux=function(){return U("macros-addon-sidebar-focus")};kgs.prototype.Yj=function(){return U("macros-addon-sidebar")};kgs.prototype.aD=function(a){var b=this.Hd;b.Ic()||b.render();rX.prototype.aD.call(this,a)};kgs.prototype.bYb=function(a){a&&this.Yj().isVisible()&&this.aD(!0)};function lgs(a,b,c){this.F=a;this.D=b;this.C=c;Object.defineProperties(this,{path:{get:ua(this.dVc,this),set:ua(this.pjd,this)},invoke:{get:ua(this.Tic,this),set:ua(this.fjd,this)},arity:{get:ua(this.Jdc,this),set:ua(this.Kid,this)}})}u=lgs.prototype;u.dVc=n("F");u.pjd=ba("F");u.Tic=n("D");u.fjd=ba("D");u.Jdc=n("C");u.Kid=ba("C");function mgs(a,b,c,d,e){rq.call(this,e);this.O=a;this.H=b;this.F=c;this.C=d}z(mgs,rq);
mgs.prototype.Ha=function(){var a=wf(pf(),"docs-tfh"),b=this.O;a&&(b=Hja(b,{allow_parent:a}));a=tIb(this.Da());qh(a,b);a.width="100%";a.height="100%";a.marginWidth="0";a.marginHeight="0";a.scrolling="no";a.allow="accelerometer ambient-light-sensor autoplay camera encrypted-media fullscreen geolocation gyroscope magnetometer microphone midi payment picture-in-picture speaker usb vr".split(" ").map(function(c){return c+" *;"}).join(" ");this.Qb(a);na("payload",this.H,a);na("adapter.hostFunctions",this.F,
a);Raa("adapter.getSessionId",ua(this.D,this),a);Raa("adapter.getState",ua(this.J,this),a)};mgs.prototype.Tl=q(!1);mgs.prototype.D=function(){var a=this.C().C;return null!==a?String(a):null};mgs.prototype.J=function(){return this.C().getState()};function ngs(a,b,c,d,e,f,h,k,l){wt.call(this,void 0,void 0,l);var m=ua(this.setVisible,this,!1),p=ua(this.H,this),r=ua(this.F,this);e&&this.setTitle(e);this.Dl=f||500;this.Mi=h||300;this.C=new mgs(a,b,[new lgs("google.script.host.close",m,0),new lgs("google.script.host.closeDialog",m,0),new lgs("google.script.host.editor.focus",ua(d.Rc,d,3),0),new lgs("google.script.host.setWidth",p,1),new lgs("google.script.host.setHeight",r,1)],c,l);this.Na(this.C);rr(this,!!k);ur(this,null)}z(ngs,wt);
ngs.prototype.H=function(a){!isFinite(a)||0>a||cq(this.Mc(),Math.min(a,Math.floor(.8*Sm().width)))};ngs.prototype.F=function(a){!isFinite(a)||0>a||dq(this.Mc(),Math.min(a,Math.floor(.8*Sm().height)))};ngs.prototype.Ha=function(){wt.prototype.Ha.call(this);$q(this.getElement(),"script-app-dialog");var a=this.Mc();$q(a,"script-app-contents");cq(a,Math.min(this.Dl,Math.floor(.8*Sm().width)));dq(a,Math.min(this.Mi,Math.floor(.8*Sm().height)));this.C.render(a)};ngs.prototype.Tl=q(!1);function ogs(a){pX.call(this,a);this.C=this.F=this.D=this.H=null}z(ogs,pX);u=ogs.prototype;u.wTa=function(){this.C&&(this.removeChild(this.C,!0),this.C.dispose(),this.C=null);this.setVisible(!1)};u.focus=function(){this.C.getElement().focus()};u.Mc=n("F");
u.Ha=function(){var a=this.Da(),b={id:this.getId(),aH:"script-application-sidebar",oOc:"script-application-sidebar-header",WYa:"script-application-sidebar-title",i7b:"script-application-sidebar-close",Pia:"script-application-sidebar-content",i2a:hp("close-white"),z4:of(pf(),"docs-eal")};b=Dq(wfs,b,void 0,a);this.Qb(b);this.H=a.Eb("script-application-sidebar-title",b);this.D=a.Eb("script-application-sidebar-close",b);this.F=a.Eb("script-application-sidebar-content",b)};
u.Oa=function(){pX.prototype.Oa.call(this);this.getHandler().ij(this.D,ym,ua(this.wTa,this))};u.Tl=q(!1);u.Va=function(){delete this.H;delete this.D;delete this.F;delete this.C;pX.prototype.Va.call(this)};function pgs(a,b){rX.call(this,a,b)}z(pgs,rX);pgs.prototype.ux=function(){return U("macros-application-focus")};pgs.prototype.Yj=function(){return U("macros-application-sidebar")};function qgs(a,b){var c=null;c=c||yq("",{target:"_blank",height:500,width:600,top:(screen.height-500)/2,left:(screen.width-600)/2,scrollbars:!0});uh(c.location,a);b!=pa&&(a=new ged(function(){return c?c.closed:!0}),a.ZK=b,a.start(100,-1))};function rgs(a,b,c,d,e){wt.call(this,void 0,!0,c);this.H=a;this.F=d||pa;pr(this,b);this.setVisible(!0);this.Qp=!0;tr(this,!1);ur(this,(new sr).Fj(aJb,!0).Fj(wr,!1,!0));this.setTitle(e||"Authorization Required");zr(this,aJb.key)}z(rgs,wt);rgs.prototype.Oa=function(){wt.prototype.Oa.call(this);this.addEventListener("dialogselect",this.C)};rgs.prototype.ag=function(){wt.prototype.ag.call(this);this.removeEventListener("dialogselect",this.C)};
rgs.prototype.C=function(a){"cancel"!=a.key?qgs(this.H,this.F):this.F();this.setVisible(!1)};function sgs(a){wt.call(this,void 0,void 0,void 0);this.F=a;this.C=null;this.Qp=!0;this.setTitle("Message details");ur(this,bJb())}z(sgs,wt);sgs.prototype.Ha=function(){wt.prototype.Ha.call(this);var a=this.Mc();$q(a,"script-error-dialog-content");this.C=Wm(this.F);a.appendChild(this.C)};sgs.prototype.Va=function(){wt.prototype.Va.call(this);this.C&&an(this.C)};function tgs(a){gi.call(this);this.C=a}z(tgs,gi);function ugs(a,b){var c=rg("Running script ");c=Um("SPAN",null,c);b=b?Ms(c,"Cancel",b,"info",!0):Ls(c,"info",!0);a.C.postMessage(b);return b.getId()}function vgs(a,b,c){var d=(c=void 0===c?null:c)?c:"Script "+(yh(b)+" experienced an error");b=Um("SPAN","script-error-message",d);b.style.maxWidth="600px";a.C.postMessage(Ms([b],"Details",function(){(new sgs(d)).setVisible(!0)},"warning",!0))}tgs.prototype.Va=function(){delete this.C};function wgs(){gi.call(this);this.C=null;this.D=new Gm;this.Ea(this.D)}z(wgs,gi);wgs.prototype.Va=function(){xgs();ygs(this);gi.prototype.Va.call(this)};function ygs(a){a.D.Cd();a.C&&(a.C.dispose(),a.C=null);xgs()}function xgs(){var a=Om("docs-script-button-bar");a&&$m(a)};var zgs=new rJc(["http","https"]);function Ags(a){a=Dh(a);if(qg(a)||sg(a,'"'))return null;var b=mhb(1,a);return b?zgs.contains(b.toLowerCase())?a:null:null};function Bgs(a,b,c,d,e,f,h){h=void 0===h?!1:h;wt.call(this);this.Cp=qg(Dh(b))?"You can find "+(a+" in the Add-ons menu."):b;this.ma=c;this.Ba=d;this.H=Ags(e);this.X=Ags(f);this.O=h;this.V=rGb(this,Cgs);this.C=RZj("Learn more");this.Na(this.C);this.F=new Hs("Report an issue");this.Na(this.F);this.R=new Hs("View in store");this.Na(this.R);this.setTitle(rg("Help for "+a));a=new sr;a.Fj({key:wr.key,caption:"Close"},!1,!0);ur(this,a);zr(this,"ok")}z(Bgs,wt);u=Bgs.prototype;
u.Ha=function(){wt.prototype.Ha.call(this);var a=this.Mc();Bq(a,Bfs,{description:this.Cp,ids:this.V,OPc:this.O});$q(a,"script-help-dialog")};
u.Oa=function(){wt.prototype.Oa.call(this);var a=this.Da().getElement(this.V.lHa);this.O?(this.F.render(a),this.getHandler().listen(this.F,"action",this.aFb),this.C.render(a),this.getHandler().listen(this.C,"action",this.DNb)):(this.H&&(this.C.render(a),this.getHandler().listen(this.C,"action",this.DNb)),this.F.render(a),this.getHandler().listen(this.F,"action",this.aFb),this.R.render(a),this.getHandler().listen(this.R,"action",this.dNc))};
u.DNb=function(){this.O?yq("https://support.google.com/docs?p=GSM_migration"):this.H&&yq(this.H)};u.aFb=function(){this.X?yq(this.X):(this.ma(),this.dispose())};u.dNc=function(){this.Ba();this.dispose()};var Cgs={lHa:"script-help-dialog-buttonbar"};function Dgs(a,b,c,d){sm.call(this,"Ll");this.title=d}z(Dgs,sm);function Egs(a,b,c,d,e,f){wt.call(this,void 0,void 0,f);this.O=b;this.F=d;this.H=e;this.C=null;this.setTitle(a);rr(this,!0);a=new sr(f);for(b=0;b<c.length;++b)d=c[b],a.set(d,Fgs[d]);a.D="0";ur(this,a)}z(Egs,wt);u=Egs.prototype;u.Ha=function(){wt.prototype.Ha.call(this);var a=this.Da(),b=this.Mc();$q(b,"script-prompt-contents");for(var c=a.Ha("DIV"),d=this.O.split("\n"),e=0;e<d.length;++e)0<e&&c.appendChild(a.Ha("BR")),c.appendChild(sn(a,d[e]));b.appendChild(c);this.F&&(this.C=a.Ha("INPUT"),b.appendChild(this.C))};
u.Tl=q(!1);u.Oa=function(){wt.prototype.Oa.call(this);this.getHandler().listen(this,"dialogselect",ua(this.uVc,this))};u.focus=function(){wt.prototype.focus.call(this);this.C&&this.C.focus()};u.uVc=function(a){this.H(Number(a.key),this.F?this.C.value:null)};var Fgs={1:"Ok",4:"Cancel",2:"Yes",3:"No"};function Ggs(a,b){wt.call(this);this.H=a;this.F=b;ur(this,(new sr).Fj({key:"send",caption:"Send"},!0).Fj({key:"cancel",caption:"Cancel"},!1,!0));this.setTitle("Report an issue");this.C=new Cs;this.Na(this.C)}z(Ggs,wt);u=Ggs.prototype;u.Ha=function(){wt.prototype.Ha.call(this);zr(this,"send");var a=this.Mc();$q(a,"script-reportissue-dialog-content");Bq(a,Cfs,{pcc:this.F})};
u.Oa=function(){wt.prototype.Oa.call(this);this.C.yb(this.Ia("script-reportissue-dialog-nonanonymous-checkbox"));this.R_b();var a=this.getHandler();a.listen(this.Ia("script-reportissue-dialog-description"),"input",this.R_b);a.listen(this,"dialogselect",this.vVc)};u.Mg=function(){return this.Ia("script-reportissue-dialog-description").value};u.R_b=function(){var a=!qg(this.Mg());WIb(this.D,"send",a)};u.vVc=function(a){if("send"!=a.key)return!0;this.H(this.Mg(),this.C.Me());return!0};function Hgs(a,b){gi.call(this);this.D={};this.F={};this.J=0;this.R=b;this.C=a;this.C.Y3(ua(this.tVc,this))}z(Hgs,gi);u=Hgs.prototype;u.connect=function(a){this.C.isConnected();this.C.connect(a)};u.isConnected=function(){return this.C.isConnected()};u.kCc=function(a,b){var c=Igs(this,b[0]),d=Igs(this,b[1]);b=bg(b,2);try{var e=a.apply(this,b);"function"===typeof e?e(c,d):c.call(this,e)}catch(f){d.call(this,null)}};
u.tVc=function(a,b){if(lg(a,"callback.")&&Hg(this.D,a)){var c=Mia(this.D,a);b=null!=b?JSON.parse(b):null;var d=this.F[a];d&&(Kg(this.D,d),Kg(this.F,a),Kg(this.F,d));Kg(this.D,a);c.call(this,b)}};function Igs(a,b){return ua(function(c){c=null!=c?Nn(c):null;this.C.send(b,c)},a)}u.Va=function(){gi.prototype.Va.call(this);delete this.R;delete this.D;delete this.F;delete this.J;delete this.C};function Jgs(a,b,c,d){c=new tpc({role:0,ph:c,cn:"ide.api.ch",tp:1});c.vO=b;Hgs.call(this,c,d||5E3);this.H=a;a=ua(this.O,this);this.C.xj("method.getContainerInfo",ua(this.kCc,this,a),!0)}z(Jgs,Hgs);Jgs.prototype.O=function(){return Zqk(this.H.call())};Jgs.prototype.Va=function(){var a=this.C;Hgs.prototype.Va.call(this);a.dispose();delete this.H};function Kgs(a,b,c,d,e){gi.call(this);this.H=a;this.O=b;this.V=c;this.F=d||null;this.J=e||null;this.C=this.D=null}z(Kgs,gi);Kgs.prototype.open=function(){if(this.F){if(this.F.closed){this.F=null;return}this.D=this.F;this.F=null;uh(this.D.location,this.H)}else this.D=yq(this.H,{target:this.O});if(this.J)try{this.C=new Jgs(this.J,this.D,this.V),this.C.connect(),Xn(ua(this.R,this,!0),1E5)}catch(a){this.C=null}};
Kgs.prototype.R=function(a){try{!this.C||a&&this.C.isConnected()||(this.C.dispose(),this.C=null)}catch(b){this.C=null}};Kgs.prototype.close=function(){this.R();this.D&&!this.D.closed&&(this.D.close(),this.D=null)};Kgs.prototype.Va=function(){gi.prototype.Va.call(this);this.C&&this.C.dispose();delete this.F;delete this.D;delete this.C;delete this.H;delete this.O};function Lgs(a,b,c,d,e,f,h,k,l){Cm.call(this);this.V=[];this.Fa=!!k;this.F=a;this.R=b;this.Ea(this.R);this.ma=new wgs;this.Ea(this.ma);this.C=new tgs(Js.sb());this.Ea(this.C);this.D=null;this.va=new pgs(new ogs,l);this.X=null;e&&(this.X=new kgs(new fgs(f,h),l));this.H=new Ifs(void 0,k);this.H.ah(this);this.Ea(this.H);this.F.zn(this.H);this.oa=c;this.Ba=d;this.O=this.J=null}z(Lgs,Cm);function Fes(a){return a.X?a.X.Hd:null}u=Lgs.prototype;u.xd=n("Fa");
function Mgs(a,b){if(null==b)a.H.reset(0);else{var c=a.H;c.reset(2);for(var d=0;d<b.length;d++)for(var e=b[d],f=Ek(e,ges,4),h=0;h<f.length;h++){var k=f[h];k=new Hfs(e.getId(),e.getName(),k.getName());c.Na(k,!0)}0===c.Ad()&&c.reset(1);a.H.isVisible()&&a.H.focus()}}function Ngs(a,b){var c=Om("docs-script-button-bar");c&&($m(c),qg(Dh(a))||(a=new Hs(a),a.Ed("docs-titlebar-button"),a.render(c),wm(a,"action",b)))}
function Ges(a,b,c){a.O&&!a.O.isDisposed()&&(UTb(a.F,a.O),a.O.dispose());a.O=new Ggs(b,c);a.O.Qp=!0;a.F.zn(a.O);a.O.setVisible(!0)}
u.Qkd=function(a,b,c){var d=this.F,e=c||null;c="<p>";var f="Thanks! Your feedback was sent to the creators of <strong>"+(Eq(a)+"</strong>.");c=c+f+"</p>";e&&(c+="<p>",b?(a="You might not receive an individual reply, but if you'd like to learn more, check out <a href=\""+(V(Oq(e))+'" target="_blank">'+(Eq(a)+" help</a>.")),c+=a):(a="You won't receive an individual reply, but if you'd like to learn more, check out <a href=\""+(V(Oq(e))+'" target="_blank">'+(Eq(a)+" help</a>.")),c+=a),c+="</p>");c=Fq(c);
Hqk(d,"Report an issue",Aq(c),void 0,void 0,"Close")};u.Pkd=function(){Hqk(this.F,"Report an issue","We're sorry, but we encountered an error sending your issue report. Please try again later.",void 0,void 0,"Close")};function Ees(a){a.dispatchEvent("Ol")&&(a=a.Ba,a.C.isVisible()&&a.C.hide(),a.D.Ic()||a.D.render(a.F||void 0),a.D.show())}u.d7=function(){this.dispatchEvent("Kl")&&this.Ba.D.hide()};u.$ed=function(a,b,c,d,e){a=new Kgs(a,"MacroService"+Dla(c),b,e,d);this.V.push(a);a.open()};
u.Va=function(){Cm.prototype.Va.call(this);ji(this.V)};function Ogs(a,b,c,d,e,f,h,k,l,m,p,r,t,v,y,G,M,S,Y){t=void 0===t?!1:t;v=void 0===v?null:v;M=void 0===M?!1:M;gi.call(this);this.O=a;this.V=l;this.Ya=k;this.va=m;this.R=b;this.oa=c;this.J=d;this.F=G;this.H=new Gm(this);this.Ea(this.H);this.Ra=p;this.Ua=v;this.ma=new tfs(this.oa,this.J);this.Ea(this.ma);this.Ka=M;a=this.va;c=this.Ka;t=void 0===t?!1:t;this.C=new Lgs(e,h,p,r,Pgs(a),c,a,t,y);this.Ea(this.C);this.Pa=new des;h=0;b.D?b.C&&(h=2):h=1;this.D=new ves(this.va,e,f,this.C,this.Pa,this.O,this.oa,
this.V,h,this.F,S,Y);this.Ea(this.D);this.Ba={};this.X=this.Fa=null}z(Ogs,gi);u=Ogs.prototype;
u.start=function(){if(ko(this.O.J,1,1)){this.H.listen(this.J,"amep",ua(this.eVc,this));this.H.listen(this.J,"stbep",ua(this.lVc,this));this.H.listen(this.J,"sttep",ua(this.mVc,this));this.H.listen(this.J,"spep",ua(this.kVc,this));this.H.listen(this.J,"saep",ua(this.iVc,this));this.H.listen(this.J,"snep",ua(this.jVc,this));this.H.listen(this.J,"paep",ua(this.gVc,this));this.H.listen(this.J,"rfep",ua(this.hVc,this));this.H.listen(this.C,"dialogselect",ua(this.lxc,this));this.H.listen(vUc.sb(),"Yc",
ua(this.fVc,this));this.Ya(ua(this.hxc,this));var a=this.O.C;U("macros-exec").Lc(Xo,this.cxc,this);U("macros-resume").Lc(Xo,this.OHc,this);U("macros-manage").Lc(Xo,ua(a.OD,a,ua(this.MBc,this)));U("macros-editor").Lc(Xo,this.A8a,this);U("macros-extensions").Lc(Xo,ua(this.JDb,this));U("macros-manage-extensions").Lc(Xo,ua(this.LBc,this));U("macros-extension-menu-promo").Lc(Xo,ua(this.JDb,this));U("macros-extension-disabled").Lc(Xo,this.pvc,this);U("macros-extension-help").Lc(Xo,this.txc,this);U("macros-extension-install-start").Lc(Xo,
this.zAc,this);U("macros-trigger-0").Lc(Xo,ua(this.DY,this,"0"));U("macros-trigger-1").Lc(Xo,ua(this.DY,this,"1"));U("macros-trigger-2").Lc(Xo,ua(this.DY,this,"2"));U("macros-trigger-3").Lc(Xo,ua(this.DY,this,"3"));U("macros-trigger-4").Lc(Xo,ua(this.DY,this,"4"));U("macros-trigger-5").Lc(Xo,ua(this.DY,this,"5"));U("macros-trigger-6").Lc(Xo,ua(this.DY,this,"6"));U("macros-trigger-7").Lc(Xo,ua(this.DY,this,"7"));U("macros-trigger-8").Lc(Xo,ua(this.DY,this,"8"));U("macros-trigger-9").Lc(Xo,ua(this.DY,
this,"9"));this.ma.start();Qgs(this.va,this.Ka)&&(U("macros-addon-sidebar-focus").Xa(!0),U("macros-addon-sidebar-focus").hc(void 0,Tds(19)));Lfs(new Kfs(this.R,this.D));a=this.R.J;var b=!this.R.C,c=this.oa,d=this.V().getState()||void 0;d=["ruid",ta({}),c.C.C,c.D,c.C.D,d];b||d.push("addon_safe_mode",!0);a&&d.push("addon_dry_run",a);Ho(Jo(res(c,c.C.Fa),"POST").setContent(""),d).fC().Ei()}};
function Rgs(a){Mgs(a.C,null);var b=ua(function(c){c.vB()?Mgs(this.C,Ek(c,ies,2)):(this.C.C.C.postMessage(Ls("Could not load scripts.","warning",!0)),Mgs(this.C,[]))},a);ses(a.oa,b)}
function Sgs(a,b,c,d,e,f){if(d){Ees(a.C);var h=ua(function(){var r=Qes(this.D,b);r&&!mk(r,4)&&(R(r,4,!0),Hes(this.D))},a);var k=ua(function(){this.C.d7();this.O.Xu.dispatchEvent(new On(!0))},a);var l=ua(function(r){this.C.d7();8!=r.SW()&&vgs(this.C.C,c,r.Rj())},a);Des(a.D)}else{var m=ugs(a.C.C),p=ua(function(r){this.ma.F.cancel(r);Ks(this.C.C.C,m)},a);h=ua(function(r){Ks(this.C.C.C,m);m=ugs(this.C.C,va(p,r))},a);k=ua(function(r){Ks(this.C.C.C,m);if(r.uva()){r=this.C.C;var t=rg("Canceled script ");
r.C.postMessage(Ls(t,"info",!1,2500))}else r=this.C.C,t=rg("Finished script "),r.C.postMessage(Ls(t,"info",!1,2500));this.O.Xu.dispatchEvent(new On(!0))},a);l=ua(function(r){Ks(this.C.C.C,m);8!=r.SW()&&vgs(this.C.C,c,r.Rj())},a)}a.Ra.Rc(3);cVj(a.O.C,ua(a.Khd,a,b,c,h,k,l,d,e,f))}u.Khd=function(a,b,c,d,e,f,h,k){var l=this.V().getState()||void 0,m=this.ma;c=void 0===c?pa:c;d=void 0===d?pa:d;e=void 0===e?pa:e;e=ua(m.oVc,m,a,b,c,d,e);m.F.ZGb(a,b,l,e,f,h,k)};
u.fVc=function(a){var b=Zf(this.D.D),c={};b=da(b);for(var d=b.next();!d.done;d=b.next())d=d.value,c["ADD-ON:"+L9(d)]={name:d.getName(),"cws-id":Q(d,1),"gsm-application-id":Q(d,18),"app-key":L9(d)};Tg(a.HZ,c)};u.pvc=function(a){a.data==this.Fa&&(a=this.C,a.dispatchEvent("Jl")&&a.va.Hd.wTa())};
u.eVc=function(a){a=a.lk().Oc();var b={},c=Tgs(this,a);if(1==nk(a,11,0)){var d=Q(a,4);d=Qes(this.D,d)}else d=void 0;var e=d,f=e&&(mk(e,10)||mk(e,9))||!1,h=e&&mk(e,19)||!1;d=this.Pa;var k=c,l=Q(a,4),m=1==nk(a,11,0);f=new bes(a,k,m,f,h);f.setVisible(!0);0==nk(a,11,0)&&(l=f.getLabel());d.C[nk(a,11,0)][l]=f;d.dispatchEvent("Nl");(d=Fes(this.C))&&Q(a,9)&&(1==Q(a,12)||5==Q(a,12))&&(l=Q(a,4),d.J[l]=a,l&&l in d.D&&egs(d.D[l],a));c=c.reverse();if(d=this.C.R){for(l=0;l<c.length;l++)if(f=c[l],h=f.getKey())if(b[h])uk(f,
5);else{if(this.Ba[h])for(k="Ctrl+Alt+Shift+"+h.toUpperCase(),k=vMb(U("macros-exec"),[k]),m=0;m<d.ma.length;m++){var p=d.ma[m];hn(p)==k&&fn(p,"")}this.Ba[h]=f.Xh();b[h]=!0}if(1==nk(a,11,0)){b=null!=e?e:null;c=[];e=Q(a,4);f=!!Q(a,9)&&3!=Q(a,12);l=d.C.F.get(e);l||(l=new is(""),l.vd(e),h=Q(a,10),l.setContent(Wm(h)),l.Xa(2==d.V?!1:f&&1==d.V?!1:!0),d.F.Cd(),Kes(d.C,l),Les(d));f||d.X.push(e);f=new fs;!b||mk(b,10)||mk(b,9)||mk(b,19)||(Mes(d,f,b),h=new Cds,k=String(ta(h)),R(h,1,k),f.Na(Rfs(d,h,c),!0));h=
b&&(mk(b,10)||mk(b,9))||!1;if(!b||h||!mk(b,19))for(a=a.Cm(),h=0;h<a.length;++h)f.Na(Rfs(d,a[h],c,void 0,b?b:void 0),!0);b&&Nes(d,f,e,c,b);d.oa[e]=c;l.Lh(f);l.dispatchEvent("load");d.Ba.push(e)}else{b=a.Nl();if(d.cE(b)){d.cE(b);c=d.D[b];delete d.D[b];d.H.removeChild(c,!0);if(d.O)for(e=d.va[b],l=0;l<e.length;++l)d.O.Yea(e[l]);delete d.va[b];c.dispose()}10<=Ag(d.D)||(b=[],a.Cm(),c=a.Nl(),a=Rfs(d,a,b,"Ctrl+Alt+Shift+").Oc(),a=new Qs(c,a,Ofs.sb(),void 0,!0),e=d.H.Ad()?d.H.Ad()-1:0,d.H.zj(a,e,!0),d.D[c]=
a,d.va[c]=b)}}};u.lVc=function(a){a=a.lk();var b=a.Nl();b?Ngs(b,ua(function(c){var d=Dh(c.getUrl());qg(d)||yq(d);d=Dh(c.getFunctionName());qg(d)||Sgs(this,Q(c,1),d,Q(c,4)||void 0,void 0,c.kB()||void 0)},this,a)):xgs()};
u.mVc=function(a){var b=a.lk();a=b.getText();b=b.Fs();var c=this.C.ma,d=Om("docs-script-button-bar");d&&(ygs(c),qg(Dh(a))||(a=Dq(xfs,{caption:a}),Zm(d,a),qg(Dh(b))||(c.C=new Xr,c.C.Ed("docs-script-button-bar-bubble"),c.C.setContent(Dq(yfs,{text:b})),c.C.gp(a),Yr(c.C,!0),c.C.NX=!1,c.C.setPosition(1,1),c.C.kz(!1),c.C.render(d),c.D.listen(a,"mouseover",ua(c.C.setVisible,c.C,!0)).listen(a,"mouseout",ua(c.C.setVisible,c.C,!1)))))};
u.kVc=function(a){this.C.d7();var b=a.lk(),c=rk(b,6,!1);a=c?Q(b,3).replace(/\n/g," ").replace(/\\n/g,"\n"):Q(b,3);var d=Q(b,7),e=this.C,f=b.getTitle(),h=Q(b,4),k=rk(b,5,!1);b=ua(this.oGc,this,Q(b,1),c,d);e.D&&(e.D.setVisible(!1),UTb(e.F,e.D));e.D=new Egs(f,a,h,k,b);e.D.Qp=!0;e.F.zn(e.D);e.D.setVisible(!0)};u.oGc=function(a,b,c,d,e){var f=new Zes;R(f,1,d);R(f,3,b);R(f,4,c);null!==e&&R(f,2,e);U("macros-resume").hc([a,Nn(f.Pc())])};
u.iVc=function(a){a=a.lk();var b=X2j(T(a,tX,9));var c={};c.mid=this.R.H;b=Hja(b,c);switch(nk(a,6,0)){case 1:var d=this.C;c=Q(a,3);var e=this.V,f=a.getTitle()||void 0;if(d.dispatchEvent(new Dgs(b,c,e,f))){var h=d.oa;d=d.va.Hd;d.Ic()||(d.render(),d.resize());d.wTa();var k=d.Da();k.Rh(d.H,f||"Apps Script application");f=ua(h.Rc,h,3);d.C=new mgs(b,c,[new lgs("google.script.host.close",ua(d.wTa,d),0),new lgs("google.script.host.editor.focus",f,0)],e,k);hi(d.C,f);d.Na(d.C,!0);U("macros-application-focus").hc()}this.Fa=
Q(a,7)||null;break;default:c=this.C,e=Q(a,3),f=this.V,h=a.getTitle()||void 0,d=a.zc()||void 0,k=a.Ec()||void 0,a=rk(a,8,!1),c.D&&(c.D.setVisible(!1),UTb(c.F,c.D)),c.D=new ngs(b,e,f,c.oa,h,d,k,a),c.D.Qp=!0,c.F.zn(c.D),c.D.setVisible(!0)}};u.jVc=function(a){a=a.lk();var b=a.getType();this.Ua(b,a.getText(),a.getTitle()||void 0,Q(a,4)||void 0)};
u.gVc=function(a){if(Ar().C){if(!this.X){a=Lm();var b=mn(a,"docs-hub-open-external-appbarbutton");this.X=new fve(b,a,"A script attached to this file needs your permission to run. To give permission, open in a new tab and rerun the script.","Authorization required");this.Ea(this.X);sq(this.X,b)}this.X.setVisible(!0)}else a=a.lk(),(b=T(a,Ves,3))&&(kk(b,2)||kk(b,11))?(b=new Kds(Q(b,2),Q(b,11)),mk(a,4)?(b=this.D.getExtension(b),null!=b&&mk(b,10)?(b="The add-on "+(b.getName()+" needs your permission to run in this document."),
a=a.getUrl(),new rgs(a,(new bu).format(""),void 0,void 0,b)):(a=a.getUrl(),new rgs(a,(new bu).format("A script attached to this document needs your permission to run."),void 0,void 0,"Updated add-on"))):this.D.jha(b)):(a=a.getUrl(),new rgs(a,(new bu).format("A script attached to this document needs your permission to run."),void 0,void 0,void 0))};u.hVc=function(a){a=a.lk();Sgs(this,Q(a,1),a.getFunctionName(),Q(a,4)||void 0,void 0,a.kB()||void 0)};
u.cxc=function(a){a=a.data;var b=Qes(this.D,a.C);!b||mk(b,9)?Sgs(this,a.C,a.functionName,a.F||void 0,1,a.D||void 0):this.D.jha(Mds(b))};u.OHc=function(a){Ees(this.C);var b=a.data;a=b[0];b=b[1];var c=ua(function(){this.C.C.C.postMessage(Ls("Error resuming script execution","warning",!0))},this);ufs(this.ma,a,b,c)};u.MBc=function(){this.C.H.setVisible(!0);Rgs(this)};
u.A8a=function(a){var b=a.data;a=b?b.scriptId:void 0;a=new lm(Ses(this.R,a?a:void 0));b&&(a=b.editorUri?new lm(b.editorUri):a,b.filename&&a.Od("f",b.filename),b.lineNumber&&(a.Od("l",b.lineNumber),a.Od("s",b.lineNumber)));b=this.O.F;var c=null;yo(this.O.C)||(c=PPj("Loading\u2026",{target:"MacroService"+Dla(b)}));this.O.C.OD(ua(this.C.$ed,this.C,a.toString(),this.R.R,b,this.V,c))};u.JDb=function(){this.D.jha()};
u.LBc=function(a){if(a.data)this.D.jha(a.data);else{a=this.D;var b=Ces(a,!0),c=a.V;var d=c.D;b=Yds(d,d.C,b,void 0,!0);d=Zds(d,b);c.C=d;d=c.C;c.F.zn(d);d.setVisible(!0);Des(a)}};
u.txc=function(a){var b=this.D,c=Qes(b,a.data);if(c){var d=Mds(c);a=ua(b.OVb,b,d,L9(c),c.getName(),Q(c,6)||void 0,Q(c,11)||void 0);d=ua(b.jha,b,d);var e=mk(c,19)||void 0,f=b.C,h=c.getName(),k=Dh(Q(c,7)),l=Q(c,6)||void 0;c=Q(c,11)||void 0;e=void 0===e?!1:e;f.J&&!f.J.isDisposed()&&(UTb(f.F,f.J),f.J.dispose());f.J=new Bgs(h,k,a,d,l,c,e);f.J.Qp=!0;f.F.zn(f.J);f.J.setVisible(!0);Des(b)}};
u.zAc=function(a){if(a.data){var b=Qes(this.D,a.data);if(null!=b)if(a=this.D,b=Mds(b),a.H){a:{if(1==a.H)b="Add-ons aren't allowed in your domain. Talk to your domain administrator for more information.";else if(2==a.H)b="Add-ons aren't allowed while in safe mode.";else break a;Hqk(a.oa,"Oops",b,void 0,void 0,"Close")}Hes(a)}else{var c=a.getExtension(b);c&&mk(c,9)?(b=a.getExtension(b).getName(),b=rg(b+" is already installed"),a.C.C.C.postMessage(Ls(b,"info",!1,2500)),Hes(a)):a.jha(b)}}};
u.lxc=function(a){"edit"==a.key?(a=a.target.pE.gj(),a=Ses(this.R,a?a.VHb:void 0),this.A8a(new AAb({editorUri:a}))):"new"==a.key?this.A8a(new AAb({editorUri:this.R.X})):"reload"==a.key?Rgs(this):"run"==a.key&&(a=a.target.pE.gj(),Sgs(this,a.VHb,a.getFunctionName(),void 0,void 0,a.kB()))};u.DY=function(a){(a=this.Ba[a])&&(a=Qfs(this.C.R,a))&&a.isEnabled()&&a.dispatchEvent("action")};u.hxc=function(){for(var a=this.C,b=0;b<a.V.length;b++){var c=a.V[b];c.close();c.dispose()}a.V=[]};
function Tgs(a,b){var c=[];Q(b,3)&&c.push(b);b=b.Cm();for(var d=0;d<b.length;d++)c=c.concat(Tgs(a,b[d]));return c}u.getView=n("C");function Pgs(a){return a==(Is(),XNb)||a==(Is(),ZNb)||a==(Is(),YNb)}function Qgs(a,b){return b&&(a==(Is(),XNb)||a==(Is(),YNb))};function Ugs(a,b,c,d,e,f,h){gi.call(this);var k=this;this.D=a;this.O=b;this.Ib=e;this.F=d;this.ma=new Dm;this.C=f;this.oa=h;this.V=new ws(this);this.Ea(this.V);this.V.Lc(Tac,To,this.J);this.X=new Gm(this);this.Ea(this.X);this.ma.Nc(this.F.F,function(){return k.J()});this.H=new BQb(this.Ib.hd(),!0);this.Ea(this.H);this.R={};this.J()}z(Ugs,gi);Ugs.prototype.J=function(){var a=Vgs(this),b=this.O.Oc(Wac.getId(),!0);b.jf(!0);qRb(this.O,b,[new Bik(a)]);$q(b.getElement(),"waffle-action-menu")};
function Vgs(a){var b=Array.from(a.F.C.values());Ocs(b,function(r){return ij(r,8)});var c=Array.from(a.F.D.values());ft(a.oa,nie(0<b.length,0<c.length));Vac.setProperty("visible",!0);Uac.setProperty("visible",!0);var d={};c={};b=da(b);for(var e=b.next();!e.done;c={m_a:c.m_a},e=b.next()){e=e.value;var f=ij(e,1),h=e.getFunctionName(),k=ij(e,8),l=ej(e,9)?ij(e,9):null,m="recorded-action-"+f+":"+h,p=a.D.Xi(m);p||(p=(new qDb(m)).enabled(!0),p.La(29583),p=p.build(),c.m_a=new Bds(f,h,void 0,void 0,void 0,
ej(e,12)?e.kB():void 0),p.Lc(Xo,function(r){return function(){U("macros-exec").hc(r.m_a)}}(c)),cQb(a.H,[p]),a.D.ez(p),a.C&&a.C.Kn(p));p.setProperty("label",k);Wgs(a,l)&&p.setProperty("keys",[l]);null==l&&null!=p.getProperty("keys")&&p.setProperty("keys",null);d[m]=p}xg(a.R,function(r,t){d[t]||(r.setProperty("keys",null),a.D.g$(t),a.C&&a.C.Yea(t),ii(r))});a.R=d;return Bg(d)}function Wgs(a,b){return!Tac.jg()&&null!=b&&/^Ctrl\+Alt\+Shift\+\d$/i.test(b)&&0==(zha(a.H.C,xd(b))||[]).length};function Xgs(a,b){this.Xlb=a;this.qYa=b};function Ygs(a,b){a='<div class="waffle-recording-toast" role="complementary" tabIndex="0" aria-describedby="waffle-recording-toast-content"><div class="waffle-recording-toast-top"><div class="waffle-recording-toast-icon"><div class="waffle-recording-toast-outer-circle"><div class="waffle-recording-toast-inner-circle"></div></div></div><div class="waffle-recording-toast-content"><div class="waffle-recording-toast-new-content"></div><div class="waffle-recording-toast-default-content">Recording new macro\u2026</div></div><div class="waffle-recording-toast-right"><div class="waffle-recording-toast-cancel">Cancel</div><div class="waffle-recording-toast-stop">Save</div><div class="waffle-recording-toast-expand-section"><div class="waffle-recording-toast-expand"><div class="waffle-recording-toast-expand-icon"></div></div></div></div></div><div class="waffle-recording-toast-bottom" role="radiogroup"><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-absolute">'+
Az({label:Lq('Use absolute references<div class="waffle-recording-toast-label-description">When applying macro use exact location as recorded</div>')},b);a=a+'</div></div><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-relative">'+Az({label:Lq('Use relative references<div class="waffle-recording-toast-label-description">When applying macro use active selection</div>')},b);return Fq(a+"</div></div></div></div>")};function Zgs(a){rq.call(this,a);this.J=new $r("",new Dt,this.Da());this.Na(this.J);this.F=new $r("",new Dt,this.Da());this.Na(this.F);this.D=new xs;this.Ea(this.D);this.H=null;this.C=0}z(Zgs,rq);u=Zgs.prototype;u.Ha=function(){this.Qb(Dq(Ygs))};
u.Oa=function(){rq.prototype.Oa.call(this);this.R=new SGk(this.Da(),void 0,"relative");this.O=new SGk(this.Da(),void 0,"absolute");this.R.yb(this.Ia("waffle-recording-toast-relative"));this.O.yb(this.Ia("waffle-recording-toast-absolute"));var a=Og(zs);Ng(a,"selected",!0);var b=yp(new xp,6).build();ys(this.D,this.R,Zac,a,void 0,b);ys(this.D,this.O,$ac,a,void 0,b);ys(this.D,this.J,U("recorded-action-stop"),void 0,void 0,b);ys(this.D,this.F,Sac,void 0,void 0,b);this.H=new rbd(this.Ia("waffle-recording-toast-expand"),
this.Ia("waffle-recording-toast-bottom"),abc.isVisible(),void 0,this.Da());this.Ea(this.H);this.getHandler().listen(this.H,"toggle",this.bHc);this.J.yb(this.Ia("waffle-recording-toast-stop"));this.F.yb(this.Ia("waffle-recording-toast-cancel"))};u.setVisible=function(a){var b=this.Sa();lq(b,a);Vq(b,"hidden",!a);a&&(a=this.Da().hd(),a=Tm(a)||window,b=eq(this.Sa()),this.Sa().style.left=Math.max(Math.floor(Sm(a).width/2-b.width/2),0)+"px")};
function $gs(a,b){a.Ia("waffle-recording-toast-default-content").style.opacity=0;var c=a.Ia("waffle-recording-toast-new-content");a.Da().Rh(c,b);0!=a.C?ahs(a):(Yn(a.C),a.C=Xn(function(){return ahs(a)},400))}function ahs(a){var b=a.Ia("waffle-recording-toast-new-content");br(b,"waffle-recording-toast-slide-in");Yn(a.C);a.C=Xn(function(){$q(b,"waffle-recording-toast-slide-in");Yn(a.C);a.C=Xn(function(){return bhs(a)},2200)})}
function bhs(a){var b=a.Ia("waffle-recording-toast-default-content"),c=a.Ia("waffle-recording-toast-new-content");br(c,"waffle-recording-toast-slide-in");b.style.opacity=1;Yn(a.C);a.C=Xn(function(){a.C=0},400)}u.bHc=function(a){abc.setVisible(a.HW)};u.Va=function(){Yn(this.C);rq.prototype.Va.call(this)};function chs(a,b,c,d){gi.call(this);var e=this;this.R=a;this.O=c;this.D=d;this.C=Vk().qnc()(Vk().DF()(),Vk().Llc()(),M9(this),Zac.jg(),function(f){f="Action "+(Vk().pnc()(e.C)+(": "+f));dhs(e,f)},Vk().JAb()());Vk().$Ab()(this.C);this.H=new Zgs;this.Ea(this.H);this.Ba=new ws(this);this.Ea(this.Ba);this.Ba.Lc(Zac,Xo,this.ZMc,this).Lc($ac,Xo,this.YMc,this).Lc(U("docs-doc-copy-made"),Xo,this.Gvc,this).Lc(U("macros-exec"),Xo,this.mIc,this).Lc(S4b,Xo,function(f){return ehs(e,f.data,2)},this).Lc(Y4b,Xo,
function(f){return ehs(e,f.data,3)},this).Lc(R4b,Xo,function(f){return ehs(e,f.data,1)},this).Lc(T4b,Xo,function(f){return ehs(e,f.data,5)},this).Lc(T5b,Xo,function(f){return ehs(e,f.data,4)},this).Lc(l5b,Xo,function(f){f=f.data;switch(f.F){case "all-objects-for-all-datasources":Vk().dnc()(e.C,M9(e));break;case "all-objects-for-single-datasource":Vk().enc()(e.C,M9(e),f.D);break;case "specific-ids":var h=f.C[0];f=Vk().OW()(h);var k=null;switch(f){case 4:k=fhs(e,h,!1);break;case 1:case 3:case 5:(h=
Vk().cyb()(h,$X(e.O)))&&0<h.length&&(k=no(h[0]),k=Pqb(Oqb(Nqb(Lqb(),k.Fb()),k.wd()),k.od()).build(),h=Rcs(),3==f?(Scs(h),xj(h,6,k)):1==f?(Scs(h),xj(h,5,k)):5==f&&(Scs(h),xj(h,4,k)),k=h.build().Ob());break;case 2:(h=Vk().byb()(h))&&0<h.length&&(k=Qcs(h[0]).build().Ob())}k&&Vk().cBb()(e.C,M9(e),f,k)}}).Lc(d5b,Xo,function(){return Vk().fnc()(e.C,M9(e),!1)},this).Lc(Q4b,Xo,this.duc,this).Lc(U4b,Xo,function(f){return Vk().$mc()(e.C,M9(e),f.data.Ob())},this);this.F=new Dm;this.Ea(this.F);this.F.Nc(a.$a,
function(){Vk().vnc()(e.C,!0,M9(e))});this.F.Nc(a.Pa,function(f){if(f.D){var h=f.C.D();"docs-edit"==h?"ritz-waffle"==f.C.C&&Vk().snc()(e.C,M9(e)):"docs-undo"==h?(dhs(e,"Undo previous action"),Vk().wnc()(e.C)):"docs-redo"==h&&(dhs(e,"Redo previous action"),Vk().tnc()(e.C))}});this.F.Nc(b.oa,function(f){f.C||Vk().lnc()(e.C,M9(e),f.D)});this.F.Nc(this.D.Hb,function(f){return ghs(e,f)});this.F.Nc(this.D.Vc,function(){e.ma=M9(e)});this.F.Nc(this.D.Qc,function(f){switch(f.D){case "find-next-occurrence":Vk().anc()(e.C,
e.ma,M9(e),f.C.Ob());break;case "replace-current-occurrence":Vk().gnc()(e.C,M9(e),f.C.Ob())}e.ma=null});this.F.Nc(this.D.ob.D,function(f){Vk().knc()(e.C,M9(e),f.F,f.H,f.J,f.O,f.id,f.C,f.D)});this.F.Nc(b.Xu,function(){Vk().Ymc()(e.C,e.va,M9(e),e.oa);e.va=null;e.oa=null});this.F.Nc(this.D.Xc,function(f){Vk().Zmc()(e.C,e.J.D.C.Ob(),f.getSelection().C.Ob(),e.J.C.Ob());e.J=null});this.X=new Gm(this);this.Ea(this.X);this.J=this.ma=this.oa=this.va=this.V=null;this.X.listen(this.D.C,"pa",this.L5c).listen(this.D.C,
"va",this.K5c);this.H.render();this.H.setVisible(!0);hhs(this);setTimeout(function(){return Rw("All actions are now being recorded. Please use the Tools menu to cancel or save recording.")})}z(chs,gi);u=chs.prototype;u.K5c=function(){this.V=M9(this)};u.L5c=function(a){!a.GZ&&t$c(this.D)&&(void 0!==a.uia?(a=a.uia,Vk().nnc()(this.C,this.V,M9(this),a)):(a=this.D.C.C.bh(),$gs(this.H,"Activating sheet "+a),Vk().onc()(this.C,this.V,M9(this),a)),this.V=null)};
function dhs(a,b){$gs(a.H,b);Rw("Macro recorder "+b)}function ihs(a){return Vk().rnc()(a.C,M9(a))}u.mIc=function(a){this.oa=a.data.functionName;this.va=M9(this)};function ghs(a,b){var c=M9(a);a.X.qe(a.D,"gc",function(){var d=M9(a);switch(b.H){case "adjust-next-data-region-edge":Vk().Xmc()(a.C,c,d,b.D,b.C);break;case "move-next-data-region-edge":Vk().cnc()(a.C,c,d,b.D,b.C);break;case "select-all":Vk().hnc()(a.C,c,d);break;case "select-rows-columns":Vk().jnc()(a.C,c,d,"c"==b.F)}})}
u.Gvc=function(a){a=a.data;Vk().bnc()(this.C,M9(this),a.C)};u.duc=function(a){a=a.data;var b=this.R.C.getSelection();this.J=new jhs(a,b)};
function ehs(a,b,c){var d=Vk().cBb(),e=a.C,f=M9(a);a:switch(c){case 4:b=fhs(a,b,!0);break a;case 3:case 1:case 5:var h=Zw(a.O);h?(a=Xqb(a.R.C.getSelection()),khs(b,a,h)?b=null:(a=dDd(h),khs(b,a,h)?(b=oKc(h.kb().Jk(a.y,a.x)),b=null!=b?b:Pqb(Oqb(Nqb(Lqb(),h.R.C.C.Fb()),a.y),a.x).build(),h=Rcs(),3==c?(Scs(h),xj(h,6,b)):1==c?(Scs(h),xj(h,5,b)):5==c&&(Scs(h),xj(h,4,b)),b=h.build().Ob()):b=null)):b=null;break a;case 2:if(h=Zw(a.O)){a=a.R.C.getSelection();var k=sxk(h);b=k&&jj(a.C,6).Pc().includes(k)?null:
(a=qxk(h))&&b==rxk(h)?Qcs(a).build().Ob():null}else b=null;break a;default:b=null}d(e,f,c,b)}function khs(a,b,c){if(!b)return!1;b=c.kb().Jk(b.y,b.x);c=cDd(c,b);return a==c}function fhs(a,b,c){if(c&&(a=a.D.C.C)&&ev(a))return null;b=Vk().U5()(b);if(!b)return null;(b=Vk().Sba()(b))?(a=Rcs(),Scs(a),b=sj(a,2,b).build().Ob()):b=null;return b}u.ZMc=function(){var a=!Vk().dBb()(this.C);lhs(this,!0);a&&($gs(this.H,"Using relative references"),Rw("Recording with relative references"))};
u.YMc=function(){var a=Vk().dBb()(this.C);lhs(this,!1);a&&($gs(this.H,"Using absolute references"),Rw("Recording with absolute references"))};function lhs(a,b){Vk().unc()(a.C,b);Zac.Id(b);$ac.Id(!b)}function hhs(a){(a=Zw(a.O))&&vvd(a)}function M9(a){return a.R.C.getSelection().C.Ob()}u.Va=function(){Vk().nAb()();gi.prototype.Va.call(this)};function jhs(a,b){this.C=a;this.D=b};function mhs(a,b,c,d){Ft.call(this,"Macro saved",Lm(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-saved"]);this.Ua=a;this.va=b;this.R=c;this.Fa=d}z(mhs,Ft);mhs.prototype.Ha=function(){Ft.prototype.Ha.call(this);var a=tq(this,"script-recorder-edit-link-id");this.aF("EDIT SCRIPT",a)};mhs.prototype.Oa=function(){Ft.prototype.Oa.call(this);this.getHandler().ij(uq(this,"script-recorder-edit-link-id"),ym,ua(this.O,this,this.Ua,this.va,this.R))};
mhs.prototype.O=function(a,b,c){this.Fa.C(29645);U("macros-editor").hc(b?{scriptId:a,filename:b,lineNumber:c}:void 0)};function nhs(a,b,c,d,e,f,h,k,l,m){bt.call(this);var p=this;this.va=a;this.ma=b;this.Ua=c;this.Ka=d;this.X=e;this.J=f;this.Fa=h;this.oa=k;this.R=m;this.Ba=new ws(this);this.Ea(this.Ba);this.H=null;this.O=!1;this.C=null;this.Pa=l;this.Ba.subscribe(Xac,"action",this.Qjd).subscribe(U("recorded-action-stop"),"action",this.Hld).subscribe(bbc,"action",this.Nhd).subscribe(Sac,"action",this.z6b).subscribe(Uac,"action",this.qkd).subscribe(Vac,"action",this.wkd);et(this,ohs(this));Kp(this.J,this);a=["not-revisions",
"sheet-access-edit",ht()];var r=new Jp(a.concat(["docs-script-recording"]));Bf([Sac,U("recorded-action-stop"),bbc,Yac,$ac,Zac],function(t){p.J.C(t,r);p.J.F(t,r)});a=new Jp(a.concat(["not-docs-script-recording"]));this.J.C(Xac,a);cu()||this.J.F(Xac,a)}z(nhs,bt);u=nhs.prototype;u.Qjd=function(){var a=this;this.H=new chs(this.Ua,this.Ka,this.X,this.Fa);ft(this,ohs(this));this.Fa.D.C.OD(function(){Io(Ol(Jo(a.va.Ci("/startrecordingscript"),"POST"),1).setTimeout(18E4)).Ei()})};
u.Hld=function(){QQc(this.X)&&qld(Zw(this.X),!0);this.H.H.setVisible(!1);Vk().nAb()();Kcs(this.ma)};
u.Nhd=function(a){var b=this,c=a.Xlb;a=a.qYa;var d=ihs(this.H).C;phs(this,Lt(this.R,"Saving new macro",Lm(),!0,0,!1,void 0,!0,["waffle-recording-toast-saving"]),!0);this.O=!0;ft(this,ohs(this));Io(Pl(Ql(Ol(Jo(Nl(Nl(cwb(this.va.Ci("/saverecordedscript"),["script",d]),"name",c),"shortcut",""!=a?"Ctrl+Alt+Shift+"+a:""),"POST"),1),function(e){var f=e.Cca("scriptId"),h=e.Cca("filename");e=Number(Uw(e,"lineNumber"));f=new mhs(f,h,e,b.Pa);LVb(b.R,f);phs(b,f);b.O=!1;qhs(b)}),function(){phs(b,Lt(b.R,"Failed to save macro",
Lm(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-save-failed"]));b.O=!1;if(b.H){var e=b.H;Vk().$Ab()(e.C);e.H.setVisible(!0)}ft(b,ohs(b))}).setTimeout(18E4)).Ei()};function qhs(a){ii(a.H);a.H=null;ft(a,ohs(a))}u.z6b=function(){qhs(this);setTimeout(function(){return Rw("Script recording canceled")})};function ohs(a){var b={},c=!!a.H;a=a.O;b["docs-script-recording"]=c&&!a;b["not-docs-script-recording"]=!c&&!a;return b}u.qkd=function(){Lcs(this.ma,this.oa)};u.wkd=function(){Mcs(this.ma,this.oa)};
function phs(a,b,c){a.C&&(MVb(a.R,a.C),a.C.setVisible(!1),ii(a.C));a.C=b;a.C.render();c&&(new E5k(!0,Lm())).render(Rm("docs-ui-toast-content",b.getElement()));a.C.setVisible(!0)}u.Va=function(){ii(this.H);this.H=null;this.C&&(ii(this.C),this.C=null);bt.prototype.Va.call(this)};function rhs(a,b,c,d){1==a&&qNc(yh(c||""),yh(b),void 0!==d?d:-1,!0)};function shs(a,b,c,d,e,f,h,k,l,m,p,r,t,v,y,G,M,S,Y){gi.call(this);this.V=a;this.ma=b;this.va=c;this.Ba=d;this.R=e;this.Ua=f;this.Ra=h;this.C=k;this.F=l;this.Pa=m;this.O=p;this.X=r;this.Ya=t;this.J=new Gm(this);this.Ea(this.J);this.oa=new ads(this.va,this.F);this.hb=new nhs(this.va,this.R,this.ma,this.V,this.C.D,y,this.F,this.oa,G,M);this.Ea(this.hb);this.$a=new Ugs(y.Xn(),this.C.va.C,l,this.oa,v,this.C.va.Ka,S);this.Ea(this.$a);this.D=null;this.H=Y}z(shs,gi);
shs.prototype.init=function(){var a=this.C.va.Ka;a.Kn(Xac);a.Kn(Sac);a.Kn(U("recorded-action-stop"));a.Kn(Zac);a.Kn($ac);a.Kn(Uac);a.Kn(Vac);a=this.F.Nb.D;var b=this.F.Nb.C;b&&(b+=a?"_"+a:"");a=pf();var c=of(a,"docs-tintd")&&of(a,"docs-thtea");this.D=new $9j(this.Ba,this.ma.C,this.C.D);this.Ea(this.D);var d=this.V,e=Fwb(this.O),f=Gwb(this.O),h=this.R,k=this.Ua,l=this.Ra,m=ua(this.X.V,this.X),p=ua(this.D.C,this.D),r=(Is(),YNb),t=this.Pa,v=this.Ya,y=this.Ba,G=eu(du.sb()),M=this.C.va.C;G=void 0===G?
!1:G;c=void 0===c?!1:c;var S=pf();S=new Res(wf(S,"maestro_container_token"),wf(S,"maestro_domain"),wf(S,"maestro_script_editor_uri"),wf(S,"maestro_new_project_uri"),of(S,"docs-emae"),wf(S,"mae-pai"),of(S,"mae-cwssw"),of(S,"mae-aoeba"),of(S,"mae-esme"),wf(S,"mae-dret"),wf(S,"mae-ses"),of(S,"docs-tdd"),of(S,"mae-seitd"));e=new pes(d.F,String(y),e,void 0);y=new sfs;y.bind(f);f=S.C?2:S.D?0:1;var Y=new xs(void 0,void 0,!0,Pt.sb());l=l?new Pfs(l,Y,f,M,void 0):null;d=new Ogs(d,S,e,y,h,k,l,m,p,r,t,v,G,rhs,
ZSd,b,c);d.Ea(e);d.Ea(y);d.start();U("macros-addon-sidebar").Xa(Pgs(r));U("macros-addon-sidebar-focus").Xa(Qgs(r,c||!1));U("macros-application-focus").Xa(!0);U("macros-application-sidebar").Xa(!0);U("macros-editor").Xa(!S.oa||S.F);U("macros-exec").Xa(!0);U("macros-extension-disabled").Xa(!0);U("macros-extension-help").Xa(!0);U("macros-extension-install-start").Xa(!0);U("macros-extension-menu-promo").Xa(!0);U("macros-manage").Xa(!0);U("macros-resume").Xa(!0);U("macros-trigger-0").Xa(!0);U("macros-trigger-1").Xa(!0);
U("macros-trigger-2").Xa(!0);U("macros-trigger-3").Xa(!0);U("macros-trigger-4").Xa(!0);U("macros-trigger-5").Xa(!0);U("macros-trigger-6").Xa(!0);U("macros-trigger-7").Xa(!0);U("macros-trigger-8").Xa(!0);U("macros-trigger-9").Xa(!0);null!=this.H&&(a=of(a,"docs-isctp"),this.H.ma=a,this.J.listen(d.J,"scpep",ua(this.Ka,this)));this.J.listen(Pw,"runMacro",ua(this.Fa,this))};shs.prototype.Ka=function(a){null!=this.H&&(a=mk(a.lk(),1),this.H.ma=a)};
shs.prototype.Fa=function(a){var b=a.payload;a=Ef(Vk().xca()(),Lva);a=If(a,function(c){return c.getFunctionName()==b});null!=a&&ej(a,1)?U("macros-exec").hc(new Bds(ij(a,1),b,void 0,void 0,void 0,ej(a,12)?a.kB():void 0)):Qw("Script function "+(b+" could not be found"))};function ths(a){var b=a.Bnb;a='<div class="waffle-record-script-dialog-name-section"><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-name-input" id="waffle-record-script-name-input-label">Name</label></div><div class="waffle-record-script-name"><input class="waffle-record-script-name-input jfk-textinput" id="waffle-record-script-name-input" maxlength="50" aria-labelledby="waffle-record-script-dialog-description-id waffle-record-script-name-input-label"/></div></div><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-shortcut-input">Shortcut (optional)</label></div><div class="waffle-record-script-shortcut"><label for="waffle-record-script-shortcut-input" id="waffle-record-script-shortcut-input-label">'+
(Eq(b)+'</label><input class="waffle-record-script-shortcut-input jfk-textinput" id="waffle-record-script-shortcut-input" maxlength="1" aria-labelledby="waffle-record-script-shorcut-description-id"/><div id="waffle-record-script-shorcut-description-id" style="display:none;">');b="Optional numeric shortcut key, use with "+(Eq(b)+" to run macro.");return Fq(a+b+"</div></div>")};function uhs(a,b){wt.call(this,void 0,void 0,b);this.hB=!1;tr(this,!1);this.F=new it;this.Na(this.F);this.H=new GY(this.Da());this.Na(this.H);this.O=new it("Number");this.Na(this.O);this.C=new GY(this.Da());this.Na(this.C);ur(this,(new sr).Fj({key:"discard",caption:"Discard"},!1).Fj($Ib,!0))}z(uhs,wt);u=uhs.prototype;
u.Ha=function(){wt.prototype.Ha.call(this);of(pf(),"docs-egmd")?($q(qr(this),"waffle-record-script-dialog-gm"),zr(this,"save")):$q(qr(this),"waffle-record-script-dialog");this.setTitle("Save new macro");this.Mc().appendChild(Dq(ths,{Bnb:fp?"\u2318 + Option + Shift +":"Ctrl + Alt + Shift +"}))};
u.Oa=function(){wt.prototype.Oa.call(this);this.F.yb(this.Ia("waffle-record-script-name-input"));of(pf(),"docs-egmd")||$q(this.Ia("waffle-record-script-name"),u0k.sb().Bd());this.F.setValue("Untitled Macro");var a=this.F.Sa();this.H.setPosition(3,2);this.H.render();this.H.gp(a);JY(this.H,a);IY(this.H);this.O.yb(this.Ia("waffle-record-script-shortcut-input"));of(pf(),"docs-egmd")||$q(this.Ia("waffle-record-script-shortcut"),u0k.sb().Bd());var b=this.O.Sa();this.C.setPosition(3,2);this.C.render();this.C.gp(b);
JY(this.C,b);IY(this.C);this.getHandler().listen(this,"dialogselect",this.M5c).listen(a,["focus","blur","change"],this.xDc).listen(b,["focus","blur","change"],this.MJc)};u.focus=function(){wt.prototype.focus.call(this);jt(this.F)};u.xDc=function(){""!=this.F.getValue()&&IY(this.H)};u.MJc=function(){vhs(this)&&IY(this.C)};
u.M5c=function(a){var b=this,c=yp(new xp,12).build();if("discard"==a.key)Sac.hc(void 0,c);else if("save"==a.key)if(""!=this.F.getValue()||HY(this.H,"Must not be empty.",!0),vhs(this)||setTimeout(function(){HY(b.C,"Must be a number from 0 to 9 or blank.",!0)}),whs(this)&&setTimeout(function(){HY(b.C,"Conflicts with another shortcut.",!0)}),""!=this.F.getValue()&&vhs(this)&&!whs(this)){a=this.F.getValue();var d=this.O.getValue();bbc.hc(new Xgs(a,d),c)}else a.preventDefault()};
function vhs(a){a=a.O.getValue();return""==a||/^\d$/.test(a)}function whs(a){var b="Ctrl+Alt+Shift+"+a.O.getValue();return Vk().xca()().map(Lva).some(function(c){return ej(c,9)&&ij(c,9)==b})};function xhs(){ho.apply(this,arguments)}z(xhs,ho);xhs.prototype.F=function(){return shs};xhs.prototype.H=function(){return uhs};xhs.prototype.C=function(a,b,c){return new fds(a,b,c,void 0)};xhs.prototype.D=function(a,b,c){return new vds(a,b,c,void 0)};vo("ritzmaestro",xhs);
