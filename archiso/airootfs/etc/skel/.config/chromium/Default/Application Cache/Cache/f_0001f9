function K9g(a){C.call(this,a)}v(K9g,C);K9g.prototype.getStatus=function(){return this.message.getStatus()};function L9g(a){this.gb=ch(a,-1,0)}v(L9g,eh);L9g.prototype.toBuilder=function(){return new K9g(this)};L9g.prototype.getStatus=function(){return qh(this,1,0)};function M9g(a){C.call(this,a)}v(M9g,C);function N9g(a){this.gb=ch(a,-1,0)}v(N9g,eh);N9g.prototype.toBuilder=function(){return new M9g(this)};function O9g(a){C.call(this,a)}v(O9g,C);O9g.prototype.getStatus=function(){return this.message.getStatus()};
function P9g(a){this.gb=ch(a,-1,0)}v(P9g,eh);P9g.prototype.toBuilder=function(){return new O9g(this)};P9g.prototype.getStatus=function(){return qh(this,1,0)};function Q9g(a,b){return new Sm(function(c,d){qH(a,"/dbx/createSchedule",[],b.qb(),function(e){c(fh(L9g,JSON.stringify(e.ze())))},d)})}function R9g(a,b){return new Sm(function(c,d){qH(a,"/dbx/updateSchedule",[],b.qb(),function(e){c(fh(P9g,JSON.stringify(e.ze())))},d)})}
function S9g(a){if(!N().ffa()(a)||N().$pb()(a))return!1;a=N().yE()(a);return k2b.has(a)}function T9g(a){var b=[];a=ha(a.C.keys());for(var c=a.next();!c.done;c=a.next())c=c.value,S9g(c)&&b.push(c);return b}function U9g(a){if(a.R.Bf())return[];var b=[];a.C.forEach(function(c,d){Y1b.has(c.D)&&S9g(d)&&b.push(d)});return b}function V9g(a,b,c){this.C=a;this.F=b;this.D=void 0===c?null:c}function W9g(a){a.ub()&&n$e(a.F)}function X9g(){var a=void 0===a?gh(NUe):a;return new MUe(a)}
function Y9g(){var a=void 0===a?gh(PUe):a;return new OUe(a)}function Z9g(a){C.call(this,a)}v(Z9g,C);function $9g(a,b){return Eh(a,1,b)}function a$g(a){this.gb=ch(a,-1,0)}v(a$g,eh);a$g.prototype.toBuilder=function(){return new Z9g(this)};function b$g(){var a=void 0===a?gh(a$g):a;return new Z9g(a)}function c$g(a){C.call(this,a)}v(c$g,C);function d$g(a,b){return yh(a,1,b)}function e$g(a,b){return Eh(a,2,b)}function f$g(a){this.gb=ch(a,-1,0)}v(f$g,eh);f$g.prototype.toBuilder=function(){return new c$g(this)};
function g$g(){var a=void 0===a?gh(f$g):a;return new c$g(a)}function f3(a,b,c,d){S.call(this,d);this.Ya=c;this.Wa=a;this.state=3;this.C=null;this.Qa=this.xa=!1;this.$a=new ju(this);this.qa(this.$a);this.Ta=new e8e(500,500,"dbxScheduleOnCompleteAuth");this.qa(this.Ta);h$g(this)}v(f3,S);function h$g(a){a.$a.wb(Tfb,mp,function(b){b=b.data;i$g(a,36713,b);j$g(a,b,null)}).wb(Ufb,mp,function(b){b=b.data;i$g(a,36714,b);k$g(a,b,null)}).wb(Vfb,mp,a.ib).wb(Wfb,mp,a.hb).wb(Ix,lp,a.refresh)}
function j$g(a,b,c,d){d=void 0===d?!0:d;var e=$9g(b$g(),b);c&&yh(e,2,c);Q9g(pH.getInstance(),e.build()).then(function(f){return l$g(a,b,f.getStatus(),mh(f,2),!0,d)},function(){a.bma()})}function k$g(a,b,c,d){d=void 0===d?!0:d;var e=e$g(d$g(g$g(),a.C.getId()),b);c&&yh(e,3,c);R9g(pH.getInstance(),e.build()).then(function(f){return l$g(a,b,f.getStatus(),mh(f,2),!1,d)},function(){a.bma()})}
f3.prototype.ib=function(){if(Ix.isEnabled()){var a=$T(this.C);i$g(this,36715,a);a=a.toBuilder().Na(!0).build();k$g(this,a,null)}};f3.prototype.hb=function(){if(Ix.isEnabled()){var a=$T(this.C);i$g(this,36716,a);a=a.toBuilder().Na(!1).build();k$g(this,a,null)}};function i$g(a,b,c){var d=new dRd;c=m$g(c.Hi());d=K(d,10,c);d=mRe(d);d=pq(mq(new lq,75),d).build();a.Ya.C(b,d)}function m$g(a){switch(a.Hi()){case 4:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 0:return 0}}
function n$g(a){a.state=3;a.refresh();pVe().then(function(b){a.isDisposed()||(b=rh(b,1,ZUe).Eb(),0==b.length?(a.state=1,a.C=null):(a.state=4,a.C=b[0]),a.Qa?(a.Qa=!1,a.show()):a.refresh())},function(){Ju.getInstance().postMessage(Qu("Error loading schedule configuration.","error",!0))})}function o$g(a){return a.C&&kh($T(a.C),1)?(oh(a.C.getStatus(),1),!0):!1}
function l$g(a,b,c,d,e,f){a.ZFa(!0);switch(c){case 1:a.focus();n$g(a);LG.dispatchEvent("load-schedules-on-config-bar");break;case 2:if(!f)break;f8e(a.Ta,d,function(h){a.isDisposed()||(a.ZFa(!1),e?j$g(a,b,h,!1):k$g(a,b,h,!1))});break;default:a.bma()}}f3.prototype.show=function(){3==this.state?this.Qa=!0:(this.Ya.C(116122),this.state=1==this.state?2:5,this.refresh())};function p$g(a,b){Znf.call(this,a,b)}v(p$g,Znf);p$g.prototype.ma=function(){this.refresh()};p$g.prototype.refresh=function(){if(this.ub()){var a=Ix.isEnabled();a=this.H&&this.J&&a&&0<U9g(this.L).length;this.C.Na(a)}};p$g.prototype.O=m("Refresh all");function q$g(a,b){a=a||{};var c={};var d=c.color;c=c.qF;c=Dr(c,null)?18:c;d='<svg xmlns="http://www.w3.org/2000/svg" width="'+U(c)+'px" height="'+U(c)+'px" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-2 -2)"><polygon points="0 0 24 0 24 24 0 24"/><path fill="'+U(Dr(d,null)?"#188038":d)+'" fill-rule="nonzero" d="M22,4 L22,10 L16,10 L16,8 L18.91,8 C17.53,5.61 14.96,4 12,4 C7.58,4 4,7.58 4,12 C4,16.42 7.58,20 12,20 C16.42,20 20,16.42 20,12 L22,12 C22,17.52 17.52,22 11.99,22 C6.47,22 2,17.52 2,12 C2,6.48 6.47,2 11.99,2 C15.27,2 18.17,3.58 20,6.01 L20,4 L22,4 Z M13,12 L13,6 L11,6 L11,13 L15.97,16.49 L17.23,14.94 L13,12 Z"/></g></svg>';
d=T(d);a=""+EV(Cr({title:"Refresh options",Zu:"waffle-dataconnector-refresh-sidebar",AB:Fr(""+d),Mk:Fr('<div class="'+U("waffle-dataconnector-refresh-sidebar-container")+'"><div class="'+U("waffle-dataconnector-refresh-sidebar-refresh-widget")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-sidebar-backdrop")+'"></div>'),NX:!0,$R:Fr('<div class="'+U("waffle-dataconnector-refresh-sidebar-footer-wrapper")+'"></div>')},a),b);return T(a)};function r$g(){}v(r$g,Kt);r$g.prototype.Rb=m("docs-calendar-select");r$g.prototype.Go=function(a){a=a.Ca("DIV",["docs-calendar-select-dropdown","docs-gm-arrow","goog-inline-block"],a.Ca("DIV",["docs-icon","goog-inline-block"],a.Ca("DIV",["docs-icon-img-container","docs-icon-img","docs-icon-arrow-dropdown"])));bs(a,"docs-material");return a};Ba(r$g);function s$g(){return T('<div class="'+U("waffle-dataconnector-refresh-date-input-date-select")+'"></div><div class="'+U("waffle-dataconnector-refresh-date-input-date-picker")+'"></div>')};function t$g(a,b,c){a=void 0===a?0:a;b=void 0===b?YO.getInstance():b;S.call(this,c);this.F=new PV(a,b,c);this.Ga(this.F);this.D=null;this.C=new Date;this.C.setMinutes(0);this.C.setSeconds(0);this.C.setMilliseconds(0);this.F.setValue(u$g(this.C))}v(t$g,S);p=t$g.prototype;p.Ca=function(){S.prototype.Ca.call(this);this.kb(yr(s$g))};p.Ia=function(){S.prototype.Ia.call(this);this.F.render(this.Da("waffle-dataconnector-refresh-date-input-date-select"));this.getHandler().listen(this.F,"action",this.Njc)};
p.getDate=g("C");function u$g(a){return(new Jw(Lw.MONTH_DAY_YEAR_MEDIUM)).format(a)}p.Njc=function(){var a=this;null==this.D?v$g(this,function(){return w$g(a)}):w$g(this)};function w$g(a){a.D.position(a.Ka());null!=a.F.getValue()&&a.D.jtc(a.getDate())}function v$g(a,b){to("datepicker",function(){var c=wo("datepicker");a.D=c.C(a.oa());a.Ga(a.D);a.D.render(a.Da("waffle-dataconnector-refresh-date-input-date-picker"));a.D.Tcc();a.getHandler().listen(a.D,"change",a.FFb);b()})}
p.FFb=function(a){this.setDate(new Date(a.C.getTime()));this.D.hide()};p.setDate=function(a){this.C=new Date(a);this.C.setMinutes(0);this.C.setSeconds(0);this.C.setMilliseconds(0);this.F.setValue(u$g(a))};var x$g=new nv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function y$g(a,b){a=void 0===a?lD.getInstance():a;for(var c=new Ht,d=1;28>=d;d++)c.Ga(new Ct(x$g.format({DAY:d}),d),!0);zU.call(this,c,a,b)}v(y$g,zU);function z$g(){return T('<div class="'+U("waffle-dataconnector-refresh-day-of-month-widget")+'"><div><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-day-of-month-widget-label")+'"></div><div class="'+U("waffle-dataconnector-refresh-day-of-month-widget-add-day-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-day-of-month-widget-chip-container")+'"></div></div>')};var A$g=new nv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function B$g(a){S.call(this,a);this.Tj=new S;this.Ga(this.Tj);this.C=new y$g(qt.getInstance(),a);Zt(this.C,"Add day");this.Ga(this.C);this.D=new C$g}v(B$g,S);p=B$g.prototype;p.Ca=function(){S.prototype.Ca.call(this);this.kb(yr(z$g));this.Tj.Va(this.Da("waffle-dataconnector-refresh-day-of-month-widget-chip-container"));this.C.render(this.Da("waffle-dataconnector-refresh-day-of-month-widget-add-day-select"))};
p.Ia=function(){S.prototype.Ia.call(this);ym(this.Da("waffle-dataconnector-refresh-day-of-month-widget-label"),"Repeat on");this.getHandler().listen(this.C,"change",this.cmc).listen(this,"He",this.eoc)};p.cmc=function(){var a=this.C.getValue();Xt(this.C.qk,null);D$g(this,a);this.dispatchEvent("change")};p.eoc=function(a){a=a.target;var b=qr(this.Tj,a);this.D.remove(b)&&(this.Tj.removeChild(a,this.ub()),this.dispatchEvent("change"))};
function D$g(a,b){if(!a.D.has(b)){var c=new c8e(A$g.format({DAY:b}),a.oa());b=a.D.add(b);a.Tj.zf(c,b,a.ub())}}p.Kd=function(){return this.D.C};function E$g(a,b){for(var c=0;c<b.length;c++)D$g(a,b[c])}function C$g(){this.C=[]}C$g.prototype.add=function(a){var b=Hd(this.C,a);yd(this.C,a,-b-1);return-b-1};C$g.prototype.has=function(a){return-1<hd(this.C,a)};C$g.prototype.remove=function(a){return Bd(this.C,a)};function F$g(){}v(F$g,Rod);F$g.prototype.Ca=function(a){return a.oa().Ca("INPUT",{type:"number",max:"100",min:"1"})};Ba(F$g);function G$g(){var a='<div class="'+U("waffle-dataconnector-refresh-schedules-new-widget")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-header")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-top-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-header-title")+'"><span tabindex="0" class="'+U("waffle-dataconnector-refresh-schedules-new-title")+'" role="heading">';a=a+'Scheduled refresh</span></div><div class="'+(U("waffle-dataconnector-refresh-schedules-new-enable-switch")+
'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-spinner")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-setup-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-overview-section")+'"><span class="'+U("waffle-dataconnector-refresh-schedules-new-overview-text")+'"></span><span class="'+U("waffle-dataconnector-refresh-schedules-new-edit-btn")+'"></span></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-fullview-section")+
'"><div class="waffle-dataconnector-refresh-schedules-new-fullview-text"></div><div><span class="'+U("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(U("waffle-dataconnector-refresh-schedules-new-edit-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-schedules-new-repeat-every-label")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+
'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-interval-input")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-frequency-select")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+U("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-day-of-month-widget")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+
'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-weekday-select")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-schedules-new-repeat-at-label")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+U("waffle-dataconnector-refresh-schedules-new-time-select-label")+
'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-time-select")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-schedules-new-start-date-label")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-start-date-select")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-start-time-select")+
'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-owner-info")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-btns")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-cancel-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-save-btn")+'"></div></div></div></div>');return T(a)};function H$g(){for(var a='<div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-weekday-select-label")+'"></div><div style="display: flex">',b=0;7>b;b++)a+='<div data-index="'+U(b)+'" class="'+U("waffle-dataconnector-refresh-weekday-select")+'"></div>';return T(a+"</div>")};function I$g(a){a=a.name;return T('<div class="'+U("waffle-dataconnector-refresh-weekday-toggle")+'">'+Br(a)+"</div>")};function J$g(a,b,c){rt.call(this,void 0,K$g.getInstance(),c);this.D=a;this.C=b;this.Sf(16,!0)}v(J$g,rt);J$g.prototype.Fn=function(a){rt.prototype.Fn.call(this,a);this.isEnabled()&&this.dispatchEvent("change")};J$g.prototype.getName=g("D");function K$g(){}v(K$g,qt);K$g.prototype.Ca=function(a){var b=yr(I$g,{name:a.getName()});cs(b,this.Oo(a));return b};K$g.prototype.Rb=m("waffle-dataconnector-refresh-weekday-toggle");Ba(K$g);function L$g(a){S.call(this,a);this.C=M$g(this,a)}v(L$g,S);L$g.prototype.Ca=function(){S.prototype.Ca.call(this);this.kb(yr(H$g))};L$g.prototype.Ia=function(){var a=this;S.prototype.Ia.call(this);ym(this.Da("waffle-dataconnector-refresh-weekday-select-label"),"Repeat on");this.C.forEach(function(b,c){b.render(a.Gf("waffle-dataconnector-refresh-weekday-select")[c]);Yr(b.Ka(),Ew.WEEKDAYS[c])})};L$g.prototype.Kd=function(){return this.C.filter(function(a){return a.isChecked()}).map(function(a){return a.C})};
function M$g(a,b){var c=(Ew.FIRSTDAYOFWEEK+1)%7,d=Ew.NARROWWEEKDAYS.map(function(e,f){return new J$g(e,(f+6)%7+1,b)});d=d.slice(c).concat(d.slice(0,c));d.forEach(function(e){return a.Ga(e)});return d};function N$g(){}v(N$g,Rod);N$g.prototype.Ca=function(a){a=a.oa().Ca("INPUT",{type:"text"});a.setAttribute("readonly","readonly");return a};Ba(N$g);var O$g=new nv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function P$g(a,b,c,d){f3.call(this,a,b,c,d);this.O=new U8e(0,F$g.getInstance(),d);this.O.setValue("1");this.Ga(this.O);a=new Ht;a.Ga(new Ct("hours",4),!0);a.Ga(new Ct("days",1),!0);a.Ga(new Ct("weeks",2),!0);a.Ga(new Ct("months",3),!0);this.D=new zU(a,r$g.getInstance(),d);Zt(this.D,"Add frequency");this.D.Dc("waffle-dataconnector-refresh-schedule-frequency");this.Ga(this.D);this.J=new B$g(d);this.Ga(this.J);this.Aa=new L$g(d);this.Ga(this.Aa);this.H=new zU(Q$g(),r$g.getInstance(),d);Zt(this.H,"Add time");
this.H.Dc("waffle-dataconnector-refresh-schedule-time");this.Ga(this.H);this.Ha=new t$g(0,N$g.getInstance(),d);this.ma=new zU(Q$g(),r$g.getInstance(),d);Zt(this.ma,"Add time");this.Ga(this.Ha);this.R=new XO("Cancel");this.Ga(this.R);this.ea=new rw("Save",d);this.ea.Na(!1);this.Ga(this.ea);this.Ba=new rt("",ZG.getInstance(),d);this.Ga(this.Ba);this.Pa=new rt("Setup now",ZG.getInstance(),d);this.Ga(this.Pa);this.Oa=new rt("",ZG.getInstance(),d);this.Ga(this.Oa);this.F=new cS(d);this.F.xe("Enable schedule");
this.Ga(this.F);this.La=b;this.L=new J8e(d);this.L.Sb("waffle-dataconnector-refresh-schedules-new-info-icon");this.L.setVisible(!1);this.pb=new aV(!0,"#0f9d58")}v(P$g,f3);p=P$g.prototype;
p.Ca=function(){f3.prototype.Ca.call(this);this.kb(yr(G$g));var a=this.Da("waffle-dataconnector-refresh-schedules-new-title");a.id=nr(this,"waffle-dataconnector-refresh-schedules-new-title");Tr(a,"heading");Vr(this.Ka(),"labelledby",a.id);a=this.L.C;a.setContent(Ze("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.L.render(this.Da("waffle-dataconnector-refresh-schedules-new-header-title"));a=a.xb();Vr(this.L.Ka(),
"labelledby",a.id)};
p.Ia=function(){f3.prototype.Ia.call(this);this.R.render(this.Da("waffle-dataconnector-refresh-schedules-new-cancel-btn"));this.Ba.render(this.Da("waffle-dataconnector-refresh-schedules-new-edit-btn"));this.F.render(this.Da("waffle-dataconnector-refresh-schedules-new-enable-switch"));this.O.render(this.Da("waffle-dataconnector-refresh-schedules-new-interval-input"));this.D.render(this.Da("waffle-dataconnector-refresh-schedules-new-frequency-select"));this.ea.render(this.Da("waffle-dataconnector-refresh-schedules-new-save-btn"));this.Pa.render(this.Da("waffle-dataconnector-refresh-schedules-new-setup-btn"));
this.Oa.render(this.Da("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn"));this.H.render(this.Da("waffle-dataconnector-refresh-schedules-new-time-select"));this.J.render(this.Da("waffle-dataconnector-refresh-schedules-new-day-of-month-widget"));this.Aa.render(this.Da("waffle-dataconnector-refresh-schedules-new-weekday-select"));this.pb.render(this.Da("waffle-dataconnector-refresh-schedules-new-spinner"));this.Ha.render(this.Da("waffle-dataconnector-refresh-schedules-new-start-date-select"));
this.ma.render(this.Da("waffle-dataconnector-refresh-schedules-new-start-time-select"));g3(this,!1);h3(this,!1);P(this.Da("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),!1);P(this.Da("waffle-dataconnector-refresh-schedules-new-time-select"),!1);P(this.Da("waffle-dataconnector-refresh-schedules-new-start-time-select"),!1);Ot(this.H,new Sr(null,13));Ot(this.ma,new Sr(null,13));ym(this.Da("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),"Repeat at");ym(this.Da("waffle-dataconnector-refresh-schedules-new-repeat-every-label"),
"Repeat every");ym(this.Da("waffle-dataconnector-refresh-schedules-new-start-date-label"),"Start date");var a=this.Da("waffle-dataconnector-refresh-schedules-new-repeat-every-label");a.id=nr(this,"waffle-dataconnector-refresh-schedules-new-repeat-every-label");Vr(this.D.Ka(),"labelledby",a.id);Vr(this.O.Ka(),"labelledby",a.id);a=this.Da("waffle-dataconnector-refresh-schedules-new-repeat-at-label");a.id=nr(this,"waffle-dataconnector-refresh-schedules-new-repeat-at-label");Vr(this.H.Ka(),"labelledby",
a.id);a=this.Da("waffle-dataconnector-refresh-schedules-new-start-date-label");a.id=nr(this,"waffle-dataconnector-refresh-schedules-new-start-date-label");Vr(this.Ha.Ka(),"labelledby",a.id);this.getHandler().listen(this.Ba,"action",this.show).listen(this.R,"action",this.Rjc).listen(this.ea,"action",this.Ujc).listen(this.Pa,"action",this.show).listen(this.F,"action",this.Sjc).listen(this.D,"change",this.Tjc).listen(this.J,"change",this.QJ).listen(this.Aa,"change",this.QJ).listen(this.J,"change",this.QJ).listen(this.H,
"change",this.QJ).listen(this.ma,"change",this.QJ).listen(this.O,"action",this.QJ).listen(this.Oa,"action",this.Vjc).listen(this.Ka(),"keydown",this.Qjc);0<Array.from(this.Wa.C.keys()).length?(P(this.Ka(),!0),n$g(this)):P(this.Ka(),!1)};
p.refresh=function(){if(!this.isDisposed()){var a=this.Da("waffle-dataconnector-refresh-schedules-new-edit-section"),b=this.Da("waffle-dataconnector-refresh-schedules-new-overview-section"),c=this.Da("waffle-dataconnector-refresh-schedules-new-fullview-section"),d=this.Da("waffle-dataconnector-refresh-schedules-new-owner-info"),e=this.Da("waffle-dataconnector-refresh-schedules-new-setup-btn"),f=this.Da("waffle-dataconnector-refresh-schedules-new-enable-switch"),h=this.Da("waffle-dataconnector-refresh-schedules-new-spinner");
P(e,!1);P(f,!1);P(a,!1);P(b,!1);P(c,!1);P(d,!1);P(h,!1);fs(this.Ka(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!1);var k=!1;this.L.setVisible(!1);switch(this.state){case 1:P(e,!0);break;case 2:P(c,!0);P(a,!0);P(d,!0);fs(this.Ka(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!0);k=!0;R$g(this);S$g(this);this.QJ();this.R.Na(!0);this.L.setVisible(!0);E$g(this.J,[Math.min((new Date).getDate(),28)]);break;case 3:P(h,!0);break;case 5:P(c,!0);P(f,!0);P(a,!0);P(d,!0);fs(this.Ka(),
"waffle-dataconnector-refresh-schedules-new-widget-opened",!0);k=!0;T$g(this);R$g(this);S$g(this);a=$T(this.C);this.F.Gb(!!kh(a,1));b=a.Hi().Hi();this.D.setValue(b);switch(b){case 4:h3(this,!1);g3(this,!1);break;case 1:h3(this,!1);g3(this,!1);this.H.setValue(ph(a.Hi(),2));break;case 2:h3(this,!0);g3(this,!1);c=this.Aa;d=rR(a.Hi(),4).Eb();e=ha(c.C);for(f=e.next();!f.done;f=e.next())f.value.Gb(!1);for(e=0;e<c.C.length;e++)f=c.C[e],0<=d.indexOf(f.C)&&f.Gb(!0);this.H.setValue(ph(a.Hi(),2));break;case 3:h3(this,
!1),g3(this,!0),E$g(this.J,rR(a.Hi(),5).Eb()),this.H.setValue(ph(a.Hi(),2))}c=ih(a.Hi(),7)?new Date(oh(a.Hi(),7)):new Date;this.Ha.setDate(c);4===b?this.ma.setValue(c.getHours()):this.H.setValue(ph(a.Hi(),2));this.O.setValue(qh(a.Hi(),6,1).toString());this.QJ();this.R.Na(!0);this.L.setVisible(!0);break;case 4:P(f,!0),P(b,!0),T$g(this),b=this.Da("waffle-dataconnector-refresh-schedules-new-overview-text"),o$g(this)?(a=this.C.getStatus(),ym(b,"Next: "),b=new Date(1E3*oh(a,2)),a=new Date(1E3*oh(a,3)),
this.Ba.setContent(Mm(this.oa(),m9e(b,a,this.La,!0,!0)))):(ym(b,"Paused"),this.Ba.setContent("Edit"))}this.xa!=k&&(this.xa=k,this.dispatchEvent(k?"oj":"nj"))}};function T$g(a){var b=!!kh($T(a.C),1),c=Ix.isEnabled();a.F.Gb(b);a.F.Na(c)}function R$g(a){var b=a.Da("waffle-dataconnector-refresh-schedules-new-owner-info"),c="Will run as you.";a.C&&(a=mh(a.C.rb(4,N9g),1))&&(c+=" Currently running as "+a);ym(b,c)}
function S$g(a){var b=a.Da("waffle-dataconnector-refresh-schedules-new-fullview-text");if(o$g(a)){var c=a.C.getStatus(),d=new Date(1E3*oh(c,2));c=new Date(1E3*oh(c,3));var e=a.oa();e.xd(b);e.appendChild(b,Mm(e,cf(Ze("Next: "),m9e(d,c,a.La,!1,!0))))}else ym(b,"");a.Oa.setContent(l9e(a.La))}p.Rjc=function(){U$g(this)};function U$g(a){a.state=2==a.state?1:4;a.refresh();a.Da("waffle-dataconnector-refresh-schedules-new-title").focus()}
p.Tjc=function(){switch(this.D.getValue()){case 4:h3(this,!1);g3(this,!1);V$g(this,!0);break;case 1:h3(this,!1);g3(this,!1);V$g(this,!1);break;case 2:g3(this,!1);h3(this,!0);V$g(this,!1);break;case 3:h3(this,!1),g3(this,!0),V$g(this,!1)}this.QJ()};function V$g(a,b){P(a.Da("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),!b);P(a.Da("waffle-dataconnector-refresh-schedules-new-time-select"),!b);P(a.Da("waffle-dataconnector-refresh-schedules-new-start-time-select"),b)}
p.Ujc=function(){this.ea.Na(!1);this.R.Na(!1);var a=this.D.getValue(),b=X9g().AP(a);if(2===a)for(var c=ha(this.Aa.Kd()),d=c.next();!d.done;d=c.next())Voa(b,4,d.value);else if(3===a)for(c=ha(this.J.Kd()),d=c.next();!d.done;d=c.next())Voa(b,5,d.value);d=this.Ha.getDate();4===a&&d.setHours(this.ma.getValue());d=d.getTime();zh(b,7,d);4!==a&&(a=this.H.getValue(),Ah(b,2,a));a=parseInt(this.O.getValue(),10);Ah(b,6,a);b=Ah(Y9g().AP(b),3,1);2==this.state?(b.Na(!0),Tfb.ob(b.build())):(b.Na(this.F.isChecked()),
Ufb.ob(b.build()))};p.Sjc=function(){var a=this;if(4==this.state){var b=this.F.isChecked();this.F.Gb(!b);this.F.Na(!1);if(b){var c=W$g(this);c.render();c.setVisible(!0);c.getResult().then(function(){Yf(c);Vfb.ob()},function(){Yf(c);T$g(a)})}else Wfb.ob()}};p.Qjc=function(a){27==a.keyCode&&this.xa&&(U$g(this),a.stopPropagation())};p.Vjc=function(){lA.ob()};
p.QJ=function(){var a=!!this.D.rf(),b=3!==this.D.getValue()||0<this.J.Kd().length,c=2!==this.D.getValue()||0<this.Aa.Kd().length,d=!!this.H.rf()||4===this.D.getValue(),e=!!this.ma.rf()||4!==this.D.getValue(),f=Ix.isEnabled(),h=parseInt(this.O.getValue(),10);this.ea.Na(a&&b&&c&&d&&e&&f&&0<h&&100>=h)};p.focus=function(){this.Da("waffle-dataconnector-refresh-schedules-new-title").focus()};p.ZFa=function(a){this.F.Na(a)};
function g3(a,b){P(a.Da("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget"),b)}function h3(a,b){P(a.Da("waffle-dataconnector-refresh-schedules-new-weekday-select"),b)}
function W$g(a){var b=new Cqf;b.Sb("waffle-dataconnector-refresh-schedules-new-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=$T(a.C);switch(c.Hi().Hi()){case 1:var d="Daily ";break;case 2:d=X$g();var e=rR(c.Hi(),4).Eb();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(rR(c.Hi(),5).Eb().map(function(l){return O$g.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=j9e(a.La);var h=new Date(La()),k=new Date(1E3*oh(f,2));f=new Date(1E3*oh(f,3));d+=k9e(k,f,c)+" ("+l$a(n$a(c,h))+")";a="Will run as "+mh(a.C.rb(4,N9g),1);a=cf(Ze("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),bf("H4",void 0,"Schedule"),Ze(d),bf("BR"),Ze(a));rs(b,a);return b}
p.bma=function(){Ju.getInstance().postMessage(Qu("Error saving schedule.","error",!0));this.ea.Na(!0);this.R.Na(!0);this.F.Na(!0)};function X$g(){var a=(Ew.FIRSTDAYOFWEEK+1)%7,b=Ew.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))}
function Q$g(){for(var a=new Ht,b=new Date(La()),c=Array(24),d=0;24>d;d++){b.setHours(d,0,0,0);var e=new Date(b.getTime()),f=new Date(b.getTime());f.setHours(e.getHours()+1);f=k9e(e,f);c[e.getHours()]={value:d,label:f}}for(b=0;24>b;b++)d=new Ct(c[b].label,c[b].value),a.Ga(d,!0);return a};function Y$g(a,b,c){B.call(this);this.H=a;this.J=b;this.L=c;this.D=[];this.F=[];this.C=[]}v(Y$g,B);Y$g.prototype.Ma=function(){Z$g(this);B.prototype.Ma.call(this)};function $$g(a,b,c){var d=VG(a.H);b.forEach(function(e){var f=e.rect;f&&WC(f)&&(d&&ZT(a.H)==e.gid?(e=Nvc(d,f,aah(c)),a.qa(e),e.setVisible(!0),a.D.push(e)):bah(a,e.gid,c))})}
function cah(a,b,c){var d=VG(a.H);b.forEach(function(e){if(d){var f=nL(d.J,e);if(f&&f.ub()&&f instanceof Rpf){a.C.push(f);bs(yX(f.D),aah(c));return}}(e=a.L.J.Tk(e))&&bah(a,e.fb(),c)})}function bah(a,b,c){b=PWe(a.J,b);bs(b.Ka(),aah(c));a.F.push(b)}function aah(a){return a?"waffle-dataconnector-refreshall-highlight-valid":"waffle-dataconnector-refreshall-highlight-error"}
function Z$g(a){Zf(a.D);a.D=[];a.F.forEach(function(b){es(b.Ka(),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.F=[];a.C.forEach(function(b){es(yX(b.D),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.C=[]};function dah(){return T('<div class="'+U("waffle-dataconnector-refresh-all-pane")+'"><div class="'+U("waffle-dataconnector-refresh-all-datasources-container")+'"></div></div>')}function eah(){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-items-container")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-container")+'"></div>')}
function fah(a,b){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title")+'"></div>'+eah(null,b))}function gah(){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper")+'"></div></div>')}
function hah(a){a=a.title;a='<div class="'+U("waffle-dataconnector-refresh-all-dbobject-item")+'" tabindex="0"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-wrapper")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh")+'">'+CUb(null)+'</div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-title")+'" role="heading">'+Br(a)+'</div><div class="'+
U("waffle-dataconnector-refresh-all-dbobject-item-status-wrapper")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-timestamp")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-error")+'">';a=a+'Error</div><div class="'+(U("waffle-dataconnector-refresh-all-dbobject-item-loading")+'">');a=a+'Loading\u2026</div><div class="'+(U("waffle-dataconnector-refresh-all-dbobject-item-running")+'">');return T(a+"Running\u2026</div></div></div>")};function iah(a,b,c,d,e,f,h){S.call(this,h);this.F=a;this.ma=b;this.ea=c;this.R=d.O;this.L=e;this.C=new Y$g(e,f,d);this.qa(this.C);this.O=new Dlc;this.H=new aV(!1,"#0f9d58");this.D=this.J=!0}v(iah,S);p=iah.prototype;p.Ca=function(){this.kb(yr(hah,{title:this.ma}));var a=this.Da("waffle-dataconnector-refresh-all-dbobject-item-title");a.id=nr(this,"waffle-dataconnector-refresh-all-dbobject-item-title");Tr(a,"heading");Vr(this.Ka(),"labelledby",a.id)};
p.Ia=function(){S.prototype.Ia.call(this);bs(this.Ka(),"waffle-dataconnector-refresh-all-dbobject-item-enabled");this.H.render(this.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"));this.getHandler().listen(this.Ka(),"click",this.V3a).listen(this.Ka(),"keydown",this.Pjc).listen(this.Ka(),["mouseenter","focus"],this.Ojc).listen(this.Ka(),["mouseleave","blur"],this.TDb);jah(this)};
function jah(a){var b=aU(a.R,a.F),c=b.getType(),d=a.Ka();switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":case "offline":hs(d,"valid-highlight","error-highlight");a.D=!1;break;case "loading":case "no-results":case "fetch-successful":hs(d,"error-highlight","valid-highlight");a.D=!0;break;case "fetching-results":case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":kah(a,
"waffle-dataconnector-refresh-all-dbobject-item-error");lah(a);break;case "offline":lah(a);break;case "loading":kah(a,"waffle-dataconnector-refresh-all-dbobject-item-loading");mah(a);break;case "fetching-results":kah(a,"waffle-dataconnector-refresh-all-dbobject-item-running");mah(a);break;case "no-results":nah(a);lah(a);break;case "fetch-successful":b=oh(b.C,8);b=a.O.format(b);ym(a.Da("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);Yr(a.Da("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),
b);kah(a,"waffle-dataconnector-refresh-all-dbobject-item-timestamp");lah(a);break;case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}}p.Na=function(a){this.J=a;var b=this.Ka();this.oa().Ai(b,a);a?hs(b,"waffle-dataconnector-refresh-all-dbobject-item-disabled","waffle-dataconnector-refresh-all-dbobject-item-enabled"):hs(b,"waffle-dataconnector-refresh-all-dbobject-item-enabled","waffle-dataconnector-refresh-all-dbobject-item-disabled")};
p.Ojc=function(){var a=this;switch(this.ea){case 1:case 3:case 5:var b=N().dQa()(this.F,ZT(this.L)).map(function(c){return ID(ao(c))});$$g(this.C,b,this.D);break;case 2:b=N().cQa()(this.F);cah(this.C,b,this.D);break;case 4:N().bQa()(this.F).forEach(function(c){bah(a.C,c,a.D)})}};p.TDb=function(){Z$g(this.C)};function kah(a,b){nah(a);P(a.Da(b),!0)}
function lah(a){a.H.setActive(!1);P(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!1);P(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!0)}function mah(a){a.H.setActive(!0);P(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!1);P(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!0)}p.Pjc=function(a){13===a.keyCode&&this.V3a()};p.V3a=function(){if(this.J){var a=new SD("refresh-db-object-request");a.EOa=this.F;this.dispatchEvent(a)}};
function nah(a){["waffle-dataconnector-refresh-all-dbobject-item-timestamp","waffle-dataconnector-refresh-all-dbobject-item-error","waffle-dataconnector-refresh-all-dbobject-item-loading","waffle-dataconnector-refresh-all-dbobject-item-running"].forEach(function(b){return P(a.Da(b),!1)})};function oah(a,b,c,d,e,f,h,k){S.call(this,k);this.O=a;this.J=new Set(b);this.xa=c;this.R=c.O;this.F=[];this.ea=f;this.ma=h;this.H=d;this.D=this.C=null;e&&(this.C=new pah(this.oa()),this.D=new JV(this.H,this.oa(),!0));this.L=new Map([[1,0],[2,0],[3,0],[4,0],[5,0]])}v(oah,S);p=oah.prototype;p.Ca=function(){if(this.D){var a=im("DIV","waffle-dataconnector-refresh-all-dbobject-list-parent");this.kb(a);this.Ga(this.D,!0);this.D.setContent(yr(eah));bs(this.D.getElement(),"waffle-dataconnector-refresh-all-dbobject-list-collapsible")}else this.kb(yr(fah))};
p.Ia=function(){S.prototype.Ia.call(this);this.D||ym(this.Da("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),this.H);qah(this);rah(this);var a=this.getHandler();this.C&&(this.C.render(this.Da("waffle-dataconnector-refresh-all-dbobject-list-footer-container")),a.listen(this.C,"action",this.SRb))};function sah(a){var b=a.getHandler();a.F.forEach(function(c){b.Lc(c,"refresh-db-object-request",a.SWa)})}
function rah(a){var b=a.getHandler();a.F.forEach(function(c){b.listen(c,"refresh-db-object-request",a.SWa)})}function qah(a){var b=a.Da("waffle-dataconnector-refresh-all-dbobject-list-items-container");a.J.forEach(function(c){var d=N().yE()(c);c=new iah(c,tah(a,d),d,a.xa,a.ea,a.ma,a.oa());a.F.push(c);c.render(b)})}
function tah(a,b){switch(b){case 1:return"Pivot table "+uah(a,1);case 2:return"Chart "+uah(a,2);case 3:return"Function "+uah(a,3);case 4:return"Preview";case 5:return"Extract "+uah(a,5);default:throw Error("Unexpected DbObjectType");}}function uah(a,b){var c=a.L.get(b);a.L.set(b,c+1);return 0==c?"":c.toString()}function vah(a){a.L.forEach(function(b,c,d){return d.set(c,0)})}
p.SRb=function(){var a=this,b=Array.from(this.J).filter(function(c){return Y1b.has(aU(a.R,c).D)});Cfb.ob(new V9g(b,"all-objects-for-single-datasource",this.O))};p.SWa=function(a){a=a.EOa;Y1b.has(aU(this.R,a).D)&&Cfb.ob(new V9g([a],"specific-ids"))};function wah(a){a.F.forEach(function(b){return jah(b)})}function xah(a,b){a.C&&(b=b.filter(function(c){return ih(c,3)&&a.J.has(c.Dm())}),yah(a.C,b))}p.expand=function(){this.D.getHeader().Gb(!0)};p.Rd=g("O");
function zah(a,b){a.H=b;a.D?a.D.getHeader().setContent(b):ym(a.Da("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),b)}p.Na=function(a){this.C&&this.C.Na(a);this.F.forEach(function(b){return b.Na(a)})};function pah(a){S.call(this,a);this.D=new XO("Refresh",this.oa());this.Ga(this.D);this.C=new Ynf;this.Ga(this.C)}v(pah,S);pah.prototype.Ca=function(){this.kb(yr(gah))};
pah.prototype.Ia=function(){S.prototype.Ia.call(this);this.D.render(this.Da("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper"));this.C.render(this.Da("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper"))};function yah(a,b){var c=0;b.forEach(function(d){return c+=parseInt(mh(d,2),10)});q$e(a.C,c);a.D.Na(!0)}pah.prototype.Na=function(a){this.D.Na(a)};function Aah(a,b,c,d){S.call(this,d);this.F=a;this.J=a.O;this.D=new S;this.Ga(this.D);this.C=[];this.H=b;this.L=c}v(Aah,S);Aah.prototype.Ca=function(){this.kb(yr(dah))};Aah.prototype.Ia=function(){var a=this;S.prototype.Ia.call(this);this.D.Va(this.Da("waffle-dataconnector-refresh-all-datasources-container"));Bah(this);this.getHandler().listen(this.F.C,"wa",function(b){return Cah(a,b)})};
function Bah(a){var b=a.D.xd(!0);Zf(b);a.C=[];b=Dah(a);if(1==b.size)b=b.entries().next().value,Eah(a,b[0],b[1],!1),bs(a.D.Ka(),"waffle-dataconnector-refresh-all-single-datasource-container");else{for(var c=ha(b.keys()),d=c.next();!d.done;d=c.next()){d=d.value;var e=b.get(d);Eah(a,d,e,!0)}ds(a.D.Ka(),"waffle-dataconnector-refresh-all-single-datasource-container")}1<a.C.length&&a.C[0].expand()}
function Fah(a){var b=Dah(a);1!=b.size&&1!=a.C.length||b.size==a.C.length?(a.C.forEach(function(c){var d=c.Rd();if(b.has(d)){var e=b.get(d);sah(c);Zf(c.F);c.F=[];vah(c);c.J=new Set(e);qah(c);rah(c)}else Gah(a,c);b.delete(d)}),b.forEach(function(c,d){return Eah(a,d,c,!0)})):Bah(a)}function Gah(a,b){a.C=a.C.filter(function(c){return b!=c});Yf(b)}function Eah(a,b,c,d){var e=N().hS()(b);e=EF(a.F.C,e).$d();b=new oah(b,c,a.F,e,d,a.H,a.L,a.oa());a.C.push(b);a.D.Ga(b,!0)}
function Dah(a){var b=new Map;T9g(a.J).forEach(function(c){var d=N().lM()(c);b.has(d)?b.get(d).push(c):b.set(d,[c])});return b}function Hah(a,b){a.C.forEach(function(c){return xah(c,b)})}function Iah(a){a.C.forEach(function(b){b.C&&o$e(b.C.C)})}function Jah(a){a.C.forEach(function(b){b.C&&(b=b.C,n$e(b.C),b.D.Na(!1))})}function Kah(a){a.C.forEach(function(b){return wah(b)})}Aah.prototype.Na=function(a){this.C.forEach(function(b){return b.Na(a)})};
function Cah(a,b){3==EF(a.F.C,b.yh).getSheetType()&&(a=a.C.find(function(c){return c.H==b.C}))&&zah(a,b.Nm)};function Lah(a,b,c){b=void 0===b?kD.getInstance():b;et.call(this,"",void 0,c);a&&Mah(a);this.C=new Nah(a,b,c);this.Ga(this.C)}v(Lah,et);p=Lah.prototype;p.Ca=function(){this.C.Ca();this.kb(this.C.Ka())};p.Zc=function(a){a.Ln(!0);this.C.Zc(a)};p.Qs=function(a,b){a.Ln(!0);this.C.Qs(a,b)};p.zg=function(a){return this.C.zg(a)};p.Lh=function(){return this.C.Lh()};p.Kd=function(){return this.C.C.map(function(a){return a.getValue()})};
function Oah(a,b){a=a.C;for(var c=ha(a.C),d=c.next();!d.done;d=c.next())d.value.Gb(!1);if(0==b.length)a.C=[];else{c=[];d=b.length;for(var e=0;e<a.Lh();e++){var f=a.zg(e),h=f.getValue();if(0<=b.indexOf(h)&&(f.Gb(!0),c.push(f),0==--d))break}a.C=c}a.YG()}p.zb=function(){return this.C.zb()};p.Ce=function(a){Mah(a);this.C.Ce(a)};p.Dc=function(a){this.C.Dc(a)};function Mah(a){for(var b=0;b<a.Qb();b++)a.Gc(b).Ln(!0)}function Nah(a,b,c){b=void 0===b?kD.getInstance():b;AU.call(this,a,b,c);this.C=[]}
v(Nah,AU);Nah.prototype.Ce=function(a){AU.prototype.Ce.call(this,a);this.C=[];this.YG()};Nah.prototype.Aq=function(a){a.stopPropagation();a=a.target;if(a.isChecked()){var b=this.zb();Md(this.C,a,function(c,d){return Id(qr(b,c),qr(b,d))})}else Ad(this.C,a);this.YG();this.dispatchEvent("change")};Nah.prototype.D=function(){var a;0==this.C.length?a=this.H:a=this.C.map(function(b){return b.Yg()}).join(", ");return a||""};function Pah(){var a='<div class="'+U("waffle-dataconnector-refresh-schedules-widget")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-header")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-top-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-header-title")+'"><span tabindex="0" class="'+U("waffle-dataconnector-refresh-schedules-title")+'" role="heading">';a=a+'Scheduled refresh</span></div><div class="'+(U("waffle-dataconnector-refresh-schedules-enable-switch")+
'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-spinner")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-setup-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-overview-section")+'"><span class="'+U("waffle-dataconnector-refresh-schedules-overview-text")+'"></span><span class="'+U("waffle-dataconnector-refresh-schedules-edit-btn")+'"></span></div><div class="'+U("waffle-dataconnector-refresh-schedules-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-fullview-text"></div><div><span class="'+
U("waffle-dataconnector-refresh-schedules-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(U("waffle-dataconnector-refresh-schedules-edit-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-frequency-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+
" "+U("waffle-dataconnector-refresh-schedules-edit-section-row-date")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-date-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-time-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-owner-info")+'"></div><div class="'+
U("waffle-dataconnector-refresh-schedules-btns")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-cancel-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-save-btn")+'"></div></div></div></div>');return T(a)};var Qah=new nv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function Rah(a,b,c,d){f3.call(this,a,b,c,d);this.La=y(A(),"fdsrfu")?1:4;a=new Ht;a.Ga(new Ct("Every day",1),!0);a.Ga(new Ct("Every week",2),!0);a.Ga(new Ct("Every month",3),!0);this.H=new AU(a,kD.getInstance(),d);Zt(this.H,"Add frequency");this.H.Dc("waffle-dataconnector-refresh-schedule-frequency");this.H.setContent("Frequency");this.Ga(this.H);this.D=new Lah(void 0,kD.getInstance(),d);Zt(this.D.C,"Add date");this.D.Dc("waffle-dataconnector-refresh-schedule-date");this.D.C.setContent("On date");
this.Ga(this.D);var e=this.La;a=new Ht;var f=new Date(La());c=Array(24);for(var h=0;24>h;h++){f.setHours(h,0,0,0);var k=new Date(f.getTime()),l=new Date(f.getTime());l.setHours(k.getHours()+e);l=k9e(k,l);c[k.getHours()]={value:h,label:l}}for(e=0;24>e;e++)f=new Ct(c[e].label,c[e].value),a.Ga(f,!0);this.J=new AU(a,kD.getInstance(),d);Zt(this.J,"Add time");this.J.Dc("waffle-dataconnector-refresh-schedule-time");this.J.setContent("Between");this.Ga(this.J);this.O=new XO("Cancel");this.Ga(this.O);this.R=
new rw("Save",d);this.R.Na(!1);this.Ga(this.R);this.ea=new rt("",ZG.getInstance(),d);this.Ga(this.ea);this.Ba=new rt("Setup now",ZG.getInstance(),d);this.Ga(this.Ba);this.Aa=new rt("",ZG.getInstance(),d);this.Ga(this.Aa);this.F=new cS(d);this.F.xe("Enable schedule");this.Ga(this.F);this.ma=b;this.L=new J8e(d);this.L.Sb("waffle-dataconnector-refresh-schedules-info-icon");this.L.setVisible(!1);this.Ha=new aV(!0,"#0f9d58")}v(Rah,f3);p=Rah.prototype;
p.Ca=function(){f3.prototype.Ca.call(this);this.kb(yr(Pah));var a=this.Da("waffle-dataconnector-refresh-schedules-title");a.id=nr(this,"waffle-dataconnector-refresh-schedules-title");Tr(a,"heading");Vr(this.Ka(),"labelledby",a.id);a=this.L.C;a.setContent(Ze("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.L.render(this.Da("waffle-dataconnector-refresh-schedules-header-title"));a=a.xb();Vr(this.L.Ka(),"labelledby",
a.id)};
p.Ia=function(){f3.prototype.Ia.call(this);this.O.render(this.Da("waffle-dataconnector-refresh-schedules-cancel-btn"));this.ea.render(this.Da("waffle-dataconnector-refresh-schedules-edit-btn"));this.F.render(this.Da("waffle-dataconnector-refresh-schedules-enable-switch"));this.H.render(this.Da("waffle-dataconnector-refresh-schedules-frequency-select"));this.R.render(this.Da("waffle-dataconnector-refresh-schedules-save-btn"));this.Ba.render(this.Da("waffle-dataconnector-refresh-schedules-setup-btn"));this.Aa.render(this.Da("waffle-dataconnector-refresh-schedules-timezone-setting-btn"));
this.J.render(this.Da("waffle-dataconnector-refresh-schedules-time-select"));this.D.render(this.Da("waffle-dataconnector-refresh-schedules-date-select"));this.Ha.render(this.Da("waffle-dataconnector-refresh-schedules-spinner"));Sah(this,!1);Ot(this.J,new Sr(null,13));this.getHandler().listen(this.ea,"action",this.show).listen(this.O,"action",this.Xjc).listen(this.R,"action",this.$jc).listen(this.Ba,"action",this.show).listen(this.F,"action",this.Yjc).listen(this.H,"change",this.Zjc).listen(this.D,
"change",this.h$).listen(this.J,"change",this.h$).listen(this.Aa,"action",this.akc).listen(this.Ka(),"keydown",this.Wjc);0<Array.from(this.Wa.C.keys()).length?(P(this.Ka(),!0),n$g(this)):P(this.Ka(),!1)};
p.refresh=function(){if(!this.isDisposed()){var a=this.Da("waffle-dataconnector-refresh-schedules-edit-section"),b=this.Da("waffle-dataconnector-refresh-schedules-overview-section"),c=this.Da("waffle-dataconnector-refresh-schedules-fullview-section"),d=this.Da("waffle-dataconnector-refresh-schedules-owner-info"),e=this.Da("waffle-dataconnector-refresh-schedules-setup-btn"),f=this.Da("waffle-dataconnector-refresh-schedules-enable-switch"),h=this.Da("waffle-dataconnector-refresh-schedules-spinner");
P(e,!1);P(f,!1);P(a,!1);P(b,!1);P(c,!1);P(d,!1);P(h,!1);fs(this.Ka(),"waffle-dataconnector-refresh-schedules-widget-opened",!1);var k=!1;this.L.setVisible(!1);switch(this.state){case 1:P(e,!0);break;case 2:P(c,!0);P(a,!0);P(d,!0);fs(this.Ka(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);k=!0;Tah(this);Uah(this);this.h$();this.O.Na(!0);this.L.setVisible(!0);break;case 3:P(h,!0);break;case 5:P(c,!0);P(f,!0);P(a,!0);P(d,!0);fs(this.Ka(),"waffle-dataconnector-refresh-schedules-widget-opened",
!0);k=!0;Vah(this);Tah(this);Uah(this);a=$T(this.C);this.F.Gb(!!kh(a,1));b=a.Hi().Hi();this.H.setValue(b);switch(b){case 1:Sah(this,!1);break;case 2:Oah(this.D,rR(a.Hi(),4).Eb());Sah(this,!0);break;case 3:Oah(this.D,rR(a.Hi(),5).Eb()),Sah(this,!0)}this.J.setValue(ph(a.Hi(),2));this.h$();this.O.Na(!0);this.L.setVisible(!0);break;case 4:P(f,!0),P(b,!0),Vah(this),b=this.Da("waffle-dataconnector-refresh-schedules-overview-text"),o$g(this)?(a=this.C.getStatus(),ym(b,"Next: "),b=new Date(1E3*oh(a,2)),a=
new Date(1E3*oh(a,3)),this.ea.setContent(Mm(this.oa(),m9e(b,a,this.ma,!0,!0)))):(ym(b,"Paused"),this.ea.setContent("Edit"))}this.xa!=k&&(this.xa=k,this.dispatchEvent(k?"oj":"nj"))}};function Vah(a){var b=!!kh($T(a.C),1),c=Ix.isEnabled();a.F.Gb(b);a.F.Na(c)}function Tah(a){var b=a.Da("waffle-dataconnector-refresh-schedules-owner-info"),c="Will run as you.";a.C&&(a=mh(a.C.rb(4,N9g),1))&&(c+=" Currently running as "+a);ym(b,c)}
function Uah(a){var b=a.Da("waffle-dataconnector-refresh-schedules-fullview-text");if(o$g(a)){var c=a.C.getStatus(),d=new Date(1E3*oh(c,2));c=new Date(1E3*oh(c,3));var e=a.oa();e.xd(b);e.appendChild(b,Mm(e,cf(Ze("Next: "),m9e(d,c,a.ma,!1,!0))))}else ym(b,"");a.Aa.setContent(l9e(a.ma))}p.Xjc=function(){Wah(this)};function Wah(a){a.state=2==a.state?1:4;a.refresh();a.Da("waffle-dataconnector-refresh-schedules-title").focus()}
p.Zjc=function(){var a=this.H.getValue();Oah(this.D,[]);switch(a){case 1:Sah(this,!1);break;case 2:Sah(this,!0);a=this.D;var b=a.Ce,c=new Ht,d=Xah();d=ha(d);for(var e=d.next();!e.done;e=d.next())e=e.value,c.Ga(new Ct(e.label,e.value),!0);a=b.call(a,c);Yf(a);break;case 3:Sah(this,!0);a=this.D;b=a.Ce;c=new Ht;for(d=1;28>=d;d++)c.Ga(new Ct(Qah.format({DAY:d}),d),!0);a=b.call(a,c);Yf(a)}this.h$()};
p.$jc=function(){this.R.Na(!1);this.O.Na(!1);var a=this.H.getValue(),b=X9g().AP(a);if(2===a){var c=ha(this.D.Kd());for(a=c.next();!a.done;a=c.next())Voa(b,4,a.value)}else if(3===a)for(c=ha(this.D.Kd()),a=c.next();!a.done;a=c.next())Voa(b,5,a.value);a=this.J.getValue();Ah(b,2,a);b=Ah(Y9g().AP(b),3,1);2==this.state?(b.Na(!0),Tfb.ob(b.build())):(b.Na(this.F.isChecked()),Ufb.ob(b.build()))};
p.Yjc=function(){var a=this;if(4==this.state){var b=this.F.isChecked();this.F.Gb(!b);this.F.Na(!1);if(b){var c=Yah(this);c.render();c.setVisible(!0);c.getResult().then(function(){Yf(c);Vfb.ob()},function(){Yf(c);Vah(a)})}else Wfb.ob()}};p.Wjc=function(a){27==a.keyCode&&this.xa&&(Wah(this),a.stopPropagation())};p.akc=function(){lA.ob()};p.h$=function(){var a=!!this.H.rf(),b=1===this.H.getValue()||0<this.D.Kd().length,c=!!this.J.rf(),d=Ix.isEnabled();this.R.Na(a&&b&&c&&d)};p.focus=function(){this.Da("waffle-dataconnector-refresh-schedules-title").focus()};
p.ZFa=function(a){this.F.Na(a)};function Sah(a,b){P(a.Da("waffle-dataconnector-refresh-schedules-edit-section-row-date"),b)}
function Yah(a){var b=new Cqf;b.Sb("waffle-dataconnector-refresh-schedules-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=$T(a.C);switch(c.Hi().Hi()){case 1:var d="Daily ";break;case 2:d=Xah();var e=rR(c.Hi(),4).Eb();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(rR(c.Hi(),5).Eb().map(function(l){return Qah.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=j9e(a.ma);var h=new Date(La()),k=new Date(1E3*oh(f,2));f=new Date(1E3*oh(f,3));d+=k9e(k,f,c)+" ("+l$a(n$a(c,h))+")";a="Will run as "+mh(a.C.rb(4,N9g),1);a=cf(Ze("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),bf("H4",void 0,"Schedule"),Ze(d),bf("BR"),Ze(a));rs(b,a);return b}
p.bma=function(){Ju.getInstance().postMessage(Qu("Error saving schedule.","error",!0));this.R.Na(!0);this.O.Na(!0);this.F.Na(!0)};function Xah(){var a=(Ew.FIRSTDAYOFWEEK+1)%7,b=Ew.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))};function Zah(a,b,c,d,e,f){iV.call(this,f);this.F=b.O;this.J=a;this.R=d;this.mP=new Aah(b,c,this.R,this.oa());this.Ga(this.mP);this.D=new p$g(this.F,f);this.qa(this.D);this.C=null;this.O=y(A(),"fdsrfu");this.H=null;this.L=e}v(Zah,iV);p=Zah.prototype;p.Ca=function(){iV.prototype.Ca.call(this);this.kb(yr(q$g,{id:this.getId()}));this.D.render(this.Da("waffle-dataconnector-refresh-sidebar-footer-wrapper"))};
p.Ia=function(){var a=this;iV.prototype.Ia.call(this);$ah(this);this.getHandler().listen(this,["nj","oj"],this.eTb);this.mP.render(this.Da("waffle-dataconnector-refresh-sidebar-refresh-widget"));abh(this,!0);this.getHandler().listen(this.D,"refresh-db-object-request",function(){var b=U9g(a.F);Cfb.ob(new V9g(b,"all-objects-for-all-datasources"))});this.D.refresh();P(this.Da("waffle-dataconnector-refresh-sidebar-backdrop"),!1)};function bbh(a){null!=a.C&&(Yf(a.C),Yf(a.H),$ah(a))}
p.Una=function(){null!=this.C&&this.C.show()};function cbh(a,b){Hah(a.mP,b);var c=0;b.forEach(function(d){return c+=parseInt(mh(d,2),10)});a.D.ep(c)}function abh(a,b){a.mP.Na(b);b?a.D.refresh():a.D.C.Na(b)}
p.eTb=function(a){var b=this;a="oj"===a.type;P(this.Da("waffle-dataconnector-refresh-sidebar-backdrop"),a);abh(this,!a);Mq(this.Da("waffle-sidebar-content"),"overflow-y",a?"hidden":"auto");Yf(this.H);a?setTimeout(function(){if(b.C.ub()){var c=b.C.Ka();b.H=new ew(c,b.oa());b.qa(b.H);fw(b.H);c.focus()}},500):this.resize()};function $ah(a){a.C=a.O?new P$g(a.F,a.J,a.L,a.oa()):new Rah(a.F,a.J,a.L,a.oa());a.Ga(a.C);a.C.render(a.Ka());P(a.Da("waffle-dataconnector-refresh-sidebar-backdrop"),!1)}
p.resize=function(){if(this.C&&!this.C.xa){var a=$q(this.Da("waffle-sidebar-content")).height-$q(this.C.Ka()).height,b=this.Da("waffle-dataconnector-refresh-sidebar-refresh-widget");Zq(b,a)}};function dbh(a,b,c){hU.call(this,a,b);var d=this;this.C=c;this.F=new Nl;this.qa(this.F);this.F.Ab(this.C.D,function(e){if("dbobjectmodel-event-add"==e.getType()||"dbobjectmodel-event-remove"==e.getType())e=d.hc,Fah(e.mP),0<U9g(e.F).length||e.dispatchEvent("close-sidebar");ebh(d);Kah(d.hc.mP)});this.D.listen(LG,"show-db-objects-refresh-sidebar",this.H)}v(dbh,hU);dbh.prototype.Nf=function(){return Dfb};dbh.prototype.oo=function(){return Efb};
function ebh(a){var b=U9g(a.C),c=a.hc;0==b.length?W9g(c.D):(Iah(c.mP),$nf(c.D),Sje(a.C,b,function(d){a.isDisposed()||c.isDisposed()||cbh(c,d)},function(d){a.isDisposed()||c.isDisposed()||(d=new f1b(d[0].Dm(),d[0].Df()),Jah(c.mP),c.D.DB(d))}))}dbh.prototype.H=function(a){var b=this;bbh(this.hc);ebh(this);iU(this);a.Una&&this.hc.Una();Qm(function(){b.hc.Ka().focus()})};function fbh(){Qn.apply(this,arguments)}v(fbh,Qn);fbh.prototype.C=function(){return dbh};fbh.prototype.D=function(){return Zah};vo("dbrefresh",fbh);
